"use strict";(globalThis["webpackChunkais"]=globalThis["webpackChunkais"]||[]).push([[369],{9369:(e,l,t)=>{t.r(l),t.d(l,{default:()=>N});t(3150),t(3218),t(8268);var a=t(1758),o=t(8790);const r={class:"q-pa-md"},n={align:"right",style:{float:"right"}};function i(e,l,t,i,c,d){const s=(0,a.g2)("q-icon"),u=(0,a.g2)("q-input"),m=(0,a.g2)("q-btn"),b=(0,a.g2)("q-toggle"),p=(0,a.g2)("q-checkbox"),k=(0,a.g2)("q-img"),_=(0,a.g2)("q-avatar"),f=(0,a.g2)("q-tooltip"),v=(0,a.g2)("q-chip"),g=(0,a.g2)("q-item-section"),C=(0,a.g2)("q-item-label"),w=(0,a.g2)("q-item"),h=(0,a.g2)("q-list"),F=(0,a.g2)("q-btn-dropdown"),A=(0,a.g2)("q-card-section"),y=(0,a.g2)("q-separator"),W=(0,a.g2)("q-card"),j=(0,a.g2)("q-table"),I=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",r,[l[12]||(l[12]=(0,a.Lk)("h6",{class:"header-top"},"Workspaces",-1)),(0,a.bF)(j,{title:"Управление проектами",rows:e.Rows,"grid-header":"",columns:e.columns,"row-key":"id",selection:"multiple",selected:e.selected,"onUpdate:selected":l[2]||(l[2]=l=>e.selected=l),filter:e.filter,grid:"",loading:e.loading,"rows-per-page-options":[10],"hide-header":"",ref:"table-main",onSelection:e.handleSelectRow,onAddNewProject:e.ReciveDataFromChild},{"top-right":(0,a.k6)(()=>[(0,a.bF)(u,{borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":l[0]||(l[0]=l=>e.filter=l),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(s,{name:"search"})]),_:1},8,["modelValue"])]),"top-left":(0,a.k6)(()=>[(0,a.bF)(m,{size:"sm",color:"green",icon:"add",label:"Add","no-caps":"",class:"button-top",onClick:e.AddItem},null,8,["onClick"]),e.selected.length>0?((0,a.uX)(),(0,a.Wv)(m,{key:0,size:"sm",color:"red","icon-right":"delete",label:"Delete","no-caps":"",ref:"delete_button",class:"button-top",onClick:e.DeleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(m,{size:"sm",color:"blue",icon:"refresh",label:"Refresh","no-caps":"",onClick:e.Refresh},null,8,["onClick"]),(0,a.bF)(b,{modelValue:e.tableSelectable,"onUpdate:modelValue":l[1]||(l[1]=l=>e.tableSelectable=l),label:"Selectable"},null,8,["modelValue"])]),item:(0,a.k6)(t=>[(0,a.Lk)("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:(0,o.Tr)(t.selected?"transform: scale(0.95);":"")},[(0,a.bF)(W,{class:(0,o.C4)([t.row.id==e.current_project?"q-card-confirmed":""])},{default:(0,a.k6)(()=>[(0,a.Lk)("div",{class:(0,o.C4)([1==e.DisableCard(t.row)?"q-card-overlay":""])},[(0,a.bF)(A,null,{default:(0,a.k6)(()=>[e.tableSelectable?((0,a.uX)(),(0,a.Wv)(p,{key:0,dense:"",modelValue:t.selected,"onUpdate:modelValue":e=>t.selected=e},null,8,["modelValue","onUpdate:modelValue"])):(0,a.Q3)("",!0),(0,a.bF)(v,{clickable:"",square:"",onClick:l=>e.ChangeCurrentProject(t.row.id),disable:e.DisableCard(t.row)},{default:(0,a.k6)(()=>[(0,a.bF)(_,{size:"28px"},{default:(0,a.k6)(()=>[t.row.id==e.current_project?((0,a.uX)(),(0,a.Wv)(k,{key:0,src:"icons/workspaces/projectchecked.png"})):((0,a.uX)(),(0,a.Wv)(k,{key:1,src:"icons/workspaces/project.png"}))]),_:2},1024),(0,a.Lk)("b",null,(0,o.v_)(t.row.name),1),0==e.DisableCard(t.row)?((0,a.uX)(),(0,a.Wv)(f,{key:0},{default:(0,a.k6)(()=>[...l[3]||(l[3]=[(0,a.eW)(" Сделать проект текущим ",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:2},1032,["onClick","disable"]),(0,a.Lk)("div",n,[(0,a.bF)(F,{class:"glossy",color:"teal",label:"Action",size:"sm",onClick:e.onMainClick,disable:e.DisableCard(t.row)},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(w,{clickable:"",onClick:l=>e.InfoProject(t.row.id,t.row.name)},{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(_,{icon:"info",color:"blue","text-color":"white"})]),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(C,null,{default:(0,a.k6)(()=>[...l[4]||(l[4]=[(0,a.eW)("Info",-1)])]),_:1}),(0,a.bF)(C,{caption:""},{default:(0,a.k6)(()=>[...l[5]||(l[5]=[(0,a.eW)("Получить информацию о проекте",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[I]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(w,{clickable:"",onClick:l=>e.ChangeCurrentProject(t.row.id)},{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(_,null,{default:(0,a.k6)(()=>[t.row.id==e.current_project?((0,a.uX)(),(0,a.Wv)(k,{key:0,src:"icons/workspaces/projectchecked.png"})):((0,a.uX)(),(0,a.Wv)(k,{key:1,src:"icons/workspaces/project.png"}))]),_:2},1024)]),_:2},1024),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(C,null,{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Current",-1)])]),_:1}),(0,a.bF)(C,{caption:""},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Сделать проект текущим",-1)])]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[I]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(w,{clickable:"",onClick:l=>e.EditItem(t.row.id)},{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(_,{icon:"edit",color:"green","text-color":"white"})]),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(C,null,{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Edit",-1)])]),_:1}),(0,a.bF)(C,{caption:""},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Редактировать информацию о проекте",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[I]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(w,{clickable:"",onClick:l=>e.DeleteItem(t.row.id)},{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(_,{icon:"delete",color:"red","text-color":"white"})]),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(C,null,{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Delete",-1)])]),_:1}),(0,a.bF)(C,{caption:""},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("Удалить проект",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[I]])]),_:2},1024)]),_:2},1032,["onClick","disable"])])]),_:2},1024),(0,a.bF)(y),(0,a.bF)(h,{dense:""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(w,{clickable:"",key:l.name,disable:e.DisableCard(t.row)},{default:(0,a.k6)(()=>[(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(C,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(l.label),1)]),_:2},1024)]),_:2},1024),"owner"==l.name&&null!=l.value?((0,a.uX)(),(0,a.Wv)(g,{key:0,side:""},{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.bF)(_,{icon:"account_circle"}),(0,a.eW)(" "+(0,o.v_)(l.value.username),1)]),_:2},1024)]),_:2},1024)):"members"==l.name&&null!=l.value?((0,a.uX)(),(0,a.Wv)(g,{key:1,side:""},{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.bF)(_,{icon:"groups"}),(0,a.eW)(" "+(0,o.v_)(l.value.map(e=>e.username).join(", ")),1)]),_:2},1024)]),_:2},1024)):"limit_to_network"==l.name&&null!=l.value?((0,a.uX)(),(0,a.Wv)(g,{key:2,side:""},{default:(0,a.k6)(()=>[(0,a.bF)(p,{disable:"",size:"xs",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):"import_fingerprint"==l.name&&null!=l.value?((0,a.uX)(),(0,a.Wv)(g,{key:3,side:""},{default:(0,a.k6)(()=>[(0,a.bF)(p,{disable:"",size:"xs",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):((0,a.uX)(),(0,a.Wv)(g,{key:4,side:""},{default:(0,a.k6)(()=>[(0,a.bF)(C,{class:"truncate-text"},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(l.value),1)]),_:2},1024)]),_:2},1024))]),_:2},1032,["disable"]))),128))]),_:2},1024)],2)]),_:2},1032,["class"])],4)]),_:1},8,["rows","columns","selected","filter","loading","onSelection","onAddNewProject"])])}t(6003),t(9344);var c=t(8734),d=t(6653),s=t(4907),u=t(6171),m=t(6980),b=t(9827),p=t(1964),k=t(5745);const _=[{name:"name",label:"Имя проекта",field:"name",sortable:!0},{name:"description",label:"Описание",field:"description",sortable:!0},{name:"boundary",label:"Границы проекта",field:"boundary",sortable:!0},{name:"limit_to_network",label:"Ограничение на подсети",field:"limit_to_network",sortable:!0},{name:"import_fingerprint",label:"Импортированный проект",field:"import_fingerprint",sortable:!0},{name:"owner",label:"Владелец",field:"owner",sortable:!0},{name:"members",label:"Участники проекта",field:"members"},{name:"created_at",label:"Дата создания",field:"created_at",sortable:!0}];var f=[];const v=(0,a.pM)({name:"PageIndex1",setup(){const e=(0,m.Pj)(),l=(0,a.EW)(()=>e.state.current_project),t=(0,a.EW)(()=>e.state.watch_add_project),o=(0,c.KR)(""),r=(0,c.KR)([]),n=(0,s.A)();var i=(0,c.KR)([...f]);const d=(0,c.KR)(!1),v=(0,c.KR)(!1);async function g(){d.value=!0;var l=(0,p.y)("table","Workspaces","getItem"),t=null,a=await(0,b.b)(l,t,e.state.current_user.token);void 0!=a&&a&&0==a.hasOwnProperty("message")||Array.isArray(1==a)?(i.value=a,C(e.state.current_project),d.value=!1):(d.value=!1,a.hasOwnProperty("message")&&(0,k.e)(n,"negative","Error",a.message,"report_problem"))}function C(e){if(null!=e)for(var l=i.value.findIndex(l=>l.id==e),t=0;t<i.value.length;t++)l==t?i.value[l].status=!0:i.value[t].status=!1}function w(){n.dialog({component:u.A,componentProps:{CardAction:"AddItem",CardName:"Add Workspace",CardData:{name:"",description:"",boundary:"",limit_to_network:!1,import_fingerprint:!1,owner:null,members:null}}}).onOk(e=>{i.value.unshift(e)})}function h(){g()}async function F(l){var t=(0,p.y)("table","Workspaces","delItem"),a=l,o=await(0,b.L)(t,a,null,e.state.current_user.token);void 0!=o&&0!=o?(200==o.rsp_k&&(i.value=i.value.filter(e=>e.id!==l),e.state.current_project==l&&(e.commit("SET_CURRENT_PROJECT",null),e.commit("SET_CURRENT_PROJECT_LABEL",null),localStorage.setItem("current_project",JSON.stringify({project:null,label:null})))),(0,k.e)(n,"positive","Запись удалена","","done")):(0,k.e)(n,"negative","Error",o.message,"report_problem")}function A(){for(var e=r.value.filter(e=>e.id),l=0;l<e.length;l++)F(e[l].id)}function y(e){var l=i.value.find(l=>l.id==e);n.dialog({component:u.A,componentProps:{CardAction:"EditItem",CardName:"Edit Workspace",CardData:JSON.parse(JSON.stringify(l))}}).onOk(e=>{if(void 0!=e){const l=i.value.findIndex(l=>l.id==e.id);l>-1&&(i.value[l]=e)}})}async function W(l,t){var a=(0,p.y)("json","CountInformation","getItem"),o={workspace:l,data:""},r=await(0,b.L)(a,o,null,e.state.current_user.token);void 0!=r&&r||Array.isArray(1==r)?(0,k.e)(n,"primary","Information",JSON.stringify(r),"info"):r.hasOwnProperty("message")&&(0,k.e)(n,"negative","Error",r.message,"report_problem")}function j(l){let t=i.value.filter(e=>e.id==l)[0].name;localStorage.setItem("current_project",JSON.stringify({project:l,label:t})),e.commit("SET_CURRENT_PROJECT",l),e.commit("SET_CURRENT_PROJECT_LABEL",t)}function I(e){r.value=e.rows}function E(e){console.log(e)}function R(l){var t=!1;return 0==e.state.current_user.admin&&(null!=l.owner_id&&e.state.current_user.id!=l.owner_id&&(t=!0),null!=l.owner_id&&null!=l.members&&1==Array.isArray(l.members)&&l.members!=[]&&l.members.some(l=>l.id==e.state.current_user.id)&&(t=!0)),t}return(0,a.wB)(()=>e.state.watch_add_project,()=>{null!=e.state.watch_add_project&&(i.value.push(e.state.watch_add_project),e.commit("SET_WATCH_ADD_PROJECT",null))}),(0,a.wB)(()=>e.state.current_project,()=>{C(e.state.current_project)}),(0,a.sV)(()=>{g()}),{Rows:i,tableSelectable:v,current_project:l,watch_add_project:t,columns:_,selected:r,filter:o,loading:d,DisableCard:R,loadData:g,DeleteItem:F,AddItem:w,EditItem:y,ControlToggle:C,handleSelectRow:I,DeleteItems:A,InfoProject:W,ReciveDataFromChild:E,Refresh:h,ChangeCurrentProject:j}}});var g=t(2807),C=t(9270),w=t(492),h=t(6384),F=t(6908),A=t(3316),y=t(4189),W=t(460),j=t(6760),I=t(3952),E=t(5046),R=t(7410),S=t(1207),q=t(3999),T=t(124),Q=t(5173),D=t(3796),P=t(386),V=t(8672),X=t(8582),O=t.n(X);const x=(0,g.A)(v,[["render",i]]),N=x;O()(v,"components",{QTable:d.A,QInput:C.A,QIcon:w.A,QBtn:h.A,QToggle:F.A,QCard:A.A,QCardSection:y.A,QCheckbox:W.A,QChip:j.A,QAvatar:I.A,QImg:E.A,QTooltip:R.A,QBtnDropdown:S.A,QList:q.A,QItem:T.A,QItemSection:Q.A,QItemLabel:D.A,QSeparator:P.A}),O()(v,"directives",{ClosePopup:V.A})}}]);