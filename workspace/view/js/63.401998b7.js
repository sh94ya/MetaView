"use strict";(globalThis["webpackChunkais"]=globalThis["webpackChunkais"]||[]).push([[63],{9063:(e,l,t)=>{t.r(l),t.d(l,{default:()=>sd});var a=t(1758);function o(e,l,t,o,n,s){const i=(0,a.g2)("TreeHosts"),r=(0,a.g2)("SplitLayout"),d=(0,a.g2)("SingleLayout"),u=(0,a.g2)("q-splitter"),c=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(u,{modelValue:o.splitterModel,"onUpdate:modelValue":l[0]||(l[0]=e=>o.splitterModel=e),style:{"max-height":"100vh"}},{before:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(i,{ref:"treehostsRef"},null,512)])]),after:(0,a.k6)(()=>["split"==o.UserSettings.main_layout?((0,a.uX)(),(0,a.Wv)(r,{key:0,countInformation:o.CountInformation},null,8,["countInformation"])):((0,a.uX)(),(0,a.Wv)(d,{key:1,countInformation:o.CountInformation},null,8,["countInformation"]))]),_:1},8,["modelValue"])]),_:1})}var n=t(8734),s=t(6980),i=t(9827);t(3150),t(3218),t(4823),t(8268),t(3434);function r(e,l=" == ",t=""){if(null!=e&&void 0!=e)if("root"==e.type)"#Hosts"==e.label&&(t=""),"#Services"==e.label&&(t="services.port > 0"),"#Notes"==e.label&&(t="notes.id > 0"),"#Vulns"==e.label&&(t="vulns.id > 0"),"#Creds"==e.label&&(t="creds.id > 0"),"#Loots"==e.label&&(t="loots.id > 0");else if("directory"==e.type){if("hosts.subnets"!=e.purpose&&"hosts.os"!=e.purpose&&"hosts.purposes"!=e.purpose||(t=""),"hosts.subnet"==e.purpose&&(t=`hosts.address${l}"${e.label}"`),"hosts.tags"==e.purpose&&(t="COUNT(tag.id) > 0"),"hosts.tag"==e.purpose&&(t=`tag.name${l}"${e.label}"`),"hosts.os_family"==e.purpose&&(t=`hosts.os_family${l}"${e.label}"`),"hosts.os_name"==e.purpose&&(t=`hosts.os_name${l}"${e.label}"`),"hosts.purpose"==e.purpose&&(t=`hosts.purpose${l}"${e.label}"`),"services.port"==e.purpose&&(t=`services.port${l}${e.port}`),"services.name"==e.purpose){let a="";a=null==e.label?e.label:`"${e.label}"`,t=`services.name${l}${a}`}"vulns.names"==e.purpose&&(t="vulns.name != null"),"vulns.name"==e.purpose&&(t=`vulns.name${l}"${e.label}"`),"vulns.exploited"==e.purpose&&(t="vulns.exploited == 'true'"),"vulns.refs"==e.purpose&&(t="vulns.ref != null"),"vulns.ref"==e.purpose&&(t=`vulns.ref${l}"${e.label}"`),"creds.usernames"==e.purpose&&(t="COUNT(creds.username) > 0"),"creds.username"==e.purpose&&(t=`creds.username${l}"${e.label}"`),"creds.passwords"==e.purpose&&(t="COUNT(creds.password) > 0"),"creds.password"==e.purpose&&(t=`creds.password${l}"${e.label}"`),"creds.access_levels"==e.purpose&&(t="creds.access_level != null"),"creds.access_level"==e.purpose&&(t=`creds.access_level${l}"${e.label}"`),"notes.ntypes"==e.purpose&&(t="notes.id > 0"),"notes.ntype"==e.purpose&&(t=`notes.ntype${l}"${e.label}"`),"loots.ltypes"==e.purpose&&(t="loots.id > 0"),"loots.ltype"==e.purpose&&(t=`loots.ltype${l}"${e.label}"`)}else"host"!=e.type&&"subnet"!=e.type||(t=`hosts.address${l}"${e.label}"`),"tag"==e.type&&(t=`tag.name${l}"${e.label}"`),"os_family"==e.type&&(t=`hosts.os_family${l}"${e.label}"`),"os_name"==e.type&&(t=`hosts.os_name${l}"${e.label}"`),"purpose"==e.type&&(t=`hosts.purpose${l}"${e.label}"`),"port"==e.type&&(t=`services.port${l}${e.label}`),"service.name"==e.type&&(t=`services.name${l}"${e.label}"`);return t}const d=(e,l,t)=>{const a=c(e),o=c(l);return t?o-a:a-o},u=(e,l,t)=>{const a=e.port,o=l.port;return t?o-a:a-o},c=e=>{if(!e)return 0;const l=e.address.split(".").map(e=>parseInt(e,10)||0);return l.reduce((e,l,t)=>e+l*Math.pow(256,3-t),0)},p=(e,l)=>{if(!l)return e;const t=l.toLowerCase();return e.filter(e=>{var l=!1,a=Object.keys(e);return a.forEach(a=>{if("host"==a){var o="";if(null!=e[a]&&"address"in e[a]&&(o=String(`${e[a].address}`)),o?.toString().toLowerCase().includes(t))return l=!0,!0}else if("service"==a){o="";if(null!=e[a]&&"port"in e[a]&&"proto"in e[a]&&"name"in e[a]&&(o=String(`${e[a].port}/${e[a].proto} (${e[a].name})`)),o?.toString().toLowerCase().includes(t))return l=!0,!0}else if(void 0!=e[a]&&null!=e[a]&&e[a]?.toString().toLowerCase().includes(t))return l=!0,!0}),l})};var m=t(1964),b=t(8790);const g={class:"tree_margin"},v={key:1,class:"",style:{display:"inline-block"}},f={key:0},_={key:0},k={key:1},y={key:2},h={key:0},C={key:1},F={key:2},x={key:3},A={key:0},w={key:1},S={key:4},V={key:0},Q={key:1},I={key:5},W={key:0},D={key:1},R={key:6},O={key:0},T={key:1},q={key:7},E={key:0},X={key:1},K={key:8},L={key:9},z={key:10},N={key:11},P={key:12},M={key:0},U={key:0},j={key:1},B={key:2},J={key:1},H={key:13},$={key:0},G={key:1},Y={key:1},Z={key:2},ee={key:3},le={key:4},te={key:5},ae={key:6},oe={key:7},ne={key:2},se={key:3},ie={key:4,style:{color:"red"}},re={key:5},de={key:6,style:{color:"black"}};function ue(e,l,t,o,n,s){const i=(0,a.g2)("q-icon"),r=(0,a.g2)("q-input"),d=(0,a.g2)("q-checkbox"),u=(0,a.g2)("q-img"),c=(0,a.g2)("q-tooltip"),p=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item-label"),ue=(0,a.g2)("q-item"),ce=(0,a.g2)("q-separator"),pe=(0,a.g2)("q-list"),me=(0,a.g2)("q-menu"),be=(0,a.g2)("q-tree"),ge=(0,a.g2)("q-scroll-area"),ve=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(ge,{style:{height:"calc(100vh - 50px)"}},{default:(0,a.k6)(()=>[(0,a.bF)(r,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[0]||(l[0]=e=>o.filter=e),ref:"filterRef",placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(i,{name:"search"})]),_:1},8,["modelValue"]),(0,a.Lk)("div",g,[(0,a.bF)(be,{nodes:o.Items,"no-transition":"",ref:"treeRef","node-key":"id",filter:o.filter,"default-expand-all":"","filter-method":o.myFilterMethod,"selected-color":"primary",selected:o.selected,"onUpdate:selected":[l[1]||(l[1]=e=>o.selected=e),l[3]||(l[3]=e=>o.handleSelectItem(o.selected))],expanded:o.expanded,"onUpdate:expanded":l[2]||(l[2]=e=>o.expanded=e),onLazyLoad:o.onLazyLoad,dense:""},{"default-header":(0,a.k6)(({node:e})=>[1==o.f_ticked?((0,a.uX)(),(0,a.Wv)(d,{key:0,modelValue:e.ticked,"onUpdate:modelValue":l=>e.ticked=l,onClick:l=>o.sel_ticked(e),size:"xs"},null,8,["modelValue","onUpdate:modelValue","onClick"])):(0,a.Q3)("",!0),1==o.user_settings.display_icon_tree_hosts?((0,a.uX)(),(0,a.CE)("div",v,["directory"==e.type?((0,a.uX)(),(0,a.CE)("div",f,["hosts.subnets"==e.purpose||"hosts.subnet"==e.purpose?((0,a.uX)(),(0,a.CE)("div",_,[(0,a.bF)(i,{name:"cloud",color:"blue"})])):(0,a.Q3)("",!0),"hosts.tags"==e.purpose||"hosts.tag"==e.purpose?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.bF)(i,{name:"sell",color:"black"})])):(0,a.Q3)("",!0),"hosts.os"==e.purpose||"hosts.os_family"==e.purpose||"hosts.os_name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",y,["hosts.os"==e.purpose?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.bF)(i,{name:"android",color:"green"})])):(0,a.Q3)("",!0),"hosts.os_family"==e.purpose?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(u,{src:o.hosts_osfamily_icon(e.label),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0),"hosts.os_name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.bF)(u,{src:o.hosts_os_name_icon(e.label),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"hosts.purposes"==e.purpose||"hosts.purpose"==e.purpose?((0,a.uX)(),(0,a.CE)("div",x,["hosts.purposes"==e.purpose?((0,a.uX)(),(0,a.CE)("div",A,[(0,a.bF)(i,{name:"desktop_windows"})])):(0,a.Q3)("",!0),"hosts.purpose"==e.purpose?((0,a.uX)(),(0,a.CE)("div",w,[(0,a.bF)(u,{src:o.hosts_purpose_icon(e.label),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"services.ports"==e.purpose||"services.port"==e.purpose?((0,a.uX)(),(0,a.CE)("div",S,["services.ports"==e.purpose?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.bF)(i,{name:"123"})])):(0,a.Q3)("",!0),"services.port"==e.purpose?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.bF)(i,{name:"folder",color:"grey"})])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"services.names"==e.purpose||"services.name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",I,["services.names"==e.purpose?((0,a.uX)(),(0,a.CE)("div",W,[(0,a.bF)(i,{name:"sip",color:"orange"})])):(0,a.Q3)("",!0),"services.name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",D,[(0,a.bF)(u,{src:o.services_name_icon(e.label),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"notes.ntypes"==e.purpose||"notes.ntype"==e.purpose?((0,a.uX)(),(0,a.CE)("div",R,["notes.ntypes"==e.purpose?((0,a.uX)(),(0,a.CE)("div",O,[(0,a.bF)(i,{name:"description"})])):(0,a.Q3)("",!0),"notes.ntype"==e.purpose?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.bF)(u,{src:o.notes_type_icon(e.label),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"vulns.names"==e.purpose||"vulns.name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",q,["vulns.names"==e.purpose?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.bF)(i,{name:"gpp_bad"})])):(0,a.Q3)("",!0),"vulns.name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",X,[(0,a.bF)(i,{name:"verified_user",color:"green"})])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"vulns.exploited"==e.purpose?((0,a.uX)(),(0,a.CE)("div",K,[(0,a.bF)(i,{name:"local_fire_department",color:"red"})])):(0,a.Q3)("",!0),"vulns.refs"==e.purpose||"vulns.ref"==e.purpose?((0,a.uX)(),(0,a.CE)("div",L,[(0,a.bF)(i,{name:"link"})])):(0,a.Q3)("",!0),"creds.usernames"==e.purpose||"creds.username"==e.purpose?((0,a.uX)(),(0,a.CE)("div",z,[(0,a.bF)(i,{name:"account_box"})])):(0,a.Q3)("",!0),"creds.passwords"==e.purpose||"creds.password"==e.purpose?((0,a.uX)(),(0,a.CE)("div",N,[(0,a.bF)(i,{name:"key"})])):(0,a.Q3)("",!0),"creds.access_levels"==e.purpose||"creds.access_level"==e.purpose?((0,a.uX)(),(0,a.CE)("div",P,["creds.access_level"==e.purpose?((0,a.uX)(),(0,a.CE)("div",M,["Admin"==e.label||"Administrator"==e.label?((0,a.uX)(),(0,a.CE)("div",U,[(0,a.bF)(i,{name:"admin_panel_settings",color:"green"})])):"User"==e.label||"user"==e.label?((0,a.uX)(),(0,a.CE)("div",j,[(0,a.bF)(i,{name:"admin_panel_settings",color:"blue"})])):((0,a.uX)(),(0,a.CE)("div",B,[(0,a.bF)(i,{name:"admin_panel_settings",color:"grey"})]))])):((0,a.uX)(),(0,a.CE)("div",J,[(0,a.bF)(i,{name:"admin_panel_settings",color:"teal"})]))])):(0,a.Q3)("",!0),"loots.ltypes"==e.purpose||"loots.ltype"==e.purpose?((0,a.uX)(),(0,a.CE)("div",H,["loots.ltypes"==e.purpose?((0,a.uX)(),(0,a.CE)("div",$,[(0,a.bF)(i,{name:"diamond",color:"blue"})])):(0,a.Q3)("",!0),"loots.ltype"==e.purpose?((0,a.uX)(),(0,a.CE)("div",G,[(0,a.bF)(u,{src:o.notes_type_icon(e.label),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])):"services.name"==e.purpose?((0,a.uX)(),(0,a.CE)("div",Y,[(0,a.bF)(u,{src:o.services_name_icon(e.label),class:"node_icon"},null,8,["src"])])):"notes.ntype"==e.purpose||"loots.ltype"==e.purpose?((0,a.uX)(),(0,a.CE)("div",Z,[(0,a.bF)(u,{src:o.notes_type_icon(e.label),class:"node_icon"},null,8,["src"])])):"port"==e.purpose?((0,a.uX)(),(0,a.CE)("div",ee,[(0,a.bF)(u,{src:"icons/directory.png",class:"node_icon"})])):"tag"==e.purpose?((0,a.uX)(),(0,a.CE)("div",le,[(0,a.bF)(u,{src:"icons/tag.png",class:"node_icon"}),(0,a.bF)(c,{offset:[0,10],"max-width":"250px"},{default:(0,a.k6)(()=>[(0,a.eW)(" TagID - "+(0,b.v_)(e.tag_id)+" ",1),l[4]||(l[4]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" Tag - "+(0,b.v_)(e.label)+" ",1),l[5]||(l[5]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" TagDescription - "+(0,b.v_)(e.description)+" ",1),l[6]||(l[6]=(0,a.Lk)("br",null,null,-1))]),_:2},1024)])):"purpose"==e.purpose?((0,a.uX)(),(0,a.CE)("div",te,[(0,a.bF)(u,{src:o.hosts_purpose_icon(e.label),class:"node_icon"},null,8,["src"]),(0,a.bF)(c,{offset:[0,10],"max-width":"250px"},{default:(0,a.k6)(()=>[(0,a.eW)(" Purpose - "+(0,b.v_)(e.label)+" ",1),l[7]||(l[7]=(0,a.Lk)("br",null,null,-1))]),_:2},1024)])):"root"==e.type?((0,a.uX)(),(0,a.CE)("div",ae,[(0,a.bF)(u,{src:"icons/directory.png",class:"node_icon"})])):((0,a.uX)(),(0,a.CE)("div",oe,[null!=e.virtual_host&&""!=e.virtual_host?((0,a.uX)(),(0,a.Wv)(u,{key:0,src:"icons/virtualization/vm.png",class:"node_icon"})):(0,a.Q3)("",!0),(0,a.bF)(u,{src:o.hosts_purpose_icon(e.purpose),class:"node_icon"},null,8,["src"]),e.id>=0?((0,a.uX)(),(0,a.Wv)(c,{key:1,offset:[0,10],"max-width":"250px"},{default:(0,a.k6)(()=>[(0,a.eW)(" HostID - "+(0,b.v_)(e.host_id)+" ",1),l[8]||(l[8]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" IP - "+(0,b.v_)(e.label)+" ",1),l[9]||(l[9]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" OS - "+(0,b.v_)(e.os_family)+" ",1),l[10]||(l[10]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" OS_Name - "+(0,b.v_)(e.os_name)+" ",1),l[11]||(l[11]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" Type - "+(0,b.v_)(e.purpose)+" ",1),l[12]||(l[12]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" Creds - "+(0,b.v_)(e.creds)+" ",1),l[13]||(l[13]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" Vulns - "+(0,b.v_)(e.vulns),1)]),_:2},1024)):(0,a.Q3)("",!0)]))])):(0,a.Q3)("",!0),"root"==e.type||"service_name"==e.type||"services_name"==e.type||"ports"==e.type?((0,a.uX)(),(0,a.CE)("span",ne,[(0,a.Lk)("b",null,(0,b.v_)(e.label),1)])):"port"==e.type?((0,a.uX)(),(0,a.CE)("span",se,[(0,a.Lk)("b",null,(0,b.v_)(e.port),1),(0,a.eW)("/("+(0,b.v_)(e.proto)+") ",1)])):null!=e.vulns&&e.vulns>0?((0,a.uX)(),(0,a.CE)("span",ie,(0,b.v_)(e.label),1)):"dir_os_family"!=e.type&&"dir_os_name"!=e.type||null!=e.value&&""!=e.value?((0,a.uX)(),(0,a.CE)("span",de,(0,b.v_)(e.label),1)):((0,a.uX)(),(0,a.CE)("span",re,"Unknown")),e.creds>0&&1==o.user_settings.display_icon_tree_creds?((0,a.uX)(),(0,a.Wv)(i,{key:7,color:"green",name:"check"})):(0,a.Q3)("",!0),(0,a.bF)(me,{"touch-position":"","context-menu":""},{default:(0,a.k6)(()=>[(0,a.bF)(pe,{dense:"",style:{"min-width":"100px"}},{default:(0,a.k6)(()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ue,{clickable:"",onClick:l=>o.context_refresh(e)},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"refresh"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)("Обновить",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[ve]]),"hosts.subnets"==e.purpose?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ue,{key:0,clickable:"",onClick:l=>o.mask_dialog(e)},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"cloud"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)("Маска сети",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[ve]]):(0,a.Q3)("",!0),(0,a.bF)(ce),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(ue,{clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"exit_to_app"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[16]||(l[16]=[(0,a.eW)("Выход",-1)])]),_:1})]),_:1})]),_:1})),[[ve]])]),_:2},1024)]),_:2},1024)]),_:1},8,["nodes","filter","filter-method","selected","expanded","onLazyLoad"])])]),_:1})}t(9344);var ce=t(6653),pe=t(4907);const me={class:"q-pa-md",style:{"max-width":"400px"}};function be(e,l,t,o,n,s){const i=(0,a.g2)("q-select"),r=(0,a.g2)("q-form"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-card-actions"),c=(0,a.g2)("q-card"),p=(0,a.g2)("q-dialog");return(0,a.uX)(),(0,a.Wv)(p,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,a.k6)(()=>[(0,a.bF)(c,{class:"q-dialog-plugin"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",me,[(0,a.bF)(r,{onSubmit:e.onSubmit,onReset:e.onReset,class:"q-gutter-md"},{default:(0,a.k6)(()=>[l[1]||(l[1]=(0,a.Lk)("div",{class:"text-h6"}," Маска подсети ",-1)),(0,a.bF)(i,{filled:"",modelValue:o.mask,"onUpdate:modelValue":l[0]||(l[0]=e=>o.mask=e),options:o.options,"option-value":"value","emit-value":"",label:"Mask","options-selected-class":"text-teal"},null,8,["modelValue","options"])]),_:1},8,["onSubmit","onReset"])]),(0,a.bF)(u,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"])}var ge=t(9583);const ve=[{label:"0 - 0.0.0.0",value:0},{label:"1 - 128.0.0.0",value:1},{label:"2 - 192.0.0.0",value:2},{label:"3 - 224.0.0.0",value:3},{label:"4 - 240.0.0.0",value:4},{label:"5 - 248.0.0.0",value:5},{label:"6 - 252.0.0.0",value:6},{label:"7 - 254.0.0.0",value:7},{label:"8 - 255.0.0.0",value:8},{label:"9 - 255.128.0.0",value:9},{label:"10 - 255.192.0.0",value:10},{label:"11 - 255.224.0.0",value:11},{label:"12 - 255.240.0.0",value:12},{label:"13 - 255.248.0.0",value:13},{label:"14 - 255.252.0.0",value:14},{label:"15 - 255.254.0.0",value:15},{label:"16 - 255.255.0.0",value:16},{label:"17 - 255.255.128.0",value:17},{label:"18 - 255.255.192.0",value:18},{label:"19 - 255.255.224.0",value:19},{label:"20 - 255.255.240.0",value:20},{label:"21 - 255.255.248.0",value:21},{label:"22 - 255.255.252.0",value:22},{label:"23 - 255.255.254.0",value:23},{label:"24 - 255.255.255.0",value:24},{label:"25 - 255.255.255.128",value:25},{label:"26 - 255.255.255.192",value:26},{label:"27 - 255.255.255.224",value:27},{label:"28 - 255.255.255.240",value:28},{label:"29 - 255.255.255.248",value:29},{label:"30 - 255.255.255.252",value:30},{label:"31 - 255.255.255.254",value:31},{label:"32 - 255.255.255.255",value:32}],fe={props:{items:String},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:a,onDialogCancel:o}=(0,ge.A)(),i=((0,pe.A)(),(0,s.Pj)()),r=(0,n.KR)(i.state.mask),d=(0,n.KR)(ve);return{dialogRef:l,options:d,mask:r,onOKClick(){i.commit("SET_MASK",r.value),a()},onCancelClick:o}}};var _e=t(2807),ke=t(2156),ye=t(3316),he=t(9200),Ce=t(5848),Fe=t(2669),xe=t(6384),Ae=t(8582),we=t.n(Ae);const Se=(0,_e.A)(fe,[["render",be]]),Ve=Se;we()(fe,"components",{QDialog:ke.A,QCard:ye.A,QForm:he.A,QSelect:Ce.A,QCardActions:Fe.A,QBtn:xe.A});var Qe=t(660),Ie=t(5745),We=t(7637);function De(e){var l="icons/unknown.png";try{if(null!=e&&void 0!=e){var t=e.toLowerCase();if("device"==t)return"icons/purpose/device.png";if("nas"==t)return"icons/purpose/nas.png";if("wifi_router"==t)return"icons/purpose/wifi_router.png";if("router"==t)return"icons/purpose/router.png";if("switch"==t)return"icons/purpose/switch.png";if("voip_gw"==t)return"icons/purpose/voip_gw.png";if("cloud_store"==t)return"icons/purpose/cloud_store.png";if("computer"==t)return"icons/purpose/computer.png";if("laptop"==t)return"icons/purpose/laptop.png";if("server"==t)return"icons/purpose/server.png";if("printer"==t)return"icons/purpose/printer.png";if("voip_client"==t)return"icons/purpose/voip_client.png";if("firewall"==t)return"icons/purpose/firewall.png";if("mfp"==t)return"icons/purpose/mfp.png";if("smart_phone"==t)return"icons/purpose/smart_phone.png";if("tv"==t)return"icons/purpose/tv.png";if("ip_camera"==t)return"icons/purpose/ip_camera.png";if("client"==t)return"icons/purpose/pc.png";if("tiny_client"==t)return"icons/purpose/tiny_client.png";if("ups"==t)return"icons/purpose/ups.png";if("dvr"==t)return"icons/purpose/dvr.png";if("ipmi"==t)return"icons/purpose/ipmi.png"}}catch{}return l}function Re(e){var l="icons/unknown.png";try{if(null!=e&&void 0!=e){var t=e.toLowerCase();if("windows"==t)return"icons/os/windows.png";if("linux"==t)return"icons/os/linux.png";if("freebsd"==t)return"icons/os/freebsd.png";if("android"==t)return"icons/os/android.png";if("ios"==t)return"icons/os/ios.png";if("macos"==t||-1!=t.search("os x"))return"icons/os/macos.png";if("hp"==t)return"icons/os/hp.png";if("vmware"==t)return"icons/os/vmware.png";if("cisco"==t)return"icons/os/cisco.png";if("mikrotik"==t)return"icons/os/mikrotik.png";if("huawei"==t)return"icons/os/huawei.png";if("d-link"==t)return"icons/os/dlink.png";if("tp-link"==t)return"icons/os/tplink.png";if("unix"==t)return"icons/os/unix.png"}}catch{}return l}function Oe(e){var l=null;try{if(null!=e&&void 0!=e&&""!=e){var t=e.toLowerCase();return-1!=t.search("vmware")?"icons/virtualization/vmware.png":-1!=t.search("rosa")?"icons/virtualization/rosa.png":-1!=t.search("qemu")?"icons/virtualization/qemu.png":-1!=t.search("opennebula")?"icons/virtualization/opennebula.png":-1!=t.search("ovirt")?"icons/virtualization/ovirt.png":-1!=t.search("proxmox")?"icons/virtualization/proxmox.png":-1!=t.search("hyper")?"icons/virtualization/hyper-v.png":-1!=t.search("kvm")?"icons/virtualization/kvm.png":-1!=t.search("virtualbox")?"icons/virtualization/virtualbox.png":-1!=t.search("xen")||-1!=t.search("citrix")?"icons/virtualization/xen.png":"icons/virtualization/vm.png"}}catch{}return l}function Te(e){var l=null;try{var t=e.toLowerCase();return-1!=t.search("ssh")?"icons/services/ssh.png":-1!=t.search("vipnet")?"icons/notes/vipnet.png":-1!=t.search("telnet")?"icons/services/telnet.png":-1!=t.search("ftp")?"icons/services/ftp.png":-1!=t.search("pop3")?"icons/services/pop3.png":-1!=t.search("imap")?"icons/services/imap.png":-1!=t.search("smtp")?"icons/services/smtp.png":-1!=t.search("mysql")?"icons/services/mysql.png":-1!=t.search("ibm")?"icons/services/ibm.png":-1!=t.search("skype")?"icons/services/skype.png":-1!=t.search("squid")?"icons/services/squid-proxy.png":-1!=t.search("rlogin")?"icons/services/rlogin.png":-1!=t.search("ipcam")?"icons/purpose/ip_camera.png":-1!=t.search("soap")?"icons/services/soap.png":-1!=t.search("smb")||-1!=t.search("microsoft ds")||-1!=t.search("microsoft-ds")||-1!=t.search("samba")||-1!=t.search("cifs")||-1!=t.search("nfs")?"icons/services/smb.png":-1!=t.search("rdp")||-1!=t.search("wbt-server")||-1!=t.search("rds ")||-1!=t.search(" rds")||"rds"==t?"icons/services/rdp.png":-1!=t.search("vnc")?"icons/services/vnc.png":-1!=t.search("dns")||"domain"==t?"icons/services/dns.png":-1!=t.search("ldap")?"icons/services/ldap.png":-1!=t.search("http")||-1!=t.search("php")||-1!=t.search("openssl")||-1!=t.search("nginx")||-1!=t.search("iis")?"icons/services/http.png":-1!=t.search("mysql")?"icons/services/mysql.png":-1!=t.search("postgres")?"icons/services/postgresql.png":-1!=t.search("microsoft sql")||-1!=t.search("ms-sql")||-1!=t.search("msql")||-1!=t.search("mssql")?"icons/services/msql.png":-1!=t.search("snmp")?"icons/services/snmp.png":-1!=t.search("openvpn")?"icons/services/openvpn.png":-1!=t.search("pptp")||-1!=t.search("l2tp")||-1!=t.search("ipsec")||-1!=t.search("ipsec")?"icons/services/vpn.png":-1!=t.search("vmware")?"icons/os/vmware.png":"jetdirect"==t||-1!=t.search("printer")?"icons/purpose/printer.png":-1!=t.search("rtsp")||"realserver"==t?"icons/services/rtsp.png":-1!=t.search("redis")?"icons/services/redis.png":-1!=t.search("firebird")||-1!=t.search("gds_db")?"icons/services/firebird.png":-1!=t.search("oracle")?"icons/services/oracle.png":-1!=t.search("radmin")?"icons/services/radmin.png":-1!=t.search("xmpp")||-1!=t.search("jabber")?"icons/services/xmpp.png":-1!=t.search("git")?"icons/services/git.png":"drwcs"==t?"icons/notes/drweb.png":-1!=t.search("microsoft windows")||-1!=t.search("ms-lsa")||-1!=t.search("msdtc")||-1!=t.search("msmq")||-1!=t.search("dce-rpc")||-1!=t.search("ms message queue")||-1!=t.search("rpc  windows")||-1!=t.search("microsoft rpc")||-1!=t.search("msrpc")||-1!=t.search(".exe")||-1!=t.search("epmap")?"icons/os/windows.png":-1!=t.search("linux kernel")?"icons/os/linux.png":-1!=t.search("x11")?"icons/services/x11.png":-1!=t.search("cisco")||-1!=t.search("tacacs")?"icons/os/cisco.png":-1!=t.search("sip")?"icons/purpose/voip_client.png":-1!=t.search("bgp")?"icons/purpose/router.png":-1!=t.search("ilo")?"icons/os/hp.png":-1!=t.search("bitcoin")?"icons/services/bitcoin.png":-1!=t.search("dameware")?"icons/services/dameware.png":-1!=t.search("zabbix")?"icons/services/zabbix.png":-1!=t.search("1c ")||"1c"==t?"icons/services/1c.png":-1!=t.search("adobe")?"icons/services/adobe.png":-1!=t.search("nagios")?"icons/services/nagios.png":-1!=t.search("modbus")?"icons/services/modbus.png":"time"==t||"ntp"==t?"icons/services/time.png":-1!=t.search("netbios")?"icons/services/netbios.png":-1!=t.search("abyss")?"icons/services/abyss.png":-1!=t.search("kerberos")||-1!=t.search("kpasswd")?"icons/services/kerberos.png":-1!=t.search("proxy")||-1!=t.search("socks")?"icons/services/proxy.png":-1!=t.search("tomcat")||-1!=t.search("ajp13")?"icons/services/apache-tomcat.png":"system"==t||"freebsd kernel"==t?"icons/services/system.png":"icons/unknown.png"}catch{}return l}function qe(e){var l="icons/unknown.png";try{var t=e.toLowerCase();if(-1!=t.search("tcp"))return"icons/services/proto/tcp.png";if(-1!=t.search("udp"))return"icons/services/proto/udp.png"}catch{}return l}function Ee(e){var l="icons/unknown.png";try{var t=e.toLowerCase();if(-1!=t.search("ios"))return"icons/os/os_name/cisco/ios.png";if(-1!=t.search("ilo"))return"icons/os/os_name/hp/ilo.png";if(-1!=t.search("junos"))return"icons/os/os_name/freebsd/junos.png";if("macos"==t||-1!=t.search("os x"))return"icons/os/macos.png";if(-1!=t.search("astra"))return"icons/os/os_name/linux/astra.png";if(-1!=t.search("debian"))return"icons/os/os_name/linux/debian.png";if(-1!=t.search("ubuntu"))return"icons/os/os_name/linux/ubuntu.png";if(-1!=t.search("gentoo"))return"icons/os/os_name/linux/gentoo.png";if(-1!=t.search("centos"))return"icons/os/os_name/linux/centos.png";if(-1!=t.search("arch"))return"icons/os/os_name/linux/arch.png";if(-1!=t.search("elementary"))return"icons/os/os_name/linux/elementary.png";if(-1!=t.search("manjaro"))return"icons/os/os_name/linux/manjaro.png";if(-1!=t.search("opensuse"))return"icons/os/os_name/linux/opensuse.png";if(-1!=t.search("slackware"))return"icons/os/os_name/linux/slackware.png";if(-1!=t.search("red hat")||-1!=t.search("enterprise linux"))return"icons/os/os_name/linux/redhat.png";if(-1!=t.search("kali"))return"icons/os/os_name/linux/kali.png";if(-1!=t.search("mandriva"))return"icons/os/os_name/linux/mandriva.png";if(-1!=t.search("mint"))return"icons/os/os_name/linux/mint.png";if(-1!=t.search("fedora"))return"icons/os/os_name/linux/fedora.png";if(-1!=t.search("linux"))return"icons/os/linux.png";if(-1!=t.search("windows"))return-1!=t.search("windows 7")||-1!=t.search("2008 r2")?"icons/os/os_name/windows/7.png":-1!=t.search("windows 8")||-1!=t.search("2012")?"icons/os/os_name/windows/8.png":-1!=t.search("windows 10")||-1!=t.search("2016")||-1!=t.search("2019")?"icons/os/os_name/windows/10.png":-1!=t.search("windows xp")||-1!=t.search("2003")?"icons/os/os_name/windows/xp.png":-1!=t.search("windows vista")||-1!=t.search("2008")?"icons/os/os_name/windows/vista.png":-1!=t.search("windows 11")||-1!=t.search("2022")?"icons/os/os_name/windows/11.png":"icons/os/windows.png";if(-1!=t.search("esxi"))return"icons/os/vmware.png";if(-1!=t.search("vcenter"))return"icons/os/os_name/vmware/vcenter.png";if(-1!=t.search("solaris"))return"icons/os/os_name/unix/sun/solaris.png";if(-1!=t.search("embedded"))return"icons/os/embedded.png"}catch{}return l}function Xe(e){var l=null;try{var t=e.toLowerCase();if(-1!=t.search("nmap"))return"icons/notes/nmap.png";if(-1!=t.search("vipnet"))return"icons/notes/vipnet.png";if(-1!=t.search("cacti"))return"icons/notes/cacti.png";if(-1!=t.search("maxpatrol"))return"icons/notes/maxpatrol.png";if(-1!=t.search("sqlmap")||-1!=t.search("sqlinjection")||-1!=t.search("sql_injection")||-1!=t.search("sql.injection"))return"icons/notes/sqlinjection.png";if(-1!=t.search("putty"))return"icons/notes/putty.png";if(-1!=t.search("http."))return"icons/services/http.png";if(-1!=t.search("smb."))return"icons/services/smb.png";if(-1!=t.search("snmp."))return"icons/services/snmp.png";if(-1!=t.search("ssh."))return"icons/services/ssh.png";if(-1!=t.search("host."))return"icons/purpose/pc.png";if(-1!=t.search("chrome"))return"icons/notes/chrome.png";if(-1!=t.search("firefox"))return"icons/notes/firefox.png";if(-1!=t.search("edge"))return"icons/notes/edge.png";if(-1!=t.search("opera"))return"icons/notes/opera.png";if(-1!=t.search("yandex"))return"icons/notes/yandex.png";if(-1!=t.search("explorer"))return"icons/notes/ie.png";if(-1!=t.search("outlook"))return"icons/notes/outlook.png";if(-1!=t.search("thebat")||-1!=t.search("the bat"))return"icons/notes/thebat.png";if(-1!=t.search("thunderbird"))return"icons/notes/thunderbird.png";if(-1!=t.search("keepass"))return"icons/notes/keepass.png";if(-1!=t.search("windows"))return"icons/os/windows.png";if(-1!=t.search("linux")||-1!=t.search("shadow")||-1!=t.search("passwd")||-1!=t.search("ifconfig"))return"icons/os/linux.png";if(-1!=t.search("drupal"))return"icons/notes/drupal.png";if(-1!=t.search("macroscop"))return"icons/notes/macroscope.png";if(-1!=t.search("wifi"))return"icons/notes/wifi.png";if(-1!=t.search("wordpress"))return"icons/notes/wordpress.png";if(-1!=t.search("kaspersky"))return"icons/notes/kaspersky.png";if(-1!=t.search("drweb")||-1!=t.search("dr.web"))return"icons/notes/drweb.png";if(-1!=t.search("cme")||-1!=t.search("crackmap"))return"icons/notes/cme.png";if(-1!=t.search("meterpreter")||-1!=t.search("metasploit"))return"icons/notes/metasploit.png";if(-1!=t.search("teamviewer"))return"icons/notes/teamviewer.png";if(-1!=t.search("anydesk"))return"icons/notes/anydesk.png";if(-1!=t.search("kerio"))return"icons/notes/kerio.png";if(-1!=t.search("joomla"))return"icons/notes/joomla.png";if(-1!=t.search("domain.")||-1!=t.search("ad_")||-1!=t.search("ad."))return"icons/notes/ad.png";if(-1!=t.search("qemu"))return"icons/notes/qemu.png";if(-1!=t.search("eset")||-1!=t.search("nod32"))return"icons/notes/eset.png";if(-1!=t.search("virtualbox"))return"icons/notes/virtualbox.png";if(-1!=t.search("donpapi")||-1!=t.search("dploot"))return"icons/notes/donpapi.png";if(-1!=t.search("infotecs")||-1!=t.search("vipnet"))return"icons/notes/infotecs.png";if(-1!=t.search("апкш")||-1!=t.search("континент")||-1!=t.search("continent")||-1!=t.search("secretnet"))return"icons/notes/kodbezopasnosti.png";if(-1!=t.search("perco"))return"icons/notes/perco.png";if(-1!=t.search("sigur"))return"icons/notes/sigur.png";if(-1!=t.search("sigur"))return"icons/notes/sigur.png";if(-1!=t.search("trassir"))return"icons/notes/trassir.png";if(-1!=t.search("creds"))return"icons/notes/creds.png";l=Te(t)}catch{}return l}function Ke(e){var l=null;try{if(null!=e&&void 0!=e&&""!=e){var t=e.toLowerCase();if(-1!=t.search("password"))return"icons/password.png";if(-1!=t.search("ntlm"))return"icons/os/windows.png";if(-1!=t.search("nonreplayablehash"))return"icons/md5.png";if(-1!=t.search("sshkey"))return"icons/services/ssh.png"}}catch{}return l}function Le(e){var l="icons/extensions/document.png";try{if(null!=e&&void 0!=e&&""!=e){var t=e.toLowerCase();if(-1!=t.search(".json"))return"icons/extensions/json.png";if(-1!=t.search(".png")||-1!=t.search(".jpg")||-1!=t.search(".jpeg")||-1!=t.search(".gif")||-1!=t.search(".tiff")||-1!=t.search(".svg"))return"icons/extensions/photo.png";if(-1!=t.search(".css"))return"icons/extensions/css.png";if(-1!=t.search(".doc"))return"icons/extensions/word.png";if(-1!=t.search(".xls"))return"icons/extensions/excel.png";if(-1!=t.search(".ppt"))return"icons/extensions/powerpoint.png";if(-1!=t.search(".mp3")||-1!=t.search(".wav")||-1!=t.search(".flac")||-1!=t.search(".aac")||-1!=t.search(".ogg"))return"icons/extensions/audio.png";if(-1!=t.search(".txt")||-1!=t.search(".log"))return"icons/extensions/notepad.png";if(-1!=t.search(".ini")||-1!=t.search(".cfg")||-1!=t.search(".conf")||-1!=t.search(".config")||-1!=t.search(".settings"))return"icons/extensions/settings.png";if(-1!=t.search(".pdf"))return"icons/extensions/pdf.png";if(-1!=t.search(".xml"))return"icons/extensions/xml.png";if(-1!=t.search(".gitignore"))return"icons/services/git.png";if(-1!=t.search(".php"))return"icons/extensions/php.png";if(-1!=t.search(".html")||-1!=t.search(".htm"))return"icons/extensions/html.png";if(-1!=t.search(".py"))return"icons/extensions/python.png";if(-1!=t.search(".ico"))return"icons/extensions/ico.png";if(-1!=t.search(".mp4")||-1!=t.search(".mpeg")||-1!=t.search(".mpg")||-1!=t.search(".avi")||-1!=t.search(".mov")||-1!=t.search(".mkv")||-1!=t.search(".webm")||-1!=t.search(".wmv"))return"icons/extensions/video.png";if(-1!=t.search(".exe"))return"icons/extensions/exe.png";if(-1!=t.search(".db")||-1!=t.search(".sql"))return"icons/extensions/db.png";if(-1!=t.search(".markdown")||-1!=t.search(".md"))return"icons/extensions/markdown.png";if(-1!=t.search(".java")||-1!=t.search(".jar")||-1!=t.search(".war")||-1!=t.search(".ear")||-1!=t.search(".jmod"))return"icons/extensions/java.png";if(-1!=t.search(".aspx")||-1!=t.search(".cshtml")||-1!=t.search(".cs"))return"icons/extensions/aspnet.png";if(-1!=t.search(".iso"))return"icons/extensions/iso.png";if(-1!=t.search("dockerfile"))return"icons/extensions/docker.png";if(-1!=t.search(".vue"))return"icons/extensions/vue.png";if(-1!=t.search(".rar")||-1!=t.search(".zip")||-1!=t.search(".7z")||-1!=t.search(".tar")||-1!=t.search(".gz"))return"icons/extensions/winrar.png";if(-1!=t.search(".dll"))return"icons/extensions/dll.png";if(-1!=t.search(".js"))return"icons/extensions/javascript.png";if(-1!=t.search(".ts"))return"icons/extensions/typescript.png";if(-1!=t.search(".rb"))return"icons/extensions/ruby.png"}}catch{}return l}t(5382);const ze=[{label:"#Hosts",id:0,type:"root",purpose:"directory",ticked:!1,lazy:!1,children:[{label:"Subnets",id:1,type:"directory",purpose:"hosts.subnets",ticked:!1,lazy:!0,mask:24,int_ext:!1,children:[]},{label:"Tags",id:2,type:"directory",purpose:"hosts.tags",ticked:!1,lazy:!0,children:[]},{label:"Operating System",id:3,type:"directory",purpose:"hosts.os",ticked:!1,lazy:!0,children:[]},{label:"Purpose",id:4,type:"directory",purpose:"hosts.purposes",ticked:!1,lazy:!0,children:[]}]},{label:"#Services",id:5,type:"root",purpose:"directory",ticked:!1,lazy:!1,children:[{label:"Ports",id:6,type:"directory",purpose:"services.ports",ticked:!1,lazy:!0,children:[]},{label:"Service Name",id:7,type:"directory",purpose:"services.names",ticked:!1,lazy:!0,children:[]}]},{label:"#Notes",id:8,type:"root",purpose:"directory",ticked:!1,lazy:!1,children:[{label:"Notes Type",id:9,type:"directory",purpose:"notes.ntypes",ticked:!1,lazy:!0,children:[]}]},{label:"#Vulns",id:10,type:"root",purpose:"directory",ticked:!1,lazy:!1,children:[{label:"Name",id:11,type:"directory",purpose:"vulns.names",ticked:!1,lazy:!0,children:[]},{label:"Exploited",id:12,type:"directory",purpose:"vulns.exploited",ticked:!1,lazy:!0,children:[]},{label:"References",id:13,type:"directory",purpose:"vulns.refs",ticked:!1,lazy:!0,children:[]}]},{label:"#Creds",id:14,type:"root",purpose:"directory",ticked:!1,lazy:!1,children:[{label:"Usernames",id:15,type:"directory",purpose:"creds.usernames",ticked:!1,lazy:!0,children:[]},{label:"Passwords",id:16,type:"directory",purpose:"creds.passwords",ticked:!1,lazy:!0,children:[]},{label:"Access Rights",id:17,type:"directory",purpose:"creds.access_levels",ticked:!1,lazy:!0,children:[]}]},{label:"#Loots",id:18,type:"root",purpose:"directory",ticked:!1,lazy:!1,children:[{label:"Loots Type",id:19,type:"directory",purpose:"loots.ltypes",ticked:!1,lazy:!0,children:[]}]}],Ne={name:"PageIndex",props:{item:{type:Array,default:[]}},setup(){const e=(0,s.Pj)(),l=(0,pe.A)(),t=((0,n.KR)(!1),(0,n.KR)([...ze])),o=[],r=((0,n.KR)(null),(0,n.KR)(e.state.users),(0,n.KR)("Hosts")),d=(0,n.KR)([]),u=(0,n.KR)([]),c=(0,n.KR)(""),p=(0,n.KR)(null),m=(0,n.KR)(null),b=(0,n.KR)(e.state.event_host),g=(0,n.KR)(e.state.user_settings),v=(0,n.KR)(!1),f=(0,n.KR)(19);function _(){}function k(e,l){const t=l.toLowerCase();return e.label&&(e.label.toLowerCase().indexOf(t)>-1||e.purpose.toLowerCase().indexOf(t)>-1)}function y(){c.value="",p.value.focus()}async function h(t){var a="/api/v1/Tree",o={workspace:e.state.current_project,data:We.o4.encode(JSON.stringify(F(t)))},n=await(0,i.L)(a,o,null,e.state.current_user.token);return void 0==n||0==n?(n.hasOwnProperty("message")&&(0,Ie.e)(l,"negative","Error",n.message,"report_problem"),[]):n.hasOwnProperty("data")?(n.data.forEach(e=>{e.id=f.value+1,f.value++}),n.data):void 0}async function C({node:e,key:l,done:t,fail:a}){var o=[];o=await h(e),t(o)}function F(e){const{children:l,...t}=e,a={...t};return a}function x(e,l){let t=null;function a(e){return e.id===l?(t=e,!0):Array.isArray(e.children)&&e.children.some(a)}return e.some(a),t}function A(e,l){let t=null;function a(e){return e.id_host===l?(t=e,!0):Array.isArray(e.children)&&e.children.some(a)}return e.some(a),t}function w(e,l){let t=null;var a=null;function o(e){if(Array.isArray(e.children))a=e;else if(e.id==l)return a.children.splice(a.children.indexOf(e),1),!0;return Array.isArray(e.children)&&e.children.some(o)}return e.some(o),t}function S(l){if(null==l)e.commit("SET_CURRENT_TREE_NODE",e.state.current_tree_node);else{var a=JSON.parse(JSON.stringify(x(t.value,l)));delete a.children,e.commit("SET_CURRENT_TREE_NODE",a)}}async function V(e){var l=[];l=await h(e),l.length>0&&("host"!=e.type?e.children=l:e=l[0])}function Q(e){1==v.value?v.value=!1:v.value=!0}function I(e){const l=e.ticked;function t(e){return e.ticked=l,Array.isArray(e.children)&&e.children.some(t)}t(e)}function W(t){let a=e.state.mask;l.dialog({component:Ve,componentProps:{}}).onOk(()=>{d.value.length>0&&a!=e.state.mask&&V(t)})}function D(l){e.commit("SET_TYPE_TREE",l)}return(0,a.sV)(()=>{_()}),(0,a.hi)(()=>{}),(0,a.wB)(()=>e.state.event_host,()=>{if(null!=e.state.event_host){let l=e.state.event_host.event;l="edit_host",l="add_host",l="del_host",e.commit("SET_EVENT_HOST",null)}}),(0,a.wB)(()=>e.state.user_settings,()=>{null!=e.state.user_settings&&(g.value=e.state.user_settings)}),(0,a.wB)(()=>e.state.mask,()=>{t.value[0].children[0].mask=e.state.mask}),{context_refresh:V,sel_ticked:I,mask_dialog:W,myFilterMethod:k,resetFilter:y,handleSelectItem:S,findById:x,findByhostId:A,delByhostId:w,onLazyLoad:C,ticked_tree:Q,loadData:h,change_type_tree:D,hosts_osfamily_icon:Re,hosts_purpose_icon:De,services_name_icon:Te,services_proto_icon:qe,hosts_os_name_icon:Ee,notes_type_icon:Xe,filter:c,lazy:(0,n.KR)(t),filterRef:p,user_settings:g,selected:r,ticked:u,f_ticked:v,Items:t,event_host:b,last_index:f,Data_load:o,expanded:d,treeRef:m}}};var Pe=t(8958),Me=t(9270),Ue=t(492),je=t(2220),Be=t(460),Je=t(5046),He=t(7410),$e=t(4436),Ge=t(3999),Ye=t(124),Ze=t(5173),el=t(3796),ll=t(386),tl=t(7716),al=t(8672);const ol=(0,_e.A)(Ne,[["render",ue]]),nl=ol;we()(Ne,"components",{QScrollArea:Pe.A,QInput:Me.A,QIcon:Ue.A,QTree:je.A,QCheckbox:Be.A,QImg:Je.A,QTooltip:He.A,QMenu:$e.A,QList:Ge.A,QItem:Ye.A,QItemSection:Ze.A,QItemLabel:el.A,QSeparator:ll.A,QPage:tl.A}),we()(Ne,"directives",{ClosePopup:al.A});const sl={class:"fit row wrap justify-start"};function il(e,l,t,o,n,s){const i=(0,a.g2)("table-hosts"),r=(0,a.g2)("table-services"),d=(0,a.g2)("table-notes"),u=(0,a.g2)("table-creds"),c=(0,a.g2)("table-vulns"),p=(0,a.g2)("table-loots"),m=(0,a.g2)("Web"),g=(0,a.g2)("Sessions"),v=(0,a.g2)("q-tab-panel"),f=(0,a.g2)("web"),_=(0,a.g2)("sessions"),k=(0,a.g2)("q-tab-panels"),y=(0,a.g2)("q-icon"),h=(0,a.g2)("q-label"),C=(0,a.g2)("q-badge"),F=(0,a.g2)("q-tab"),x=(0,a.g2)("q-tabs"),A=(0,a.g2)("q-splitter");return(0,a.uX)(),(0,a.Wv)(A,{modelValue:o.splitterModel2,"onUpdate:modelValue":l[2]||(l[2]=e=>o.splitterModel2=e),horizontal:"",style:{"max-height":"100vh"}},{before:(0,a.k6)(()=>[(0,a.Lk)("div",null,["hosts"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(i,{key:0})):(0,a.Q3)("",!0),"services"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(r,{key:1})):(0,a.Q3)("",!0),"notes"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(d,{key:2})):(0,a.Q3)("",!0),"creds"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(u,{key:3})):(0,a.Q3)("",!0),"vulns"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(c,{key:4})):(0,a.Q3)("",!0),"loots"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(p,{key:5})):(0,a.Q3)("",!0),"web"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(m,{key:6})):(0,a.Q3)("",!0),"sessions"==o.CurrentTab?((0,a.uX)(),(0,a.Wv)(g,{key:7})):(0,a.Q3)("",!0)])]),after:(0,a.k6)(()=>[(0,a.Lk)("div",sl,[(0,a.bF)(k,{modelValue:o.Tab,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Tab=e),animated:"",class:"col"},{default:(0,a.k6)(()=>[(0,a.bF)(v,{name:"hosts",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(i)]),_:1}),(0,a.bF)(v,{name:"services",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(r)]),_:1}),(0,a.bF)(v,{name:"notes",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(d)]),_:1}),(0,a.bF)(v,{name:"creds",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u)]),_:1}),(0,a.bF)(v,{name:"vulns",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(c)]),_:1}),(0,a.bF)(v,{name:"loots",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(p)]),_:1}),(0,a.bF)(v,{name:"web",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(f)]),_:1}),(0,a.bF)(v,{name:"sessions",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(_)]),_:1})]),_:1},8,["modelValue"]),(0,a.bF)(x,{modelValue:o.Tab,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Tab=e),vertical:""},{default:(0,a.k6)(()=>["hosts"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:0,name:"hosts"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"computer",color:"black",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[3]||(l[3]=[(0,a.eW)("Hosts",-1)])]),_:1}),0!=o.CountInformation.hosts?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.hosts),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"services"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:1,name:"services"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"sip",color:"orange",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[4]||(l[4]=[(0,a.eW)("Services",-1)])]),_:1}),0!=o.CountInformation.services?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.services),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"notes"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:2,name:"notes"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"description",color:"grey-9",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[5]||(l[5]=[(0,a.eW)("Notes",-1)])]),_:1}),0!=o.CountInformation.notes?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.notes),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"creds"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:3,name:"creds"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"key",color:"black",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Creds",-1)])]),_:1}),0!=o.CountInformation.creds?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.creds),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"vulns"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:4,name:"vulns"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"gpp_bad",color:"red",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Vulns",-1)])]),_:1}),0!=o.CountInformation.vulns?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.vulns),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"loots"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:5,name:"loots"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"diamond",color:"blue",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Loots",-1)])]),_:1}),0!=o.CountInformation.loots?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.loots),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"web"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:6,name:"web"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"web",color:"indigo-13",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Web",-1)])]),_:1}),0!=o.CountInformation.web?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.web),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0),"sessions"!=o.CurrentTab?((0,a.uX)(),(0,a.Wv)(F,{key:7,name:"sessions"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{name:"token",color:"green",size:"md"}),(0,a.bF)(h,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Sessions",-1)])]),_:1}),0!=o.CountInformation.sessions?((0,a.uX)(),(0,a.Wv)(C,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.sessions),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}const rl={key:0},dl={key:1},ul={key:2},cl={key:4},pl={key:3,align:"right"},ml={key:4,class:"truncate-text"};function bl(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("DownloadButtonMenu"),d=(0,a.g2)("q-toggle"),u=(0,a.g2)("q-item-section"),c=(0,a.g2)("q-item"),p=(0,a.g2)("q-separator"),m=(0,a.g2)("q-icon"),g=(0,a.g2)("q-avatar"),v=(0,a.g2)("q-item-label"),f=(0,a.g2)("q-list"),_=(0,a.g2)("q-menu"),k=(0,a.g2)("TableComponentsName"),y=(0,a.g2)("q-input"),h=(0,a.g2)("q-checkbox"),C=(0,a.g2)("q-th"),F=(0,a.g2)("q-tr"),x=(0,a.g2)("q-popup-proxy"),A=(0,a.g2)("q-td"),w=(0,a.g2)("q-img"),S=(0,a.g2)("TableHostColumn"),V=(0,a.g2)("q-badge"),Q=(0,a.g2)("ActionsButtons"),I=(0,a.g2)("q-table"),W=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(I,{title:"Сервисы",rows:o.Rows,columns:o.columns,"row-key":"id",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),"selected-rows-label":o.getSelectedString,selection:"multiple",dense:"",selected:o.selected,"onUpdate:selected":l[6]||(l[6]=e=>o.selected=e),onSelection:o.handleSelectRow,loading:o.loading,filter:o.filter,"visible-columns":o.visibleColumns,"filter-method":o.customFilter},{"top-left":(0,a.k6)(()=>[(0,a.bF)(i,{color:"green",icon:"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:o.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.loadData())}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",icon:"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:o.deleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"indigo-7","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{table:o.q_table},null,8,["table"])]),_:1}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:1,color:"green",icon:"edit",label:"Edit Rows","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(_,null,{default:(0,a.k6)(()=>[(0,a.bF)(f,{style:{"min-width":"100px"}},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[void 0!=e.mditeable&&1==e.mditeable?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{key:0,clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"blue",label:e.label,modelValue:o.selection_edititems,"onUpdate:modelValue":l[1]||(l[1]=e=>o.selection_edititems=e),"left-label":"",val:e.field},null,8,["label","modelValue","val"])]),_:2},1024)]),_:2},1024)),[[W]]):(0,a.Q3)("",!0)]))),256)),(0,a.bF)(p),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{onClick:l[2]||(l[2]=e=>o.editservicesvalue_show()),clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(u,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(g,{rounded:""},{default:(0,a.k6)(()=>[(0,a.bF)(m,{name:"edit",size:"md"})]),_:1})]),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)(" Edit ",-1)])]),_:1})]),_:1})]),_:1})),[[W]])]),_:1})]),_:1})]),_:1})):(0,a.Q3)("",!0),(0,a.bF)(d,{modelValue:o.tableSelectable,"onUpdate:modelValue":l[3]||(l[3]=e=>o.tableSelectable=e),color:"blue",label:"Select Rows"},null,8,["modelValue"])]),"top-right":(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(k,{name:"services",label:"Services",icon:{name:"sip",color:"orange"}}),(0,a.bF)(y,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[4]||(l[4]=e=>o.filter=e),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(m,{name:"search"})]),_:1},8,["modelValue"])])]),header:(0,a.k6)(e=>[(0,a.bF)(F,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(C,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(C,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(x,{"context-menu":""},{default:(0,a.k6)(()=>[l[8]||(l[8]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(d,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[5]||(l[5]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[0!=e.row.port?((0,a.uX)(),(0,a.Wv)(F,{key:0,props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(A,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(h,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(A,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["name"==l.name?((0,a.uX)(),(0,a.CE)("div",rl,[null!=o.services_name_icon(l.value)?((0,a.uX)(),(0,a.Wv)(w,{key:0,src:o.services_name_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.Q3)("",!0),(0,a.Lk)("b",null,(0,b.v_)(l.value),1)])):"host"==l.name?((0,a.uX)(),(0,a.CE)("div",dl,[(0,a.bF)(S,{model:l.value},null,8,["model"])])):"state"==l.name?((0,a.uX)(),(0,a.CE)("div",ul,["state"==l.name&&"open"==l.value?((0,a.uX)(),(0,a.Wv)(V,{key:0,color:"green"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.value),1)]),_:2},1024)):"state"==l.name&&"filtered"==l.value?((0,a.uX)(),(0,a.Wv)(V,{key:1,color:"brown"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.value),1)]),_:2},1024)):"state"==l.name&&"closed"==l.value?((0,a.uX)(),(0,a.Wv)(V,{key:2,color:"red"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.value),1)]),_:2},1024)):"state"==l.name&&"unknown"==l.value?((0,a.uX)(),(0,a.Wv)(V,{key:3,color:"purple"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.value),1)]),_:2},1024)):((0,a.uX)(),(0,a.CE)("div",cl,(0,b.v_)(l.value),1))])):"actions"==l.name?((0,a.uX)(),(0,a.CE)("div",pl,[(0,a.bF)(Q,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):((0,a.uX)(),(0,a.CE)("div",ml,(0,b.v_)(l.value),1))]),_:2},1024))),128))]),_:2},1032,["props"])):(0,a.Q3)("",!0)]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns","filter-method"])}const gl={class:"q-pa-md"},vl={class:"text-h6"};function fl(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-label"),v=(0,a.g2)("q-img"),f=(0,a.g2)("SelectWithIPFilter"),_=(0,a.g2)("q-input"),k=(0,a.g2)("q-select"),y=(0,a.g2)("SelectWithFilter"),h=(0,a.g2)("q-card-actions"),C=(0,a.g2)("q-card"),F=(0,a.g2)("q-dialog"),x=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(F,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(C,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[x]])]),_:1}),(0,a.Lk)("div",gl,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"sip"})]),_:1}),(0,a.Lk)("div",vl,(0,b.v_)(o.CardName),1)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.host.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"pin",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[12]||(l[12]=[(0,a.eW)("Порт:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.port),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[13]||(l[13]=[(0,a.eW)("Состояние:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.state),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.services_name_icon(o.CardData.name),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)("Служба:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)("Информация:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.info),1)]),_:1})])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(f,{modelValue:o.CardData.host,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.host=e),ref:"ipRef",rules:o.ipRules,selectOptions:o.SelectOptionsName,label:"IP-адрес",hint:"Text"},null,8,["modelValue","rules","selectOptions"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.port,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.port=e),label:"Порт",hint:"Number",type:"number","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"pin"})]),_:1},8,["modelValue"]),(0,a.bF)(k,{filled:"",modelValue:o.CardData.proto,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.proto=e),label:"Протокол",options:o.SelectOptionsProto,hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue","options"]),(0,a.bF)(k,{filled:"",modelValue:o.CardData.state,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.state=e),label:"Состояние",options:o.SelectOptionsState,hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue","options"]),(0,a.bF)(y,{modelValue:o.CardData.name,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.name=e),selectOptions:o.SelectOptionsName,ImageFunction:o.services_name_icon,label:"Служба",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.info,"onUpdate:modelValue":l[7]||(l[7]=e=>o.CardData.info=e),label:"Информация",hint:"Text","lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue"])]),_:1}))]),(0,a.bF)(h,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const _l=["src"];function kl(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.ImageFunction(o.Model),style:{width:"25px",height:"25px"}},null,8,_l)]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const yl={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),r=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),d=(0,n.KR)(e.ImageFunction),u=(0,n.KR)(e.label),c=(0,n.KR)(e.hint),p=(0,s.Pj)();async function b(e,l,t){setTimeout(()=>{l(()=>{if(""===e)r.value=o.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();r.value=o.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},1500)}function g(e){t.value=e}async function v(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,p.state.current_user.token);void 0!=l&&0!=l&&(o.value=l.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l,image:d.value(l)}}))}return(0,a.KC)(()=>{v()}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:r,ImageFunction:d,filterFn:b,Label:u,Hint:c,setModel:g}}},hl=(0,_e.A)(yl,[["render",kl]]),Cl=hl;we()(yl,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const Fl=["src"];function xl(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-btn"),p=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(p,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Model=e),options:o.Options,label:o.Label,"option-label":"address",hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[void 0!=e.opt.image&&null!=e.opt.image?((0,a.uX)(),(0,a.Wv)(r,{key:0,avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.address),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[2]||(l[2]=[(0,a.eW)(" No results ",-1)])]),_:1}),(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{color:"green",icon:"add","no-caps":"",size:"sm",class:"button-top",label:"Add Host",onClick:l[0]||(l[0]=e=>o.AddNewHost())})]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.PrependIcon,style:{width:"25px",height:"25px"}},null,8,Fl)]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const Al={class:"q-pa-md"},wl={class:"text-h6"},Sl=["src"];function Vl(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-label"),v=(0,a.g2)("q-chip"),f=(0,a.g2)("q-img"),_=(0,a.g2)("q-input"),k=(0,a.g2)("q-select"),y=(0,a.g2)("SelectWithFilter"),h=(0,a.g2)("SelectWithFilterOSName"),C=(0,a.g2)("q-card-actions"),F=(0,a.g2)("q-card"),x=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(x,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(F,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[16]||(l[16]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[17]||(l[17]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[18]||(l[18]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[A]])]),_:1}),(0,a.Lk)("div",Al,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"computer"})]),_:1}),(0,a.Lk)("div",wl,(0,b.v_)(o.CardName),1)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[19]||(l[19]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"sell",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[20]||(l[20]=[(0,a.eW)("Теги:",-1)])]),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.CardData.tags,e=>((0,a.uX)(),(0,a.CE)("div",null,[null!=e.id?((0,a.uX)(),(0,a.Wv)(v,{key:0,color:"primary","text-color":"white",size:"md",icon:"sell"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1024)):(0,a.Q3)("",!0)]))),256))])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[21]||(l[21]=[(0,a.eW)("Mac-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.mac),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[22]||(l[22]=[(0,a.eW)("DNS/Netbios имя:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"power_settings_new",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[23]||(l[23]=[(0,a.eW)("Состояние:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.state),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(f,{src:o.hosts_osfamily_icon(o.CardData.os_family),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[24]||(l[24]=[(0,a.eW)("Семейство ОС:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.os_family),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(f,{src:o.hosts_os_name_icon(o.CardData.os_family),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[25]||(l[25]=[(0,a.eW)("Наименование ОС:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.os_name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"settings_applications",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[26]||(l[26]=[(0,a.eW)("Конфигурация ОС:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.os_flavor),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[27]||(l[27]=[(0,a.eW)("ОС Service Pack:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.os_sp),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"language",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[28]||(l[28]=[(0,a.eW)("Язык ОС:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.os_lang),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[29]||(l[29]=[(0,a.eW)("Архитектура:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.arch),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(f,{src:o.hosts_purpose_icon(o.CardData.purpose),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[30]||(l[30]=[(0,a.eW)("Тип хоста:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.purpose),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(f,{src:o.hosts_virtualization(o.CardData.virtual_host),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[31]||(l[31]=[(0,a.eW)("Виртуализация:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.virtual_host),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[32]||(l[32]=[(0,a.eW)("Информация:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.info),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[33]||(l[33]=[(0,a.eW)("Комментарий:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.comment),1)]),_:1})])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(d,{flat:"",color:"green",icon:"add",label:"Add Tag",onClick:o.showTagDialog},null,8,["onClick"]),(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.CardData.tags,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,style:{display:"inline"}},[null!=e.id?((0,a.uX)(),(0,a.Wv)(v,{removable:"",onRemove:l=>o.RemoveTag(e),key:e.id,color:"primary","text-color":"white",size:"md",icon:"sell"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1032,["onRemove"])):(0,a.Q3)("",!0)]))),128))]),(0,a.bF)(_,{id:"ip",filled:"",modelValue:o.CardData.address,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.address=e),label:"IP-адрес",hint:"Text",ref:"ipRef",rules:o.ipRules},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"cloud"})]),_:1},8,["modelValue","rules"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.mac,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.mac=e),label:"Mac-адрес",hint:"Text","lazy-rules":"",mask:"NN:NN:NN:NN:NN:NN","fill-mask":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.name,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.name=e),label:"DNS/Netbios имя",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue"]),(0,a.bF)(k,{filled:"",modelValue:o.CardData.state,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.state=e),label:"Состояние",options:o.SelectOptionsState,hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"power_settings_new"})]),_:1},8,["modelValue","options"]),(0,a.bF)(y,{modelValue:o.CardData.os_family,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.os_family=e),selectOptions:o.SelectOptionsOSFamily,ImageFunction:o.hosts_osfamily_icon,label:"Семейство ОС",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),(0,a.bF)(h,{modelValue:o.CardData.os_name,"onUpdate:modelValue":l[7]||(l[7]=e=>o.CardData.os_name=e),affectValue:o.CardData.os_family,selectOptions:o.SelectOptionsOSName,ImageFunction:o.hosts_os_name_icon,label:"Наименование ОС",hint:"Text"},null,8,["modelValue","affectValue","selectOptions","ImageFunction"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.os_flavor,"onUpdate:modelValue":l[8]||(l[8]=e=>o.CardData.os_flavor=e),label:"Конфигурация ОС",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"settings_applications"})]),_:1},8,["modelValue"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.os_sp,"onUpdate:modelValue":l[9]||(l[9]=e=>o.CardData.os_sp=e),label:"ОС Service Pack",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.os_lang,"onUpdate:modelValue":l[10]||(l[10]=e=>o.CardData.os_lang=e),label:"Язык ОС",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"language"})]),_:1},8,["modelValue"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.arch,"onUpdate:modelValue":l[11]||(l[11]=e=>o.CardData.arch=e),label:"Архитектура",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue"]),(0,a.bF)(y,{modelValue:o.CardData.purpose,"onUpdate:modelValue":l[12]||(l[12]=e=>o.CardData.purpose=e),selectOptions:o.SelectOptionsPurpose,ImageFunction:o.hosts_purpose_icon,label:"Тип хоста",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.virtual_host,"onUpdate:modelValue":l[13]||(l[13]=e=>o.CardData.virtual_host=e),label:"Виртуализация",hint:"Text","lazy-rules":""},(0,a.eX)({_:2},[null!=o.CardData.virtual_host&&""!=o.CardData.virtual_host?{name:"prepend",fn:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.hosts_virtualization(o.CardData.virtual_host),width:"24",height:"24"},null,8,Sl)]),key:"0"}:void 0]),1032,["modelValue"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.info,"onUpdate:modelValue":l[14]||(l[14]=e=>o.CardData.info=e),label:"Информация",hint:"Text","lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue"]),(0,a.bF)(_,{filled:"",modelValue:o.CardData.comments,"onUpdate:modelValue":l[15]||(l[15]=e=>o.CardData.comments=e),label:"Комментарий",hint:"Text","lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue"])]),_:1}))]),(0,a.bF)(C,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Ql=[{label:"Windows",value:"Windows",description:"Microsoft",image:"icons/os/windows.png"},{label:"Linux",value:"Linux",description:"Linux Kernel OS GNUGPL",image:"icons/os/Linux.png"},{label:"Unix",value:"Unix",description:"Unix OS",image:"icons/os/unix.png"},{label:"FreeBSD",value:"FreeBSD",description:"BSD",image:"icons/os/freebsd.png"},{label:"MacOS",value:"MacOS",description:"Apple MacOS, OSX",image:"icons/os/macos.png"},{label:"VMWare",value:"VMWare",description:"VMWare ESXI, vSphere",image:"icons/os/vmware.png"},{label:"Mikrotik",value:"Mikrotik",description:"Mikrotik RouterOS",image:"icons/os/mikrotik.png"},{label:"Cisco",value:"Cisco",description:"Cisco IOS",image:"icons/os/cisco.png"},{label:"HP",value:"HP",description:"HP devices",image:"icons/os/hp.png"},{label:"Huawei",value:"Huawei",description:"Huawei devices",image:"icons/os/huawei.png"},{label:"D-Link",value:"D-link",description:"D-Link devices",image:"icons/os/dlink.png"},{label:"TP-Link",value:"TP-link",description:"TP-Link devices",image:"icons/os/tplink.png"},{label:"Android",value:"Android",description:"Android OS",image:"icons/os/android.png"},{label:"iOS",value:"iOS",description:"Apple iOS",image:"icons/os/ios.png"},{label:"Unknown",value:"Unknown",description:"Unknown OS",image:"icons/unknown.png"}],Il=[{label:"Device",value:"device",description:"Другие устройства",image:"icons/purpose/device.png"},{label:"Client",value:"client",description:"ПК",image:"icons/purpose/pc.png"},{label:"Server",value:"server",description:"Сервер",image:"icons/purpose/server.png"},{label:"Router",value:"router",description:"Маршрутизатор",image:"icons/purpose/router.png"},{label:"Switch",value:"switch",description:"Коммутатор",image:"icons/purpose/switch.png"},{label:"Printer",value:"printer",description:"Принтер",image:"icons/purpose/printer.png"},{label:"PrintServer",value:"printserver",description:"Принт-сервер",image:"icons/purpose/printserver.png"},{label:"MultiFunction Peripheral (MFP) ",value:"mfp",description:"МФУ",image:"icons/purpose/mfp.png"},{label:"NAS",value:"nas",description:"NAS",image:"icons/purpose/nas.png"},{label:"IP Camera",value:"ip_camera",description:"IP-камера",image:"icons/purpose/ip_camera.png"},{label:"Digital Video Recorder (DVR)",value:"dvr",description:"Сервер видеонаблюдения",image:"icons/purpose/dvr.png"},{label:"Access Point",value:"access_point",description:"Wifi-маршрутизатор",image:"icons/purpose/wifi_router.png"},{label:"Voip Gateway",value:"voip_gw",description:"VOIP шлюз",image:"icons/purpose/voip_gw.png"},{label:"Voip Client",value:"voip_client",description:"Voip клиент",image:"icons/purpose/voip_client.png"},{label:"Cloud Store",value:"cloud_store",description:"Облачное хранилище",image:"icons/purpose/cloud_store.png"},{label:"Laptop",value:"laptop",description:"Ноутбук",image:"icons/purpose/laptop.png"},{label:"Tiny Client",value:"tiny_client",description:"Тонкий клиент",image:"icons/purpose/tiny_client.png"},{label:"Smartphone",value:"smartphone",description:"Смартфон",image:"icons/purpose/smart_phone.png"},{label:"TV",value:"tv",description:"Телевизор",image:"icons/purpose/tv.png"},{label:"Firewall",value:"firewall",description:"Межсетевой экран(Firewall)",image:"icons/purpose/firewall.png"},{label:"UPS",value:"ups",description:"Источник бесперебойного питания",image:"icons/purpose/ups.png"},{label:"IPMI",value:"ipmi",description:"Intelligent Platform Management Interface",image:"icons/purpose/ipmi.png"},{label:"Unknown",value:"unknown",description:"Неизвестное устройство",image:"icons/unknown.png"}],Wl=["src"];function Dl(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.ImageFunction(o.Model),style:{width:"25px",height:"25px"}},null,8,Wl)]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const Rl={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},filterFn:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),s=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),i=(0,n.KR)(e.ImageFunction),r=(0,n.KR)(e.filterFn),d=(0,n.KR)(e.label),u=(0,n.KR)(e.hint);function c(e){t.value=e}return"function"!==typeof r.value&&(r.value=(e,l,t)=>{l(()=>{const l=e.toLocaleLowerCase();s.value=o.value.filter(e=>e.label.toLocaleLowerCase().indexOf(l)>-1)})}),(0,a.wB)(t,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:s,ImageFunction:i,filterFn:r,Label:d,Hint:u,setModel:c}}},Ol=(0,_e.A)(Rl,[["render",Dl]]),Tl=Ol;we()(Rl,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const ql=["src"];function El(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image,style:{width:"25px",height:"25px"}},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[null!=o.ImageFunction(o.Model)?((0,a.uX)(),(0,a.CE)("img",{key:0,src:o.ImageFunction(o.Model),style:{width:"25px",height:"25px"}},null,8,ql)):(0,a.Q3)("",!0)]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const Xl={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},filterFn:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""},affectValue:{type:Object,default:null}},emits:[],setup(e,{emit:l}){const t=(0,s.Pj)(),o=(0,n.KR)(e.modelValue),r=(0,n.KR)(e.selectOptions),d=(0,n.KR)(JSON.parse(JSON.stringify(r.value))),u=(0,n.KR)(e.ImageFunction),c=(0,n.KR)(e.label),p=(0,n.KR)(e.hint),b=(0,n.KR)(e.affectValue);async function g(e,l,t){setTimeout(()=>{l(()=>{if(""===e)d.value=r.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();d.value=r.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},1500)}function v(e){o.value=e}async function f(){var e=(0,m.y)("table","Hosts","getUnicOSName"),l={os_family:b.value},a=await(0,i.b)(e,l,t.state.current_user.token);void 0!=a&&0!=a&&200==a.status&&(r.value=a.data.map(function(e){var l="";return null!=e.os_name&&(l=e.os_name),{value:e.os_name,label:l,image:u.value(e.os_name)}}))}return(0,a.KC)(()=>{f()}),(0,a.wB)(o,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{o.value=e}),(0,a.wB)(()=>e.affectValue,e=>{b.value=e,f()}),(0,a.wB)(()=>e.selectOptions,e=>{r.value=e}),{Model:o,SelectOptions:r,Options:d,ImageFunction:u,filterFn:g,Label:c,Hint:p,AffectValue:b,setModel:v,updateSelectOptionsOSName:f}}},Kl=(0,_e.A)(Xl,[["render",El]]),Ll=Kl;we()(Xl,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const zl={class:"q-pa-md"},Nl={key:0,style:{"padding-bottom":"40px","padding-top":"0px"}},Pl={class:"row justify-end"},Ml={style:{"padding-top":"20px"}};function Ul(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-input"),v=(0,a.g2)("q-separator"),f=(0,a.g2)("q-item-section"),_=(0,a.g2)("q-item"),k=(0,a.g2)("q-item-label"),y=(0,a.g2)("q-select"),h=(0,a.g2)("q-chip"),C=(0,a.g2)("expansion-item-hosts"),F=(0,a.g2)("q-card-actions"),x=(0,a.g2)("q-card"),A=(0,a.g2)("q-dialog"),w=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(A,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(x,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[w]])]),_:1}),(0,a.Lk)("div",zl,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"sell"})]),_:1}),l[9]||(l[9]=(0,a.Lk)("div",{class:"text-h6"}," Tags ",-1))]),_:1}),(0,a.bF)(d,{dense:"",flat:"",icon:o.btn_new_tag_prop.icon,label:o.btn_new_tag_prop.label,color:o.btn_new_tag_prop.color,onClick:l[2]||(l[2]=e=>o.new_tag_flag=!o.new_tag_flag)},null,8,["icon","label","color"]),1==o.new_tag_flag?((0,a.uX)(),(0,a.CE)("div",Nl,[(0,a.bF)(g,{hint:"Наименование Тега",modelValue:o.new_tag_value.name,"onUpdate:modelValue":l[3]||(l[3]=e=>o.new_tag_value.name=e)},null,8,["modelValue"]),(0,a.bF)(g,{hint:"Описание Тега",modelValue:o.new_tag_value.desc,"onUpdate:modelValue":l[4]||(l[4]=e=>o.new_tag_value.desc=e)},null,8,["modelValue"]),(0,a.Lk)("div",Pl,[(0,a.bF)(d,{label:"Add",color:"green",onClick:l[5]||(l[5]=e=>o.add_new_tag(o.new_tag_value))})]),(0,a.bF)(v)])):(0,a.Q3)("",!0),1!=o.new_tag_flag?((0,a.uX)(),(0,a.Wv)(y,{key:1,filled:"","use-input":"","input-debounce":"0",options:o.options2,onFilter:o.filterFn,"onUpdate:modelValue":o.setModel,hint:"Теги"},{"no-option":(0,a.k6)(()=>[(0,a.bF)(_,null,{default:(0,a.k6)(()=>[(0,a.bF)(f,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),option:(0,a.k6)(e=>[(0,a.bF)(_,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(k,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(k,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["options","onFilter","onUpdate:modelValue"])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.row.tags,e=>((0,a.uX)(),(0,a.Wv)(h,{removable:"",onRemove:l=>o.remove_chip(e),modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,key:e.id,icon:"sell","text-color":"white",color:"primary"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1032,["onRemove","modelValue","onUpdate:modelValue"]))),128))]),(0,a.Lk)("div",Ml,["Table"==o.original_call?((0,a.uX)(),(0,a.Wv)(C,{key:0,selected_hosts:o.row.hosts},null,8,["selected_hosts"])):(0,a.Q3)("",!0)])]),(0,a.bF)(F,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}t(6003);const jl={class:"text-grey-8 q-gutter-xs"};function Bl(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-chip"),u=(0,a.g2)("q-btn"),c=(0,a.g2)("q-item"),p=(0,a.g2)("q-expansion-item"),m=(0,a.g2)("q-list"),g=(0,a.gN)("ripple");return(0,a.uX)(),(0,a.Wv)(m,{bordered:"",class:"rounded-borders"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{"expand-separator":"",icon:"computer",label:"Hosts",caption:"Выбранные узлы","default-opened":""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.items,e=>(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{class:"img-os_family",src:o.hosts_osfamily_icon(e.os_family)},null,8,["src"]),null!=e.virtual_host&&""!=e.virtual_host?((0,a.uX)(),(0,a.Wv)(i,{key:0,class:"img-os_family",src:"icons/os/vmware_.png"})):(0,a.Q3)("",!0)]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.address),1)]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:o.hosts_purpose_icon(e.purpose),class:"node_icon"},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tags,e=>((0,a.uX)(),(0,a.CE)("div",null,[null!=e.id?((0,a.uX)(),(0,a.Wv)(d,{key:e.id,color:"primary","text-color":"white",size:"sm",icon:"sell",removable:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1024)):(0,a.Q3)("",!0)]))),256))]),_:2},1024),(0,a.bF)(r,{top:"",side:""},{default:(0,a.k6)(()=>[(0,a.Lk)("div",jl,[(0,a.bF)(u,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"close",onClick:l=>o.remove_item(e)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)),[[g]])),256))]),_:1})]),_:1})}const Jl={props:{selected_hosts:Array},setup(e){const l=(0,n.KR)(e.selected_hosts);function t(e){l.value.splice(l.value.filter(l=>l.id=e.id),1)}return{hosts_osfamily_icon:Re,hosts_purpose_icon:De,remove_item:t,items:l}}};var Hl=t(8841),$l=t(6760),Gl=t(9626);const Yl=(0,_e.A)(Jl,[["render",Bl]]),Zl=Yl;we()(Jl,"components",{QList:Ge.A,QExpansionItem:Hl.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QChip:$l.A,QBtn:xe.A}),we()(Jl,"directives",{Ripple:Gl.A});const et=[],lt={props:{selected_hosts:Array,original_call:String,tags:Array},emits:[...ge.A.emits],components:{ExpansionItemHosts:Zl},setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:i}=(0,ge.A)(),r=(0,pe.A)(),d=(0,s.Pj)(),u=(0,n.KR)([]),c=(0,n.KR)(null),p=(0,n.KR)(et),m=(0,n.KR)([...et]),b=(0,n.KR)(e.original_call),g=(0,n.KR)(e.tags),v=(0,n.KR)({label:"New Tag",icon:"add",color:"green"}),f=(0,n.KR)(!1),_=(0,n.KR)({id:-1,hosts:JSON.parse(JSON.stringify(e.selected_hosts)),tags:[]});void 0!=g.value&&null!=g.value&&(_.value.tags=JSON.parse(JSON.stringify(e.tags)));const k=(0,n.KR)({id:-1,name:"",desc:""});function y(e,l,t){setTimeout(()=>{l(()=>{if(""===e)p.value=m.value;else{const l=e.toLowerCase();p.value=m.value.filter(e=>e.label.toLowerCase().indexOf(l)>-1)}})},10)}function h(e){_.value.tags.push({id:e.id,name:e.label,desc:e.descriptions}),p.value.find(l=>l.id==e.id).disable=!0}function C(e){var l=_.value.tags.indexOf(_.value.tags.find(l=>l.id==e.id));_.value.tags.splice(l,1),p.value.find(l=>l.id==e.id).disable=!1}function F(){const e={Authorization:"Bearer "+d.state.current_user.token};Qe.api.get("/api/get_tags",{params:{},headers:e}).then(e=>{u.value=[],e.data.forEach(e=>{m.value.push({label:e.name,description:e.desc,id:e.id})}),update()}).catch(()=>{})}async function x(e){let l=new Promise((l,t)=>{setTimeout(()=>{l(!1);const t={Authorization:"Bearer "+d.state.current_user.token};Qe.api.post("/api/add_new_tag",{data:e},{headers:t}).then(e=>{200==e.data.rsp_k?(k.value.id=e.data.id,p.value.push({label:k.value.name,description:k.value.desc,id:k.value.id}),(0,Ie.e)(r,"positive","Тег добавлен","","done")):((0,Ie.e)(r,"negative","Ошибка",e.data.message,"report_problem"),l(!1))}).catch(()=>{(0,Ie.e)(r,"negative","Ошибка","","report_problem"),l(!1)})},1e3)}),t=await l;return t}async function A(e){let l=new Promise((l,t)=>{setTimeout(()=>{l(!1);const t={Authorization:"Bearer "+d.state.current_user.token};Qe.api.post("/api/add_tags_on_hosts",{data:e},{headers:t}).then(e=>{200==e.data.rsp_k?((0,Ie.e)(r,"positive","Тег добавлен","","done"),o({row:_})):((0,Ie.e)(r,"negative","Ошибка",e.data.message,"report_problem"),l(!1))}).catch(()=>{(0,Ie.e)(r,"negative","Ошибка","","report_problem"),l(!1)})},1e3)}),t=await l;return t}return(0,a.sV)(()=>{F()}),(0,a.wB)(()=>f.value,()=>{1==f.value?(v.value.label="Close",v.value.icon="remove",v.value.color="primary"):(v.value.label="New Tag",v.value.icon="add",v.value.color="green")}),(0,a.wB)(()=>p.value,()=>{_.value.tags.forEach(e=>{p.value.find(l=>l.id==e.id).disable=!0})}),{dialogRef:l,maximizedToggle:(0,n.KR)(!1),row:_,original_call:b,load_tags:F,tags:g,btn_new_tag_prop:v,new_tag_flag:f,new_tag_value:k,StringOptions:m,onDialogHide:t,add_tags_on_hosts:A,filterFn:y,remove_chip:C,options:u,options2:p,setModel:h,add_new_tag:x,dataRef:c,onOKClick(){try{if("Table"==b.value){var e={host_id:_.value.hosts.map(e=>e.id),tag_id:_.value.tags.map(e=>e.id)};A(e)}else o({row:_})}catch(e){}},onCancelClick:i}}};var tt=t(8670),at=t(3676),ot=t(4189),nt=t(3952);const st=(0,_e.A)(lt,[["render",Ul]]),it=st;we()(lt,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QInput:Me.A,QSeparator:ll.A,QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QItemLabel:el.A,QChip:$l.A,QCardActions:Fe.A}),we()(lt,"directives",{ClosePopup:al.A});const rt={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithFilter:Tl,SelectWithFilterOSName:Ll},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:a,onDialogCancel:o}=(0,ge.A)(),r=(0,pe.A)(),d=(0,s.Pj)(),u=(0,n.KR)(["alive","down"]),c=(0,n.KR)(Ql),p=(0,n.KR)([]),b=(0,n.KR)(Il),g=(0,n.KR)(e.CardAction),v=(0,n.KR)(e.CardName),f=(0,n.KR)(e.CardData);async function _(e){var l=(0,m.y)("table","Hosts","editItem"),t={workspace:d.state.current_project,data:e},o=await(0,i.L)(l,t,null,d.state.current_user.token);void 0!=o&&0!=o&&(200==o.status?(1==f.value.status&&(f.value.id=o.id,f.value.updated_at=o.updated_at),a(f.value),(0,Ie.e)(r,"positive","Запись отредактирована","","done")):(0,Ie.e)(r,"negative","Ошибка",o.message,"report_problem"))}async function k(e){var l=(0,m.y)("table","Hosts","addItem"),t={workspace:d.state.current_project,data:e},o=await(0,i.L)(l,t,null,d.state.current_user.token);void 0!=o&&0!=o&&(200==o.status?(f.value.id=o.id,f.value.created_at=o.created_at,f.value.updated_at=o.updated_at,a(f.value),(0,Ie.e)(r,"positive","Запись добавлена","","done")):(0,Ie.e)(r,"negative","Ошибка",o.message,"report_problem"))}function y(){r.dialog({component:it,componentProps:{selected_hosts:f.value,original_call:"Add",tags:f.value.tags}}).onOk(e=>{f.value.tags=e.row.value.tags})}function h(e){null!=f.value.tags&&f.value.tags!=[]&&(f.value.tags=f.value.tags.filter(l=>l.id!=e.id))}function C(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}return{dialogRef:l,SelectOptionsState:u,SelectOptionsOSFamily:c,SelectOptionsOSName:p,SelectOptionsPurpose:b,CardAction:g,CardName:v,CardData:f,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==C(e)||"Not valid IP-address"],Add:k,Edit:_,RemoveTag:h,showTagDialog:y,onOKClick(){"AddItem"==g.value?k(JSON.stringify(f.value)):"EditItem"==g.value?_(JSON.stringify(f.value)):a(null)},onCancelClick:o,hosts_osfamily_icon:Re,hosts_purpose_icon:De,hosts_os_name_icon:Ee,hosts_virtualization:Oe}}},dt=(0,_e.A)(rt,[["render",Vl]]),ut=dt;we()(rt,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QChip:$l.A,QImg:Je.A,QInput:Me.A,QSelect:Ce.A,QCardActions:Fe.A}),we()(rt,"directives",{ClosePopup:al.A});const ct={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},components:{AddEditItem:ut},emits:[],setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(e.modelValue),r=(0,n.KR)(e.selectOptions),d=(0,n.KR)(JSON.parse(JSON.stringify(r.value))),u=(0,n.KR)(e.ImageFunction),c=(0,n.KR)(e.label),p=(0,n.KR)(e.hint),b=(0,n.KR)("icons/unknown.png"),g=(0,s.Pj)(),v=(0,n.KR)(!0);function f(e){v.value||(o.value=e),v.value=!1,k(e)}async function _(e,l,t){setTimeout(()=>{l(()=>{if(""===e)d.value=r.value;else if(void 0!=e&&null!=e&&"string"==typeof e){const l=e.toLowerCase();r.value!=[]&&(d.value=r.value.filter(e=>null!=e.address&&e.address.toLowerCase().indexOf(l)>-1))}})},1500)}function k(e){try{var l=r.value.filter(l=>l.address==e);l.length>0?b.value=l[0].image:b.value="icons/unknown.png"}catch(e){b.value="icons/unknown.png"}}async function y(){var e=(0,m.y)("table","Hosts","getUnicIP"),l={workspace_id:g.state.current_project},t=await(0,i.b)(e,l,g.state.current_user.token);r.value=void 0!=t&&0!=t?t.map(function(e){return e.host.image=De(e.host.purpose),e.host}):[]}function h(){var e=o.value;"object"==typeof e&&(e=""),t.dialog({component:ut,componentProps:{CardAction:"AddItem",CardName:"Add Hosts",CardData:{address:e,mac:"",name:"",state:"alive",os_family:"Windows",os_name:"",os_flavor:"",os_sp:"",os_lang:"",arch:"",purpose:"device",virtual_host:"",tags:[],info:"",comments:""}}}).onOk(e=>{o.value=e,d.value.push(e),y()})}return(0,a.KC)(()=>{null!=o.value&&""!=o.value.address&&null!=o.value.address&&(b.value=De(o.value.purpose)),y()}),(0,a.nT)(()=>{r.value=e.selectOptions}),(0,a.wB)(o,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{o.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{r.value=e}),{Model:o,SelectOptions:r,Options:d,ImageFunction:u,Label:c,Hint:p,PrependIcon:b,FlagInit:v,filterFn:_,setModel:f,AddNewHost:h,hosts_purpose_icon:De,changePrependIcon:k}}},pt=(0,_e.A)(ct,[["render",xl]]),mt=pt;we()(ct,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A,QBtn:xe.A});const bt={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithFilter:Cl,SelectWithIPFilter:mt},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)(["open","filtred","closed","unknown"]),p=(0,n.KR)(["tcp","udp"]),b=(0,n.KR)([]),g=(0,n.KR)(e.CardAction),v=(0,n.KR)(e.CardName),f=(0,n.KR)(e.CardData);async function _(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,u.state.current_user.token);if(void 0!=l&&0!=l&&200==l.status){l.data.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l}})}}async function k(e){var l=(0,m.y)("table","Services","editItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(1==f.value.status&&(f.value.id=a.id,f.value.host=a.host,f.value.updated_at=a.updated_at),o(f.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function y(e){var l=(0,m.y)("table","Services","addItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(f.value.id=a.id,f.value.host=a.host,f.value.created_at=a.created_at,f.value.updated_at=a.updated_at,o(f.value),(0,Ie.e)(d,"positive","Запись добавлена","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}function h(){d.dialog({component:Tags,componentProps:{selected_hosts:f.value,original_call:"Add"}}).onOk(e=>{f.value.tags=e.row.value.tags})}function C(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}return(0,a.KC)(()=>{b.value=_()}),{dialogRef:l,SelectOptionsState:c,SelectOptionsProto:p,SelectOptionsName:b,CardAction:g,CardName:v,CardData:f,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==C(e)||"Not valid IP-address"],Add:y,Edit:k,showTagDialog:h,onOKClick(){"AddItem"==g.value?y(JSON.stringify(f.value)):"EditItem"==g.value?k(JSON.stringify(f.value)):o(null)},onCancelClick:r,services_name_icon:Te}}},gt=(0,_e.A)(bt,[["render",fl]]),vt=gt;we()(bt,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QImg:Je.A,QInput:Me.A,QSelect:Ce.A,QCardActions:Fe.A}),we()(bt,"directives",{ClosePopup:al.A});const ft={class:"q-pa-md"},_t=["src"];function kt(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-card-section"),p=(0,a.g2)("q-input"),m=(0,a.g2)("q-select"),g=(0,a.g2)("q-img"),v=(0,a.g2)("q-item-section"),f=(0,a.g2)("q-item-label"),_=(0,a.g2)("q-item"),k=(0,a.g2)("q-card-actions"),y=(0,a.g2)("q-card"),h=(0,a.g2)("q-dialog"),C=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(h,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[C]])]),_:1}),(0,a.Lk)("div",ft,[(0,a.bF)(c,null,{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.Lk)("div",{class:"text-h6"}," Edit Services Value ",-1)])]),_:1}),-1!=o.columns.indexOf("port")?((0,a.uX)(),(0,a.Wv)(p,{key:0,filled:"",modelValue:o.row.port,"onUpdate:modelValue":l[2]||(l[2]=e=>o.row.port=e),label:"Number",type:"number",hint:"Порт","lazy-rules":"",ref:"portRef",rules:o.portRules},null,8,["modelValue","rules"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("proto")?((0,a.uX)(),(0,a.Wv)(m,{key:1,filled:"",modelValue:o.row.proto,"onUpdate:modelValue":l[3]||(l[3]=e=>o.row.proto=e),label:"Text",options:o.options,hint:"Протокол","lazy-rules":""},null,8,["modelValue","options"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("state")?((0,a.uX)(),(0,a.Wv)(m,{key:2,filled:"","option-value":"value","option-label":"label","emit-value":"","map-options":"",modelValue:o.row.state,"onUpdate:modelValue":l[4]||(l[4]=e=>o.row.state=e),options:o.options1,label:"Text",hint:"Состояние","lazy-rules":""},null,8,["modelValue","options"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("name")?((0,a.uX)(),(0,a.Wv)(m,{key:3,filled:"",modelValue:o.row.name,"onUpdate:modelValue":l[5]||(l[5]=e=>o.row.name=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Text","emit-value":"",options:o.options2,onFilter:o.filterFn,onFilterAbort:o.abortFilterFn,onInputValue:o.setModel,hint:"Служба"},{option:(0,a.k6)(e=>[(0,a.bF)(_,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(v,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(g,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(_,null,{default:(0,a.k6)(()=>[(0,a.bF)(v,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[null!=o.services_name_icon(o.row.name)?((0,a.uX)(),(0,a.CE)("img",{key:0,src:o.services_name_icon(o.row.name),style:{width:"25px",height:"25px"}},null,8,_t)):(0,a.Q3)("",!0)]),_:1},8,["modelValue","options","onFilter","onFilterAbort","onInputValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("info")?((0,a.uX)(),(0,a.Wv)(p,{key:4,filled:"",modelValue:o.row.info,"onUpdate:modelValue":l[6]||(l[6]=e=>o.row.info=e),label:"Text",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.Q3)("",!0)]),(0,a.bF)(k,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"primary",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}t(2500);const yt=[],ht={props:{selected_items:Array,columns:Array},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:i}=(0,ge.A)(),r=(0,pe.A)(),d=(0,s.Pj)(),u=(0,n.KR)(null),c=(0,n.KR)(null),p=(0,n.KR)(["tcp","udp"]),m=(0,n.KR)([{label:'<span class="text-positive text-weight-bold">open</span>',value:"open",html:!0},{label:'<span class="text-brown-8 text-weight-bold">filtered</span>',value:"filtered",html:!0},{label:'<span class="text-negative text-weight-bold">closed</span>',value:"closed",html:!0},{label:'<span class="text-weight-bold">unknown</span>',value:"unknown",html:!0}]),b=(0,n.KR)(yt),g=(0,n.KR)([...yt]),v=(0,n.KR)(d.state.current_tree_node),f=(0,n.KR)(null),_=(0,n.KR)(e.columns),k=(0,n.KR)(e.selected_items),y=(0,n.KR)({port:1,proto:"tcp",state:"open",name:null,info:""});function h(e,l){return["http","https"]}function C(e,l,t){setTimeout(()=>{l(()=>{if(""===e)b.value=g.value;else{const l=e.toLocaleLowerCase();b.value=g.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},10)}function F(){console.log("delayed filter aborted")}function x(e){y.value.name=e}function A(){const e={Authorization:"Bearer "+d.state.current_user.token};Qe.api.get("/api/get_unic_service",{headers:e}).then(e=>{g.value=e.data.map(function(e){return{value:e.name,label:e.name,image:Te(e.name)}})}).catch(()=>{})}async function w(e,l){let t=new Promise((t,a)=>{setTimeout(()=>{t(!1);const a={Authorization:"Bearer "+d.state.current_user.token};Qe.api.post("/api/edit_services_value",{workspace:e,data:l},{headers:a}).then(e=>{if(200==e.data.rsp_k){var a=JSON.parse(l);a.id=e.data.id,o({row_temp:a}),(0,Ie.e)(r,"positive","Записи отредактированы","","done")}else(0,Ie.e)(r,"negative","Ошибка",e.data.message,"report_problem"),t(!1)}).catch(()=>{(0,Ie.e)(r,"negative","Ошибка","","report_problem"),t(!1)})},1e3)}),a=await t;return a}return(0,a.sV)(()=>{A()}),{dialogRef:l,maximizedToggle:(0,n.KR)(!1),project_name:u,description:c,row:y,options:p,options1:m,options2:b,current_tree_node:v,edit_services_value:w,portRef:f,portRules:[e=>null!=e&&e>=0&&e<=65535&&""!=e||"Введите валидный порт"],onDialogHide:t,search:h,filterFn:C,abortFilterFn:F,setModel:x,unicServices:A,columns:_,selected_items:k,services_name_icon:Te,onOKClick(){var e={id:k.value,data:[]};_.value.forEach(l=>{var t={column:l,value:y.value[l]};e.data.push(t)}),w(d.state.current_project,JSON.stringify(e))},onCancelClick:i}}},Ct=(0,_e.A)(ht,[["render",kt]]),Ft=Ct;we()(ht,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QInput:Me.A,QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A,QCardActions:Fe.A}),we()(ht,"directives",{ClosePopup:al.A});var xt=t(5536),At=t(5322);const wt={class:"fit row wrap justify-center items-start content-start"},St={key:0},Vt={key:1},Qt={key:2},It={key:0,class:"row items-center"},Wt={key:1,class:"text-negative"},Dt={key:2},Rt={key:0};function Ot(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-spinner"),d=(0,a.g2)("q-tooltip");return(0,a.uX)(),(0,a.CE)("div",wt,[void 0!=o.Model&&null!=o.Model&&"undefined"!=typeof o.Model.purpose&&null!=o.Model.purpose?((0,a.uX)(),(0,a.CE)("div",St,[(0,a.bF)(i,{src:o.hosts_purpose_icon(o.Model.purpose),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0),void 0!=o.Model&&null!=o.Model&&"undefined"!=typeof o.Model.os_family&&null!=o.Model.os_family?((0,a.uX)(),(0,a.CE)("div",Vt,[(0,a.bF)(i,{src:o.hosts_osfamily_icon(o.Model.os_family),class:"node_icon"},null,8,["src"])])):(0,a.Q3)("",!0),void 0!=o.Model&&null!=o.Model&&"undefined"!=typeof o.Model.address&&null!=o.Model.address?((0,a.uX)(),(0,a.CE)("div",Qt,(0,b.v_)(o.Model.address),1)):(0,a.Q3)("",!0),(0,a.bF)(d,{onShow:o.loadTooltipData},{default:(0,a.k6)(()=>[o.loading?((0,a.uX)(),(0,a.CE)("div",It,[(0,a.bF)(r,{size:"16px",class:"q-mr-sm"}),l[0]||(l[0]=(0,a.eW)(" Загрузка... ",-1))])):e.error?((0,a.uX)(),(0,a.CE)("div",Wt," Ошибка загрузки ")):((0,a.uX)(),(0,a.CE)("div",Dt,[null!=o.tooltipObject?((0,a.uX)(),(0,a.CE)("div",Rt,[(0,a.Lk)("div",null,[l[1]||(l[1]=(0,a.eW)(" OS Family - ",-1)),(0,a.bF)(i,{src:o.hosts_osfamily_icon(o.tooltipObject.os_family),class:"node_icon"},null,8,["src"]),(0,a.eW)(" "+(0,b.v_)(o.tooltipObject.os_family),1)]),(0,a.Lk)("div",null,[l[2]||(l[2]=(0,a.eW)(" Purpose - ",-1)),(0,a.bF)(i,{src:o.hosts_purpose_icon(o.tooltipObject.purpose),class:"node_icon"},null,8,["src"]),(0,a.eW)(" "+(0,b.v_)(o.tooltipObject.purpose),1)]),(0,a.Lk)("div",null," Info - "+(0,b.v_)(o.tooltipObject.info),1),(0,a.Lk)("div",null," Comment - "+(0,b.v_)(o.tooltipObject.comments),1)])):(0,a.Q3)("",!0)]))]),_:1},8,["onShow"])])}const Tt={name:"TableHostColumn",components:{},props:{model:{type:String,default:null}},setup(e){const l=(0,s.Pj)(),t=(0,n.KR)(e.model),a=(0,n.KR)(""),o=(0,n.KR)(null),r=(0,n.KR)(!1),d=(0,n.KR)(!1),u=(0,n.KR)(!1);async function c(){if(!u.value){r.value=!0,d.value=!1;try{var e=(0,m.y)("table","Hosts","getItem"),a={workspace:l.state.current_project,data:`hosts.id == ${t.value.id}`},n=await(0,i.L)(e,a,null,l.state.current_user.token);null!=n&&(o.value=n[0],u.value=!0)}catch(e){d.value=!0}finally{r.value=!1}}}return{Model:t,tooltipText:a,tooltipObject:o,loading:r,loadTooltipData:c,hosts_purpose_icon:De,hosts_osfamily_icon:Re}}};var qt=t(8210);const Et=(0,_e.A)(Tt,[["render",Ot]]),Xt=Et;we()(Tt,"components",{QImg:Je.A,QTooltip:He.A,QSpinner:qt.A});var Kt=t(1063);const Lt=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"host",align:"center",label:"IP",field:"host",sortable:!0,sort:(e,l,t,a,o)=>d(e,l,o)},{name:"port",align:"center",label:"Порт",field:"port",sortable:!0,sort:(e,l)=>parseInt(e,10)-parseInt(l,10),mditeable:!0},{name:"proto",align:"center",label:"Протокол",field:"proto",sortable:!0,mditeable:!0},{name:"state",align:"center",label:"Состояние",field:"state",sortable:!0,mditeable:!0},{name:"name",align:"center",label:"Служба",field:"name",sortable:!0,mditeable:!0},{name:"info",align:"center",label:"Информация",field:"info",mditeable:!0},{name:"actions",label:"Actions",field:"actions"}],zt=[],Nt={name:"TableServices",components:{DownloadButtonMenu:xt.A,TableComponentsName:At.A,TableHostColumn:Xt,ActionsButtons:Kt.A},setup(){const e=(0,s.Pj)(),l=(0,n.KR)([]),t=(0,pe.A)(),o=(0,n.KR)(!1),d=(0,n.KR)(e.state.user_settings),u=(0,n.KR)([]),c=(0,n.KR)([...zt]),b=(0,n.KR)([...Lt]),g=(0,n.KR)(!1),v=(0,n.KR)(""),f=(0,n.KR)(null);function _(){t.dialog({component:vt,componentProps:{CardAction:"AddItem",CardName:"Add Service",CardData:{host:{id:null,address:"",puprose:"",os_family:""},port:0,proto:"tcp",state:"open",name:"",info:""}}}).onOk(e=>{c.value.push(e)})}function k(e){t.dialog({component:vt,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}function y(){var a=JSON.parse(JSON.stringify(l.value));t.dialog({component:Ft,componentProps:{selected_items:a.map(e=>e.id),columns:u}}).onOk(l=>{l.row_temp.id.forEach(t=>{const a=c.value.findIndex(e=>e.id==t);a>-1&&l.row_temp.data.forEach(e=>{Object.keys(c.value[a]).forEach(l=>{l===e["column"]&&(c.value[a][l]=e["value"])})}),e.commit("SET_EVENT_HOST",{event:"edit_host",data:c.value[a]})})})}async function h(){g.value=!0;var l=(0,m.y)("table","Services","getItem"),a={workspace:e.state.current_project,data:r(e.state.current_tree_node)},o=await(0,i.L)(l,a,null,e.state.current_user.token);void 0!=o&&o||Array.isArray(1==o)?(c.value=o,g.value=!1):(g.value=!1,o.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",o.message,"report_problem"))}async function C(a){var o=(0,m.y)("table","Services","delItem"),n={workspace:e.state.current_project,data:a.id},s=await(0,i.L)(o,n,null,e.state.current_user.token);void 0!=s&&0!=s?(200==s.status&&(c.value=c.value.filter(e=>e.id!==a),l.value=l.value.filter(e=>e.id!=a.id)),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",s.message,"report_problem")}function F(){for(var e=l.value.filter(e=>e.id),t=0;t<e.length;t++)C(e[t])}function x(e){t.dialog({component:vt,componentProps:{CardAction:"EditItem",CardName:"Edit Service",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=c.value.findIndex(l=>l.id==e.id);l>-1&&(c.value[l]=e)}})}function A(e){l.value=e.rows}return(0,a.wB)(()=>e.state.current_tree_node,()=>{h()}),(0,a.wB)(()=>e.state.user_settings,()=>{null!=e.state.user_settings&&(d.value=e.state.user_settings)}),(0,a.sV)(()=>{h()}),{selected:l,columns:Lt,Rows:c,store:e,tableSelectable:o,Columns:b,loading:g,filter:v,q_table:f,selection_edititems:u,user_settings:d,visibleColumns:(0,n.KR)(["host","desc","port","proto","state","name","info","actions"]),loadData:h,AddItem:_,InfoItem:k,deleteItems:F,EditItem:x,DeleteItem:C,services_name_icon:Te,hosts_osfamily_icon:Re,hosts_purpose_icon:De,loadData:h,handleSelectRow:A,customFilter:p,editservicesvalue_show:y,getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${zt.length}`}}}};var Pt=t(6908),Mt=t(4488),Ut=t(7722),jt=t(8975),Bt=t(5262),Jt=t(3954);const Ht=(0,_e.A)(Nt,[["render",bl]]),$t=Ht;we()(Nt,"components",{QTable:ce.A,QBtn:xe.A,QMenu:$e.A,QList:Ge.A,QItem:Ye.A,QItemSection:Ze.A,QToggle:Pt.A,QSeparator:ll.A,QAvatar:nt.A,QIcon:Ue.A,QItemLabel:el.A,QInput:Me.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QImg:Je.A,QBadge:Jt.A}),we()(Nt,"directives",{ClosePopup:al.A});const Gt={key:0},Yt={key:0},Zt={key:1},ea={key:0},la={key:2},ta={key:0},aa={key:3},oa={key:4,align:"right"},na={key:5};function sa(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("DownloadButtonMenu"),d=(0,a.g2)("q-tooltip"),u=(0,a.g2)("q-toggle"),c=(0,a.g2)("q-item-section"),p=(0,a.g2)("q-item"),m=(0,a.g2)("q-separator"),g=(0,a.g2)("q-icon"),v=(0,a.g2)("q-avatar"),f=(0,a.g2)("q-item-label"),_=(0,a.g2)("q-list"),k=(0,a.g2)("q-menu"),y=(0,a.g2)("TableComponentsName"),h=(0,a.g2)("q-input"),C=(0,a.g2)("q-checkbox"),F=(0,a.g2)("q-th"),x=(0,a.g2)("q-tr"),A=(0,a.g2)("q-popup-proxy"),w=(0,a.g2)("q-td"),S=(0,a.g2)("q-img"),V=(0,a.g2)("q-chip"),Q=(0,a.g2)("ActionsButtons"),I=(0,a.g2)("q-table"),W=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(I,{title:"Сетевые узлы",rows:o.Rows,columns:o.columns,"row-key":"id",dense:"",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),selection:"multiple","selected-rows-label":o.getSelectedString,selected:o.selected,"onUpdate:selected":l[6]||(l[6]=e=>o.selected=e),onSelection:o.handleSelectRow,loading:o.loading,filter:o.filter,"virtual-scroll":"","visible-columns":o.visibleColumns},{"top-left":(0,a.k6)(()=>[(0,a.bF)(i,{color:"green",icon:"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:o.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.loadData())}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",icon:"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:e.deleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"indigo-7",icon:"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{table:o.q_table},null,8,["table"])]),_:1}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:1,color:"primary",icon:"sell",label:"Tags","no-caps":"",size:"sm",class:"button-top",onClick:o.tags_show},{default:(0,a.k6)(()=>[0==o.selected.length?((0,a.uX)(),(0,a.Wv)(d,{key:0,anchor:"bottom middle",self:"top middle",offset:[10,10]},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)(" Выберите узлы ",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["onClick"])):(0,a.Q3)("",!0),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:2,color:"green",icon:"edit",label:"Edit Rows","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(k,null,{default:(0,a.k6)(()=>[(0,a.bF)(_,{style:{"min-width":"100px"}},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[void 0!=e.mditeable&&1==e.mditeable?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(p,{key:0,clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(u,{color:"blue",label:e.label,modelValue:o.selection_edithosts,"onUpdate:modelValue":l[1]||(l[1]=e=>o.selection_edithosts=e),"left-label":"",val:e.field},null,8,["label","modelValue","val"])]),_:2},1024)]),_:2},1024)),[[W]]):(0,a.Q3)("",!0)]))),256)),(0,a.bF)(m),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(p,{onClick:l[2]||(l[2]=e=>o.edithostsvalue_show()),clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(c,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(v,{rounded:""},{default:(0,a.k6)(()=>[(0,a.bF)(g,{name:"edit",size:"md"})]),_:1})]),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)(" Edit ",-1)])]),_:1})]),_:1})]),_:1})),[[W]])]),_:1})]),_:1})]),_:1})):(0,a.Q3)("",!0),(0,a.bF)(u,{modelValue:o.tableSelectable,"onUpdate:modelValue":l[3]||(l[3]=e=>o.tableSelectable=e),color:"blue",label:"Select Rows"},null,8,["modelValue"])]),"top-right":(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(y,{name:"hosts",label:"Hosts",icon:{name:"computer",color:"black"}}),(0,a.bF)(h,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[4]||(l[4]=e=>o.filter=e),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(g,{name:"search"})]),_:1},8,["modelValue"])])]),header:(0,a.k6)(e=>[(0,a.bF)(x,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(F,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(C,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(F),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(F,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(A,{"context-menu":""},{default:(0,a.k6)(()=>[l[9]||(l[9]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(u,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[5]||(l[5]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[(0,a.bF)(x,{props:e,class:(0,b.C4)({host_down:"down"==e.row.state})},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(w,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(C,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),1==o.user_settings.display_icon_osfamily?((0,a.uX)(),(0,a.Wv)(w,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(S,{class:"img-os_family",src:o.hosts_osfamily_icon(e.row.os_family)},null,8,["src"]),null!=e.row.virtual_host&&""!=e.row.virtual_host?((0,a.uX)(),(0,a.Wv)(S,{key:0,class:"img-os_family",src:"icons/virtualization/vm.png"})):(0,a.Q3)("",!0)]),_:2},1024)):((0,a.uX)(),(0,a.Wv)(w,{key:2})),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(w,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["purpose"==l.name&&1==o.user_settings.display_icon_purpose?((0,a.uX)(),(0,a.CE)("div",Gt,[null==l.value?((0,a.uX)(),(0,a.CE)("div",Yt)):(0,a.Q3)("",!0),(0,a.bF)(S,{src:o.hosts_purpose_icon(l.value),class:"node_icon"},null,8,["src"]),(0,a.eW)(" "+(0,b.v_)(l.value),1)])):"os_name"==l.name&&1==o.user_settings.display_icon_purpose?((0,a.uX)(),(0,a.CE)("div",Zt,[null==l.value?((0,a.uX)(),(0,a.CE)("div",ea)):(0,a.Q3)("",!0),(0,a.bF)(S,{src:o.hosts_os_name_icon(l.value),class:"node_icon"},null,8,["src"]),(0,a.Lk)("b",null,(0,b.v_)(l.value),1)])):"virtual_host"==l.name&&1==o.user_settings.display_icon_purpose?((0,a.uX)(),(0,a.CE)("div",la,[null==l.value?((0,a.uX)(),(0,a.CE)("div",ta)):(0,a.Q3)("",!0),(0,a.bF)(S,{src:o.hosts_virtualization(l.value),class:"node_icon"},null,8,["src"]),(0,a.Lk)("b",null,(0,b.v_)(l.value),1)])):"tags"==l.name?((0,a.uX)(),(0,a.CE)("div",aa,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.value,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id},[null!=e.id?((0,a.uX)(),(0,a.Wv)(V,{key:e.id,color:"primary","text-color":"white",size:"sm",icon:"sell"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1024)):(0,a.Q3)("",!0)]))),128))])):"actions"==l.name?((0,a.uX)(),(0,a.CE)("div",oa,[(0,a.bF)(Q,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):((0,a.uX)(),(0,a.CE)("div",na,(0,b.v_)(l.value),1))]),_:2},1024))),128))]),_:2},1032,["props","class"])]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const ia={class:"q-pa-md"},ra=["src"],da=["src"],ua=["src"];function ca(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-card-section"),p=(0,a.g2)("q-select"),m=(0,a.g2)("q-img"),g=(0,a.g2)("q-item-section"),v=(0,a.g2)("q-item-label"),f=(0,a.g2)("q-item"),_=(0,a.g2)("q-input"),k=(0,a.g2)("q-card-actions"),y=(0,a.g2)("q-card"),h=(0,a.g2)("q-dialog"),C=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(h,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(y,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[13]||(l[13]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[C]])]),_:1}),(0,a.Lk)("div",ia,[(0,a.bF)(c,null,{default:(0,a.k6)(()=>[...l[16]||(l[16]=[(0,a.Lk)("div",{class:"text-h6"}," Edit Hosts Value ",-1)])]),_:1}),-1!=o.columns.indexOf("state")?((0,a.uX)(),(0,a.Wv)(p,{key:0,filled:"",modelValue:o.row.state,"onUpdate:modelValue":l[2]||(l[2]=e=>o.row.state=e),label:"Text",options:o.options,hint:"Состояние","lazy-rules":""},null,8,["modelValue","options"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("os_family")?((0,a.uX)(),(0,a.Wv)(p,{key:1,filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.row.os_family,"onUpdate:modelValue":l[3]||(l[3]=e=>o.row.os_family=e),options:o.options1,label:"Text",hint:"Семейство ОС","lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(f,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(m,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(v,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(g,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[17]||(l[17]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.hosts_osfamily_icon(o.row.os_family),style:{width:"25px",height:"25px"}},null,8,ra)]),_:1},8,["modelValue","options","onFilter","onInputValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("os_name")?((0,a.uX)(),(0,a.Wv)(p,{key:2,filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.row.os_name,"onUpdate:modelValue":l[4]||(l[4]=e=>o.row.os_name=e),options:o.options2,label:"Text",hint:"Наименование ОС","lazy-rules":"","emit-value":"",onFilter:o.filterFn_nameos,onInputValue:o.setModel__nameos},{option:(0,a.k6)(e=>[(0,a.bF)(f,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(m,{src:e.opt.image,style:{width:"25px",height:"25px"}},null,8,["src"])]),_:2},1024),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(g,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[18]||(l[18]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[null!=o.hosts_os_name_icon(o.row.os_name)?((0,a.uX)(),(0,a.CE)("img",{key:0,src:o.hosts_os_name_icon(o.row.os_name),style:{width:"25px",height:"25px"}},null,8,da)):(0,a.Q3)("",!0)]),_:1},8,["modelValue","options","onFilter","onInputValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("os_flavor")?((0,a.uX)(),(0,a.Wv)(_,{key:3,filled:"",modelValue:o.row.os_flavor,"onUpdate:modelValue":l[5]||(l[5]=e=>o.row.os_flavor=e),label:"Text",hint:"Тип ОС","lazy-rules":""},null,8,["modelValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("os_sp")?((0,a.uX)(),(0,a.Wv)(_,{key:4,filled:"",modelValue:o.row.os_sp,"onUpdate:modelValue":l[6]||(l[6]=e=>o.row.os_sp=e),label:"Text",hint:"ОС SP","lazy-rules":""},null,8,["modelValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("os_lang")?((0,a.uX)(),(0,a.Wv)(_,{key:5,filled:"",modelValue:o.row.os_lang,"onUpdate:modelValue":l[7]||(l[7]=e=>o.row.os_lang=e),label:"Text",hint:"Язык ОС","lazy-rules":""},null,8,["modelValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("arch")?((0,a.uX)(),(0,a.Wv)(_,{key:6,filled:"",modelValue:o.row.arch,"onUpdate:modelValue":l[8]||(l[8]=e=>o.row.arch=e),label:"Text",hint:"Архитектура","lazy-rules":""},null,8,["modelValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("purpose")?((0,a.uX)(),(0,a.Wv)(p,{key:7,filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.row.purpose,"onUpdate:modelValue":l[9]||(l[9]=e=>o.row.purpose=e),label:"Text",options:o.options3,hint:"Тип хоста","lazy-rules":"",onFilter:o.filterFn_purpose,onInputValue:o.setModel__purpose,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(f,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(g,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(m,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(v,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(g,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[19]||(l[19]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.hosts_purpose_icon(o.row.purpose)},null,8,ua)]),_:1},8,["modelValue","options","onFilter","onInputValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("virtual_host")?((0,a.uX)(),(0,a.Wv)(_,{key:8,filled:"",modelValue:o.row.virtual_host,"onUpdate:modelValue":l[10]||(l[10]=e=>o.row.virtual_host=e),label:"Text",hint:"Виртульный хост","lazy-rules":""},null,8,["modelValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("info")?((0,a.uX)(),(0,a.Wv)(_,{key:9,filled:"",modelValue:o.row.info,"onUpdate:modelValue":l[11]||(l[11]=e=>o.row.info=e),label:"Text",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.Q3)("",!0),-1!=o.columns.indexOf("comments")?((0,a.uX)(),(0,a.Wv)(_,{key:10,filled:"",modelValue:o.row.comments,"onUpdate:modelValue":l[12]||(l[12]=e=>o.row.comments=e),label:"Text",hint:"Комментарий","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.Q3)("",!0)]),(0,a.bF)(k,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"primary",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const pa=[],ma={props:{selected_items:Array,columns:Array},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:i}=(0,ge.A)(),r=(0,pe.A)(),d=(0,s.Pj)(),u=(0,n.KR)(null),c=(0,n.KR)(null),p=(0,n.KR)(["alive","down"]),m=(0,n.KR)(Ql),b=(0,n.KR)([]),g=(0,n.KR)(Il),v=(0,n.KR)(e.columns),f=(0,n.KR)(e.selected_items),_=(0,n.KR)({name:"",state:"alive",os_family:Ql[0],os_name:"",os_flavor:"",os_sp:"",os_lang:"",arch:"",purpose:"device",virtual_host:"",info:"",comments:""});function k(e,l,t){l(()=>{const l=e.toLocaleLowerCase();m.value=Ql.filter(e=>e.label.toLocaleLowerCase().indexOf(l)>-1)})}function y(e,l,t){l(()=>{const l=e.toLocaleLowerCase();g.value=Il.filter(e=>e.label.toLocaleLowerCase().indexOf(l)>-1)})}function h(e,l,t){setTimeout(()=>{l(()=>{const l={Authorization:"Bearer "+d.state.current_user.token};Qe.api.get("/api/get_unic_name_os",{params:{os_family:_.value[0].os_family},headers:l}).then(l=>{if(pa.value=l.data.map(function(e){return{value:e.os_name,label:e.os_name,image:Ee(e.os_name)}}),""===e)b.value=pa.value;else{const l=e.toLowerCase();b.value=pa.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}}).catch(()=>{(0,Ie.e)(r,"negative","Ошибка","","report_problem")})})},1500)}function C(){console.log("delayed filter aborted")}function F(e){_.value.os_family=e}function x(e){_.value.os_name=e}function A(e){_.value.purpose=e}async function w(e,l){let t=new Promise((t,a)=>{setTimeout(()=>{t(!1);const a={Authorization:"Bearer "+d.state.current_user.token};Qe.api.post("/api/edit_hosts_value",{workspace:e,data:l},{headers:a}).then(e=>{if(200==e.data.rsp_k){var a=JSON.parse(l);a.id=e.data.id,o({row_temp:a}),(0,Ie.e)(r,"positive","Записи отредактированы","","done")}else(0,Ie.e)(r,"negative","Ошибка",e.data.message,"report_problem"),t(!1)}).catch(e=>{console.log(e),(0,Ie.e)(r,"negative","Ошибка","","report_problem"),t(!1)})},1e3)}),a=await t;return a}return(0,a.sV)(()=>{}),{dialogRef:l,maximizedToggle:(0,n.KR)(!1),project_name:u,description:c,row:_,options:p,options1:m,options2:b,options3:g,columns:v,selected_items:f,onDialogHide:t,filterFn:k,filterFn_nameos:h,filterFn_purpose:y,abortFilterFn:C,setModel:F,setModel__nameos:x,setModel__purpose:A,edit_hosts_value:w,hosts_purpose_icon:De,hosts_osfamily_icon:Re,hosts_os_name_icon:Ee,onOKClick(){var e={id:f.value,data:[]};v.value.forEach(l=>{var t={column:l,value:_.value[l]};e.data.push(t)}),w(d.state.current_project,JSON.stringify(e))},onCancelClick:i}}},ba=(0,_e.A)(ma,[["render",ca]]),ga=ba;we()(ma,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A,QInput:Me.A,QCardActions:Fe.A}),we()(ma,"directives",{ClosePopup:al.A});t(1779),t(3436);const va=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",label:"IP",align:"center",field:"address",sortable:!0},{name:"mac",label:"MAC",align:"center",field:"mac",sortable:!0},{name:"name",label:"DNS/Netbios имя",align:"center",field:"name",sortable:!0},{name:"state",label:"Состояние",align:"center",field:"state",sortable:!0,mditeable:!0},{name:"os_family",label:"Семейство ОС",align:"center",field:"os_family",sortable:!0,mditeable:!0},{name:"os_name",label:"Наименование ОС",align:"center",field:"os_name",sortable:!0,mditeable:!0},{name:"os_flavor",label:"Тип ОС",align:"center",field:"os_flavor",sortable:!0,mditeable:!0},{name:"os_sp",label:"ОС SP",align:"center",field:"os_sp",sortable:!0,mditeable:!0},{name:"os_lang",label:"Язык ОС",align:"center",field:"os_lang",sortable:!0,mditeable:!0},{name:"arch",label:"Архитектура",align:"center",field:"arch",sortable:!0,mditeable:!0},{name:"purpose",label:"Тип хоста",align:"center",field:"purpose",sortable:!0,mditeable:!0},{name:"virtual_host",label:"Виртуализация",align:"center",field:"virtual_host",sortable:!0,mditeable:!0},{name:"tags",label:"Теги",align:"center",field:"tags",sortable:!0},{name:"info",label:"Информация",align:"center",field:"info",sortable:!0,mditeable:!0},{name:"comments",label:"Комментарий",align:"center",field:"comments",sortable:!0,mditeable:!0},{name:"actions",label:"Actions",field:"actions"}],fa=[],_a={name:"TableHost",emits:["add_host","edit_host","del_host"],props:{},components:{DownloadButtonMenu:xt.A,TableComponentsName:At.A,ActionsButtons:Kt.A},setup(e,{emit:l}){const t=(0,s.Pj)(),o=(0,n.KR)([]),d=(0,n.KR)(!1),u=(0,n.KR)([]),c=(0,pe.A)(),p=(0,n.KR)([...fa]),b=(0,n.KR)(t.state.user_settings),g=(0,n.KR)(!1),v=(0,n.KR)(""),f=(0,n.KR)(null);function _(){c.dialog({component:ut,componentProps:{CardAction:"AddItem",CardName:"Add Hosts",CardData:{address:"",mac:"",name:"",state:"alive",os_family:"Windows",os_name:"",os_flavor:"",os_sp:"",os_lang:"",arch:"",purpose:"device",virtual_host:"",tags:[],info:"",comments:""}}}).onOk(e=>{p.value.push(e)})}function k(e){c.dialog({component:ut,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}function y(){var e=JSON.parse(JSON.stringify(o.value));c.dialog({component:it,componentProps:{selected_hosts:e,original_call:"Table"}}).onOk(e=>{})}function h(){var e=JSON.parse(JSON.stringify(o.value));c.dialog({component:ga,componentProps:{selected_items:e.map(e=>e.id),columns:u}}).onOk(e=>{e.row_temp.id.forEach(l=>{const a=p.value.findIndex(e=>e.id==l);a>-1&&e.row_temp.data.forEach(e=>{Object.keys(p.value[a]).forEach(l=>{l===e["column"]&&(p.value[a][l]=e["value"])})}),t.commit("SET_EVENT_HOST",{event:"edit_host",data:p.value[a]})})})}async function C(){g.value=!0;var e=(0,m.y)("table","Hosts","getItem"),l={workspace:t.state.current_project,data:r(t.state.current_tree_node)},a=await(0,i.L)(e,l,null,t.state.current_user.token);void 0!=a&&a||Array.isArray(1==a)?(p.value=a,g.value=!1):(g.value=!1,a.hasOwnProperty("message")&&(0,Ie.e)(c,"negative","Error",a.message,"report_problem"))}async function F(e){var l=(0,m.y)("table","Hosts","delItem"),a={workspace:t.state.current_project,data:e.id},n=await(0,i.L)(l,a,null,t.state.current_user.token);void 0!=n&&0!=n?(200==n.status&&(p.value=p.value.filter(l=>l.id!==e.id),o.value=o.value.filter(l=>l.id!=e.id)),(0,Ie.e)(c,"positive","Запись удалена","","done")):(0,Ie.e)(c,"negative","Error",n.message,"report_problem")}function x(){for(var e=o.value.filter(e=>e.id),l=[],t=0;t<e.length;t++)l.push(e[t].id);F(l)}function A(e){c.dialog({component:ut,componentProps:{CardAction:"EditItem",CardName:"Edit Host",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=p.value.findIndex(l=>l.id==e.id);l>-1&&(p.value[l]=e),t.commit("SET_EVENT_HOST",{event:"edit_host",data:e})}})}function w(e){o.value=e.rows}return(0,a.wB)(()=>t.state.user_settings,()=>{null!=t.state.user_settings&&(b.value=t.state.user_settings)}),(0,a.wB)(()=>t.state.current_tree_node,()=>{C()}),(0,a.wB)(()=>d.value,()=>{0==d.value&&(o.value=[])}),(0,a.sV)(()=>{null==t.state.current_user.token&&t.commit("SET_CURRENT_USER",JSON.parse(localStorage["user"])),C()}),{loading:g,filter:v,q_table:f,selected:o,store:t,columns:va,tableSelectable:d,Rows:p,user_settings:b,selection_edithosts:u,visibleColumns:(0,n.KR)(["address","desc","name","os_family","os_name","purpose","tags","info","comments","actions"]),loadData:C,AddItem:_,EditItem:A,DeleteItem:F,tags_show:y,DeleteItems:x,InfoItem:k,handleSelectRow:w,edithostsvalue_show:h,hosts_osfamily_icon:Re,hosts_purpose_icon:De,hosts_os_name_icon:Ee,hosts_virtualization:Oe,getSelectedString(){return 0===o.value.length?"":`${o.value.length} record${o.value.length>1?"s":""} selected of ${fa.length}`}}}},ka=(0,_e.A)(_a,[["render",sa]]),ya=ka;we()(_a,"components",{QTable:ce.A,QBtn:xe.A,QTooltip:He.A,QMenu:$e.A,QList:Ge.A,QItem:Ye.A,QItemSection:Ze.A,QToggle:Pt.A,QSeparator:ll.A,QAvatar:nt.A,QIcon:Ue.A,QItemLabel:el.A,QInput:Me.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QImg:Je.A,QChip:$l.A}),we()(_a,"directives",{ClosePopup:al.A});const ha={key:0},Ca={key:1},Fa={key:2},xa={key:3,class:"truncate-text"},Aa={key:4,align:"right"},wa={key:5};function Sa(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("DownloadButtonMenu"),d=(0,a.g2)("q-toggle"),u=(0,a.g2)("TableComponentsName"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-input"),m=(0,a.g2)("q-checkbox"),g=(0,a.g2)("q-th"),v=(0,a.g2)("q-tr"),f=(0,a.g2)("q-popup-proxy"),_=(0,a.g2)("q-td"),k=(0,a.g2)("q-img"),y=(0,a.g2)("TableHostColumn"),h=(0,a.g2)("TableServiceColumn"),C=(0,a.g2)("ActionsButtons"),F=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.Wv)(F,{title:"Заметки",rows:o.Rows,columns:o.columns,"row-key":"id",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),selection:"multiple","selected-rows-label":o.getSelectedString,selected:o.selected,"onUpdate:selected":l[4]||(l[4]=e=>o.selected=e),onSelection:o.handleSelectRow,dense:"",loading:o.loading,filter:o.filter,"virtual-scroll":"","visible-columns":o.visibleColumns,"filter-method":o.customFilter},{"top-left":(0,a.k6)(()=>[(0,a.bF)(i,{color:"green",icon:"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:o.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.loadData())}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",icon:"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:o.deleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"indigo-7",icon:"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{table:o.q_table},null,8,["table"])]),_:1}),(0,a.bF)(d,{color:"blue",modelValue:o.tableSelectable,"onUpdate:modelValue":l[1]||(l[1]=e=>o.tableSelectable=e),label:"Select Rows"},null,8,["modelValue"])]),"top-right":(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(u,{name:"notes",label:"Notes",icon:{name:"description",color:"grey-9"}}),(0,a.bF)(p,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[2]||(l[2]=e=>o.filter=e),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(c,{name:"search"})]),_:1},8,["modelValue"])])]),header:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(g,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(g,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(f,{"context-menu":""},{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(d,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[3]||(l[3]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(_,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(_,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["ntype"==l.name?((0,a.uX)(),(0,a.CE)("div",ha,[null!=o.notes_type_icon(l.value)?((0,a.uX)(),(0,a.Wv)(k,{key:0,src:o.notes_type_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,b.v_)(l.value),1)])):"host"==l.name?((0,a.uX)(),(0,a.CE)("div",Ca,[(0,a.bF)(y,{model:l.value},null,8,["model"])])):"service"==l.name?((0,a.uX)(),(0,a.CE)("div",Fa,[(0,a.bF)(h,{model:l.value},null,8,["model"])])):"data"==l.name?((0,a.uX)(),(0,a.CE)("div",xa,(0,b.v_)(l.value),1)):"actions"==l.name?((0,a.uX)(),(0,a.CE)("div",Aa,[(0,a.bF)(C,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):((0,a.uX)(),(0,a.CE)("div",wa,(0,b.v_)(l.value),1))]),_:2},1024))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns","filter-method"])}const Va={class:"q-pa-md"},Qa={class:"text-h6"};function Ia(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-label"),v=(0,a.g2)("q-img"),f=(0,a.g2)("JsonEditorVue"),_=(0,a.g2)("SelectWithIPFilter"),k=(0,a.g2)("SelectWithServicesFilter"),y=(0,a.g2)("SelectWithFilter"),h=(0,a.g2)("q-input"),C=(0,a.g2)("q-card-actions"),F=(0,a.g2)("q-card"),x=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(x,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(F,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[A]])]),_:1}),(0,a.Lk)("div",Va,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1}),(0,a.Lk)("div",Qa,(0,b.v_)(o.CardName),1)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.host.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.services_name_icon(o.CardData.service.name),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("Служба:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.service.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.notes_type_icon(o.CardData.ntype),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[12]||(l[12]=[(0,a.eW)("Note Type:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.ntype),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[13]||(l[13]=[(0,a.eW)("Данные:",-1)])]),_:1}),(0,a.bF)(f,{modelValue:o.Data,"onUpdate:modelValue":l[2]||(l[2]=e=>o.Data=e),"read-only":!0,"main-menu-bar":!1,"navigation-bar":!1},null,8,["modelValue"])])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(_,{modelValue:o.CardData.host,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.host=e),ref:"ipRef",rules:o.ipRules,selectOptions:o.SelectOptionsName,label:"IP-адрес",hint:"Text"},null,8,["modelValue","rules","selectOptions"]),(0,a.bF)(k,{modelValue:o.CardData.service,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.service=e),affectValue:o.CardData.host,label:"Служба",hint:"Text",isMultiple:o.isMultiple},null,8,["modelValue","affectValue","isMultiple"]),(0,a.bF)(y,{modelValue:o.CardData.ntype,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.ntype=e),selectOptions:o.SelectOptionsName,ImageFunction:o.notes_type_icon,label:"Notes Type",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),(0,a.bF)(h,{filled:"",modelValue:o.CardData.data,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.data=e),label:"Данные",hint:o.TypeData,"lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue","hint"])]),_:1}))]),(0,a.bF)(C,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Wa=["src"];function Da(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.ImageFunction(o.Model),style:{width:"25px",height:"25px"}},null,8,Wa)]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const Ra={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),r=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),d=(0,n.KR)(e.ImageFunction),u=(0,n.KR)(e.label),c=(0,n.KR)(e.hint),p=(0,s.Pj)();async function b(e,l,t){setTimeout(()=>{l(()=>{if(""===e)r.value=o.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();r.value=o.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},1500)}function g(e){t.value=e}async function v(){var e=(0,m.y)("table","Notes","getUnicName"),l=await(0,i.b)(e,null,p.state.current_user.token);void 0!=l&&0!=l&&(o.value=l.map(function(e){var l="";return null!=e.ntype&&(l=e.ntype),{value:l,label:l,image:d.value(l)}}))}return(0,a.KC)(()=>{v()}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:r,ImageFunction:d,filterFn:b,Label:u,Hint:c,setModel:g}}},Oa=(0,_e.A)(Ra,[["render",Da]]),Ta=Oa;function qa(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-avatar"),p=(0,a.g2)("q-chip"),m=(0,a.g2)("q-btn"),g=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(g,{filled:"","use-chips":"","stack-label":"",modelValue:o.Model,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Model=e),options:o.Options,label:o.Label,"option-label":"label",hint:o.Hint,"onUpdate:value":o.onUpdateValue,multiple:o.isMultiple},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[void 0!=e.opt.image&&null!=e.opt.image?((0,a.uX)(),(0,a.Wv)(r,{key:0,avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.port)+"/"+(0,b.v_)(e.opt.proto)+" ("+(0,b.v_)(e.opt.name)+")",1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"selected-item":(0,a.k6)(e=>[(0,a.bF)(p,{removable:"",dense:"",onRemove:l=>e.removeAtIndex(e.index),tabindex:e.tabindex,color:"white","text-color":"primary",class:"q-ma-none"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{color:"primary","text-color":"white"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.eW)(" "+(0,b.v_)(e.opt.port)+"/"+(0,b.v_)(e.opt.proto)+" ("+(0,b.v_)(e.opt.name)+") ",1)]),_:2},1032,["onRemove","tabindex"])]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[2]||(l[2]=[(0,a.eW)(" No results ",-1)])]),_:1}),(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{color:"green",icon:"add","no-caps":"",size:"sm",class:"button-top",label:"Add Service",onClick:l[0]||(l[0]=e=>o.AddNewService())})]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","hint","onUpdate:value","multiple"])}we()(Ra,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const Ea={props:{modelValue:{type:Object,default:null},label:{type:String,default:""},hint:{type:String,default:""},affectValue:{type:Object,default:null},isMultiple:{type:Boolean,default:!1}},components:{AddEditItem:vt},emits:[],setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(e.modelValue),r=(0,n.KR)([]),d=(0,n.KR)(e.label),u=(0,n.KR)(e.hint),c=(0,s.Pj)(),p=(0,n.KR)(!0),b=(0,n.KR)(e.affectValue),g=(0,n.KR)(e.isMultiple);function v(e){o.value=e,l("e_model",newValue)}async function f(){var e="";if("object"==typeof b.value?null!=b.value&&null!=b.value.address&&""!=b.value.address&&1==_(b.value)&&(e=`hosts.address == "${b.value.address}"`):"string"==typeof b.value&&null!=b.value&&""!=b.value&&1==_(b.value)&&(e=`hosts.address == "${b.value}"`),""!=e){var l=(0,m.y)("table","Services","getItem"),t={workspace:c.state.current_project,data:e},a=await(0,i.L)(l,t,null,c.state.current_user.token);void 0!=a&&0!=a&&(r.value=a.map(function(e){return e.image=Te(e.name),e.value=e.id,e.label=`${e.port}/${e.proto} (${e.name})`,e}))}}function _(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}function k(){var e=o.value;"object"==typeof e&&(e=""),t.dialog({component:vt,componentProps:{CardAction:"AddItem",CardName:"Add Hosts",CardData:{host:b.value,port:0,proto:"tcp",state:"open",name:"",info:""}}}).onOk(e=>{o.value=e,r.value.push(e),f()})}return(0,a.KC)(()=>{Array.isArray(o.value)?g.value=!0:null!=o.value&&0==o.value.hasOwnProperty("image")&&(o.value.image=Te(o.value.name)),f()}),(0,a.nT)(()=>{b.value=e.affectValue}),(0,a.wB)(o,e=>{l("e_model",e)}),(0,a.wB)(()=>e.modelValue,e=>{o.value=e}),(0,a.wB)(()=>b.value,e=>{b.value=e,r.value=[],1==_(b.value)&&f(),o.value=1==g?[]:null}),{Model:o,Options:r,Label:d,Hint:u,FlagInit:p,AffectValue:b,isMultiple:g,AddNewService:k,onUpdateValue:v,services_name_icon:Te}}},Xa=(0,_e.A)(Ea,[["render",qa]]),Ka=Xa;we()(Ea,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A,QChip:$l.A,QAvatar:nt.A,QBtn:xe.A});var La=t(610),za=t(5735);const Na={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithFilter:Ta,SelectWithIPFilter:mt,SelectWithServicesFilter:Ka,JsonEditorVue:La.A},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)("Text"),b=(0,n.KR)(!0),g=(0,n.KR)(null),v=(0,n.KR)(e.CardAction),f=(0,n.KR)(e.CardName),_=(0,n.KR)(e.CardData);function k(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}async function y(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,u.state.current_user.token);if(void 0!=l&&0!=l&&200==l.status){l.data.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l}})}}async function h(e){var l=(0,m.y)("table","Notes","editItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(1==_.value.status&&(_.value.id=a.id,_.value.host=a.host,_.value.updated_at=a.updated_at),o(_.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function C(e){var l=(0,m.y)("table","Notes","addItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);if(void 0!=a&&0!=a)if(200==a.status){if(Array.isArray(a.note)){var n=[];a.note.forEach(e=>{var l=JSON.parse(JSON.stringify(_.value));l.id=e.id,l.service=_.value.service.filter(l=>l.id==e.service_id).shift(),l.created_at=e.created_at,l.updated_at=e.updated_at,n.push(l)}),o(n)}else _.value.id=a.note.id,_.value.service=a.note.service,_.value.host=a.note.host,_.value.created_at=a.note.created_at,_.value.updated_at=a.note.updated_at,o(_.value);(0,Ie.e)(d,"positive","Запись добавлена","","done")}else(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem")}function F(){d.dialog({component:Tags,componentProps:{selected_hosts:_.value,original_call:"Add"}}).onOk(e=>{_.value.tags=e.row.value.tags})}function x(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}return(0,a.KC)(()=>{try{"object"==typeof _.value.data&&(p.value="JSON",_.value.data=JSON.stringify(JSON.parse(JSON.stringify(_.value.data)),null,2))}catch(e){p.value="Text"}"EditItem"==v.value&&(b.value=!1),"InfoItem"==v.value&&("JSON"==k(_.value.data)?g.value=JSON.parse(_.value.data):g.value=_.value.data),c.value=y()}),(0,a.wB)(()=>_.value.data,()=>{p.value=k(_.value.data)}),{dialogRef:l,SelectOptionsName:c,TypeData:p,isMultiple:b,CardAction:v,CardName:f,CardData:_,Data:g,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==x(e)||"Not valid IP-address"],Add:C,Edit:h,showTagDialog:F,onOKClick(){let e=JSON.parse(JSON.stringify(_.value));try{e.data=We.o4.fromUint8Array((0,za.Bh)(JSON.parse(e.data)).buffer,!0)}catch{e.data=We.o4.encode(e.data,!0)}"AddItem"==v.value?C(JSON.stringify(e)):"EditItem"==v.value?h(JSON.stringify(e)):o(null)},onCancelClick:r,services_name_icon:Te,notes_type_icon:Xe}}},Pa=(0,_e.A)(Na,[["render",Ia]]),Ma=Pa;we()(Na,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QImg:Je.A,QInput:Me.A,QCardActions:Fe.A}),we()(Na,"directives",{ClosePopup:al.A});const Ua={class:"fit row wrap justify-center items-start content-start"},ja={key:0};function Ba(e,l,t,o,n,s){const i=(0,a.g2)("q-img");return(0,a.uX)(),(0,a.CE)("div",Ua,[void 0!=o.Model&&null!=o.Model&&"undefined"!=typeof o.Model.port&&null!=o.Model.port?((0,a.uX)(),(0,a.CE)("div",ja,[(0,a.bF)(i,{src:o.services_name_icon(o.Model.name),class:"node_icon"},null,8,["src"]),(0,a.eW)(" "+(0,b.v_)(o.Model.port)+"/"+(0,b.v_)(o.Model.proto)+" ("+(0,b.v_)(o.Model.name)+") ",1)])):(0,a.Q3)("",!0)])}const Ja={name:"TableServiceColumn",components:{},props:{model:{type:String,default:null}},setup(e){const l=(0,n.KR)(e.model);return{Model:l,services_name_icon:Te}}},Ha=(0,_e.A)(Ja,[["render",Ba]]),$a=Ha;we()(Ja,"components",{QImg:Je.A});const Ga=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"host",align:"center",label:"IP",field:"host",sortable:!0,sort:(e,l,t,a,o)=>d(e,l,o)},{name:"service",align:"center",label:"Служба",field:"service",sortable:!0,sort:(e,l,t,a,o)=>u(e,l,o)},{name:"ntype",label:"Тип",align:"center",field:"ntype",sortable:!0},{name:"data",label:"Данные",align:"center",field:"data"},{name:"actions",label:"Actions",field:"actions"}],Ya=[],Za={name:"TableNotes",components:{DownloadButtonMenu:xt.A,TableComponentsName:At.A,TableHostColumn:Xt,TableServiceColumn:$a,ActionsButtons:Kt.A},setup(){const e=(0,s.Pj)(),l=(0,n.KR)([]),t=(0,pe.A)(),o=(0,n.KR)(!1),d=(0,n.KR)([...Ya]),u=(0,n.KR)(e.state.user_settings),c=(0,n.KR)(!1),b=(0,n.KR)(""),g=(0,n.KR)(null);function v(){t.dialog({component:Ma,componentProps:{CardAction:"AddItem",CardName:"Add Note",CardData:{host:{id:null,address:"",puprose:"",os_family:""},service:[],ntype:"",data:""}}}).onOk(e=>{Array.isArray(e)?e.forEach(e=>{d.value.push(e)}):d.value.push(e)})}function f(e){t.dialog({component:Ma,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}async function _(){c.value=!0;var l=(0,m.y)("table","Notes","getItem"),a={workspace:e.state.current_project,data:r(e.state.current_tree_node)},o=await(0,i.L)(l,a,null,e.state.current_user.token);void 0!=o&&o||Array.isArray(1==o)?(d.value=o,d.value.forEach(e=>{try{e.data=(0,za.Hh)(We.o4.toUint8Array(e.data).buffer,{hashToJS:!0})}catch(l){e.data=We.o4.decode(e.data)}}),c.value=!1):(c.value=!1,o.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",o.message,"report_problem"))}async function k(a){var o=(0,m.y)("table","Notes","delItem"),n={workspace:e.state.current_project,data:a.id},s=await(0,i.L)(o,n,null,e.state.current_user.token);void 0!=s&&0!=s?(200==s.status&&(d.value=d.value.filter(e=>e.id!==a.id),l.value=l.value.filter(e=>e.id!=a.id)),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",s.message,"report_problem")}function y(){for(var e=l.value.filter(e=>e.id),t=0;t<e.length;t++)k(e[t])}function h(e){t.dialog({component:Ma,componentProps:{CardAction:"EditItem",CardName:"Edit Note",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=d.value.findIndex(l=>l.id==e.id);l>-1&&(d.value[l]=e)}})}function C(e){l.value=e.rows}return(0,a.wB)(()=>e.state.current_tree_node,()=>{_()}),(0,a.wB)(()=>e.state.user_settings,()=>{null!=e.state.user_settings&&(u.value=e.state.user_settings)}),(0,a.sV)(()=>{_()}),{selected:l,columns:Ga,Rows:d,store:e,loading:c,filter:b,q_table:g,tableSelectable:o,user_settings:u,visibleColumns:(0,n.KR)(["host","service","ntype","data","actions"]),loadData:_,AddItem:v,InfoItem:f,EditItem:h,DeleteItem:k,deleteItems:y,services_name_icon:Te,notes_type_icon:Xe,hosts_purpose_icon:De,hosts_osfamily_icon:Re,handleSelectRow:C,customFilter:p,getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${Ya.length}`}}}},eo=(0,_e.A)(Za,[["render",Sa]]),lo=eo;we()(Za,"components",{QTable:ce.A,QBtn:xe.A,QToggle:Pt.A,QInput:Me.A,QIcon:Ue.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QImg:Je.A});const to={key:0},ao={key:3},oo={key:1},no={key:2},so={key:3},io={key:0,class:"fit row wrap justify-center items-start content-start"},ro={key:1,class:"fit row wrap justify-center items-start content-start"},uo={key:0},co={key:2,class:"fit row wrap justify-center items-start content-start"},po={key:0},mo={key:3,class:"fit row wrap justify-center items-start content-start"},bo={key:0},go={key:4,class:"fit row wrap justify-center items-start content-start"},vo={key:4,align:"right"},fo={key:5,class:"truncate-text"},_o={key:6,class:"truncate-text"},ko={key:0},yo={key:7};function ho(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("DownloadButtonMenu"),d=(0,a.g2)("q-toggle"),u=(0,a.g2)("TableComponentsName"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-input"),m=(0,a.g2)("q-checkbox"),g=(0,a.g2)("q-th"),v=(0,a.g2)("q-tr"),f=(0,a.g2)("q-popup-proxy"),_=(0,a.g2)("q-td"),k=(0,a.g2)("q-badge"),y=(0,a.g2)("TableHostColumn"),h=(0,a.g2)("TableServiceColumn"),C=(0,a.g2)("q-img"),F=(0,a.g2)("q-item-section"),x=(0,a.g2)("q-item-label"),A=(0,a.g2)("q-item"),w=(0,a.g2)("q-avatar"),S=(0,a.g2)("ActionsButtons"),V=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.Wv)(V,{title:"Учетные данные",rows:o.Rows,columns:o.columns,"row-key":"id",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),selection:"multiple","selected-rows-label":o.getSelectedString,selected:o.selected,"onUpdate:selected":l[4]||(l[4]=e=>o.selected=e),onSelection:o.handleSelectRow,dense:"",loading:o.loading,filter:o.filter,"virtual-scroll":"","visible-columns":o.visibleColumns},{"top-left":(0,a.k6)(()=>[(0,a.bF)(i,{color:"green",icon:"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:o.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.loadData())}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",icon:"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:o.deleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"indigo-7",icon:"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{table:o.q_table},null,8,["table"])]),_:1}),(0,a.bF)(d,{color:"blue",modelValue:o.tableSelectable,"onUpdate:modelValue":l[1]||(l[1]=e=>o.tableSelectable=e),label:"Select Rows"},null,8,["modelValue"])]),"top-right":(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(u,{name:"creds",label:"Creds",icon:{name:"key",color:"black"}}),(0,a.bF)(p,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[2]||(l[2]=e=>o.filter=e),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(c,{name:"search"})]),_:1},8,["modelValue"])])]),header:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(g,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(g,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(f,{"context-menu":""},{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(d,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[3]||(l[3]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(_,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),t=>((0,a.uX)(),(0,a.Wv)(_,{key:t.name,align:"center"},{default:(0,a.k6)(()=>["access_level"==t.name?((0,a.uX)(),(0,a.CE)("div",to,["access_level"!=t.name||"Administrator"!=t.value&&"Admin"!=t.value?"access_level"==t.name&&"User"==t.value?((0,a.uX)(),(0,a.Wv)(k,{key:1,color:"blue"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value),1)]),_:2},1024)):"access_level"==t.name&&""!=t.value&&null!=t.value?((0,a.uX)(),(0,a.Wv)(k,{key:2,color:"grey"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value),1)]),_:2},1024)):((0,a.uX)(),(0,a.CE)("div",ao,(0,b.v_)(t.value),1)):((0,a.uX)(),(0,a.Wv)(k,{key:0,color:"green"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value),1)]),_:2},1024))])):"host"==t.name?((0,a.uX)(),(0,a.CE)("div",oo,[(0,a.bF)(y,{model:t.value},null,8,["model"])])):"service"==t.name?((0,a.uX)(),(0,a.CE)("div",no,[(0,a.bF)(h,{model:t.value},null,8,["model"])])):"origin"==t.name?((0,a.uX)(),(0,a.CE)("div",so,["service"==o.getOriginType(t.value)?((0,a.uX)(),(0,a.CE)("div",io,[void 0!=t.value&&null!=t.value?((0,a.uX)(),(0,a.Wv)(A,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(F,{side:"",style:{"padding-right":"0px"}},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(C,{src:o.hosts_purpose_icon(t.value.purpose),class:"node_icon"},null,8,["src"]),(0,a.bF)(C,{src:o.hosts_osfamily_icon(t.value.os_family),class:"node_icon"},null,8,["src"])]),(0,a.bF)(k,{floating:"",color:"teal"},{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Service",-1)])]),_:1})]),_:2},1024),(0,a.bF)(F,null,{default:(0,a.k6)(()=>[(0,a.bF)(x,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value.address),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,a.Q3)("",!0)])):"manual"==o.getOriginType(t.value)?((0,a.uX)(),(0,a.CE)("div",ro,[void 0!=t.value&&null!=t.value&&"undefined"!=typeof t.value.username&&null!=t.value.username?((0,a.uX)(),(0,a.CE)("div",uo,[void 0!=t.value&&null!=t.value?((0,a.uX)(),(0,a.Wv)(A,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(F,{side:""},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(w,{icon:"account_circle"})]),(0,a.bF)(k,{floating:"",color:"deep-orange"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Manual",-1)])]),_:1})]),_:1}),(0,a.bF)(F,null,{default:(0,a.k6)(()=>[(0,a.bF)(x,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value.username),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])):"import"==o.getOriginType(t.value)?((0,a.uX)(),(0,a.CE)("div",co,[void 0!=t.value&&null!=t.value&&"undefined"!=typeof t.value.filename&&null!=t.value.filename?((0,a.uX)(),(0,a.CE)("div",po,[void 0!=t.value&&null!=t.value?((0,a.uX)(),(0,a.Wv)(A,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(F,{side:""},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(w,{icon:"file_open"})]),(0,a.bF)(k,{floating:"",color:"red"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Import",-1)])]),_:1})]),_:1}),(0,a.bF)(F,null,{default:(0,a.k6)(()=>[(0,a.bF)(x,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value.filename),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])):"crackedpassword"==o.getOriginType(t.value)?((0,a.uX)(),(0,a.CE)("div",mo,[void 0!=t.value&&null!=t.value?((0,a.uX)(),(0,a.CE)("div",bo,[void 0!=t.value&&null!=t.value?((0,a.uX)(),(0,a.Wv)(A,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(F,{side:""},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(w,{icon:"key_off"})]),(0,a.bF)(k,{floating:"",color:"blue"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("CrackedPassword",-1)])]),_:1})]),_:1}),(0,a.bF)(F,null,{default:(0,a.k6)(()=>[(0,a.bF)(x,null,{default:(0,a.k6)(()=>[(0,a.eW)("Reference ID: "+(0,b.v_)(t.value.core_id),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])):"session"==o.getOriginType(t.value)?((0,a.uX)(),(0,a.CE)("div",go,[void 0!=t.value&&null!=t.value?((0,a.uX)(),(0,a.Wv)(A,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(F,{side:""},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(C,{src:o.hosts_purpose_icon(t.value.purpose),class:"node_icon"},null,8,["src"]),(0,a.bF)(C,{src:o.hosts_osfamily_icon(t.value.os_family),class:"node_icon"},null,8,["src"])]),(0,a.bF)(k,{floating:"",color:"primary"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Session",-1)])]),_:1})]),_:2},1024),(0,a.bF)(F,null,{default:(0,a.k6)(()=>[(0,a.bF)(x,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value.address),1)]),_:2},1024),(0,a.bF)(x,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(t.value.post_reference_name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])):"actions"==t.name?((0,a.uX)(),(0,a.CE)("div",vo,[(0,a.bF)(S,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):"password"==t.name?((0,a.uX)(),(0,a.CE)("div",fo,(0,b.v_)(t.value),1)):"comment"==t.name?((0,a.uX)(),(0,a.CE)("div",_o,[null!=t.value?((0,a.uX)(),(0,a.CE)("div",ko,(0,b.v_)(t.value),1)):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",yo,(0,b.v_)(t.value),1))]),_:2},1024))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const Co={class:"q-pa-md"},Fo={class:"text-h6"},xo={key:0};function Ao(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-radio"),v=(0,a.g2)("q-label"),f=(0,a.g2)("q-img"),_=(0,a.g2)("SelectWithIPFilter"),k=(0,a.g2)("SelectWithServicesFilter"),y=(0,a.g2)("q-input"),h=(0,a.g2)("SelectComponent"),C=(0,a.g2)("q-card-actions"),F=(0,a.g2)("q-card"),x=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(x,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(F,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[17]||(l[17]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[18]||(l[18]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[19]||(l[19]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[A]])]),_:1}),(0,a.Lk)("div",Co,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"key"})]),_:1}),(0,a.Lk)("div",Fo,(0,b.v_)(o.CardName),1)]),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)(()=>["AddItem"==o.CardAction?((0,a.uX)(),(0,a.CE)("div",xo,[(0,a.bF)(g,{modelValue:o.CardData.CredType,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.CredType=e),val:"::Service",label:"Service",color:"teal"},null,8,["modelValue"]),(0,a.bF)(g,{modelValue:o.CardData.CredType,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.CredType=e),val:"::Manual",label:"Manual",color:"deep-orange"},null,8,["modelValue"])])):(0,a.Q3)("",!0)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[20]||(l[20]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.host.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(f,{src:o.services_name_icon(o.CardData.service.name),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[21]||(l[21]=[(0,a.eW)("Служба:",-1)])]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.service.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[22]||(l[22]=[(0,a.eW)("Логин:",-1)])]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.username),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(f,{src:o.password_type_icon(o.CardData.type),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.type)+":",1)]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.password),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[(0,a.eW)("Домен ("+(0,b.v_)(o.CardData.realm_type)+"):",1)]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.realm),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"admin_panel_settings",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[23]||(l[23]=[(0,a.eW)("Уровень доступа:",-1)])]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.access_level),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(v,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[24]||(l[24]=[(0,a.eW)("Комментарий:",-1)])]),_:1}),(0,a.bF)(v,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.comment),1)]),_:1})])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>["::Service"==o.CardData.CredType?((0,a.uX)(),(0,a.Wv)(_,{key:0,modelValue:o.CardData.host,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.host=e),ref:"ipRef",rules:o.ipRules,selectOptions:o.SelectOptionsName,label:"IP-адрес",hint:"Text"},null,8,["modelValue","rules","selectOptions"])):(0,a.Q3)("",!0),"::Service"==o.CardData.CredType?((0,a.uX)(),(0,a.Wv)(k,{key:1,modelValue:o.CardData.service,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.service=e),affectValue:o.CardData.host,label:"Служба",hint:"Text",onE_model:l[6]||(l[6]=e=>o.updateService(e)),isMultiple:o.isMultiple},null,8,["modelValue","affectValue","isMultiple"])):(0,a.Q3)("",!0),(0,a.bF)(y,{filled:"",modelValue:o.CardData.username,"onUpdate:modelValue":l[7]||(l[7]=e=>o.CardData.username=e),label:"Логин",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"account_box"})]),_:1},8,["modelValue"]),(0,a.bF)(y,{filled:"",modelValue:o.CardData.password,"onUpdate:modelValue":l[8]||(l[8]=e=>o.CardData.password=e),label:"Пароль/Hash/SSH-key",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"key"})]),_:1},8,["modelValue"]),(0,a.bF)(y,{filled:"",modelValue:o.CardData.realm,label:"Домен",hint:"Text","lazy-rules":"","onUpdate:modelValue":o.updateRealmType},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"domain"})]),_:1},8,["modelValue","onUpdate:modelValue"]),null!=o.CardData.realm&&""!=o.CardData.realm?((0,a.uX)(),(0,a.Wv)(h,{key:2,modelValue:o.CardData.realm_type,"onUpdate:modelValue":l[9]||(l[9]=e=>o.CardData.realm_type=e),selectOptions:o.SelectRealmOptions,onE_model:l[10]||(l[10]=e=>o.CardData.realm_type=e),label:"Тип домена",hint:"Text"},null,8,["modelValue","selectOptions"])):(0,a.Q3)("",!0),null!=o.CardData.service&&"::Service"==o.CardData.CredType?((0,a.uX)(),(0,a.Wv)(h,{key:3,modelValue:o.CardData.access_level,"onUpdate:modelValue":l[11]||(l[11]=e=>o.CardData.access_level=e),selectOptions:o.AccessLevelSelectOptions,onE_model:l[12]||(l[12]=e=>o.CardData.access_level=e),label:"Уровень доступа",hint:"Text"},null,8,["modelValue","selectOptions"])):(0,a.Q3)("",!0),(0,a.bF)(h,{modelValue:o.CardData.type,"onUpdate:modelValue":l[13]||(l[13]=e=>o.CardData.type=e),selectOptions:o.TypePasswordSelectOptions,ImageFunction:o.password_type_icon(),onE_model:l[14]||(l[14]=e=>o.updateJTRFormat(e)),label:"Тип пароля",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),"Metasploit::Credential::Password"!=o.CardData.type&&"Metasploit::Credential::SSHKey"!=o.CardData.type?((0,a.uX)(),(0,a.Wv)(h,{key:4,modelValue:o.CardData.jtr_format,"onUpdate:modelValue":l[15]||(l[15]=e=>o.CardData.jtr_format=e),selectOptions:o.JTRFormatSelectOption,isMultiple:!0,label:"John The Ripper формат",hint:"Text"},null,8,["modelValue","selectOptions"])):(0,a.Q3)("",!0),(0,a.bF)(y,{filled:"",modelValue:o.CardData.comment,"onUpdate:modelValue":l[16]||(l[16]=e=>o.CardData.comment=e),label:"Комментарий",hint:"Text","lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue"])]),_:1}))]),(0,a.bF)(C,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const wo={key:0},So={key:1};function Vo(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",multiple:o.isMultiple,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>["object"==typeof e.opt?((0,a.uX)(),(0,a.CE)("div",wo,[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)])):((0,a.uX)(),(0,a.CE)("div",So,[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt),1)]),_:2},1024)]))]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","hint","multiple"])}const Qo={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""},isMultiple:{type:Boolean,default:!1}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),s=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),i=(0,n.KR)(e.ImageFunction),r=(0,n.KR)(e.label),d=(0,n.KR)(e.hint),u=(0,n.KR)(e.isMultiple);function c(e){t.value=e}return(0,a.KC)(()=>{}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("e_model",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:s,ImageFunction:i,Label:r,Hint:d,isMultiple:u,setModel:c}}},Io=(0,_e.A)(Qo,[["render",Vo]]),Wo=Io;we()(Qo,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const Do={key:0},Ro={key:1},Oo=["src"];function To(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},(0,a.eX)({option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>["object"==typeof e.opt?((0,a.uX)(),(0,a.CE)("div",Do,[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)])):((0,a.uX)(),(0,a.CE)("div",Ro,[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt),1)]),_:2},1024)]))]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),_:2},[null!=o.ImageFunction?{name:"prepend",fn:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.ImageFunction(o.Model),style:{width:"25px",height:"25px"}},null,8,Oo)]),key:"0"}:void 0]),1032,["modelValue","options","label","hint","onFilter","onInputValue"])}const qo={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},filterFn:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),s=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),i=(0,n.KR)(e.ImageFunction),r=(0,n.KR)(e.filterFn),d=(0,n.KR)(e.label),u=(0,n.KR)(e.hint);function c(e){t.value=e}return"function"!==typeof r.value&&(r.value=(e,l,t)=>{l(()=>{const l=e.toLocaleLowerCase();s.value=o.value.filter(e=>e.label.toLocaleLowerCase().indexOf(l)>-1)})}),(0,a.KC)(()=>{}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:s,ImageFunction:i,filterFn:r,Label:d,Hint:u,setModel:c}}},Eo=(0,_e.A)(qo,[["render",To]]),Xo=Eo;we()(qo,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const Ko=[{label:"",value:null,description:"Not Grants",image:"icons/unknown.png"},{label:"Administrator",value:"Administrator",description:"Administrator Grants"},{label:"User",value:"User",description:"User Grants"},{label:"Read/Write",value:"Read/Write",description:"Read/Write Grants"},{label:"Read-only",value:"Read-only",description:"Read-only Grants"},{label:"Interactive",value:"interactive",description:"interactive Grants"}],Lo=[{label:"Password",value:"Metasploit::Credential::Password",description:"Clear Text Password",image:"icons/password.png"},{label:"NTLM",value:"Metasploit::Credential::NTLMHash",description:"NTLM-hash",image:"icons/os/windows.png"},{label:"Other Hash type",value:"Metasploit::Credential::NonreplayableHash",description:"Other hash types",image:"icons/md5.png"},{label:"SSH key",value:"Metasploit::Credential::SSHKey",description:"Private SSH keys",image:"icons/services/ssh.png"}],zo=[{label:"Active Directory Domain",value:"Active Directory Domain",description:"Domain Active Directory",image:"icons/os/windows.png"},{label:"PostgreSQL Database",value:"PostgreSQL Database",description:"PostgreSQL DB",image:"icons/services/postgresql.png"},{label:"Oracle System Identifier",value:"Oracle System Identifier",description:"Oracle (SID)",image:"icons/services/oracle.png"},{label:"DB2 Database",value:"DB2 Database",description:"DB2 DB",image:"icons/services/db2.png"},{label:"",value:null,description:"No Domain/Realm",image:"icons/unknown.png"}],No=["7z","adxcrypt","AFS","agilekeychain","aix-ssha1","aix-ssha256","andOTP","AndroidBackup","ansible","argon2","as400-des","as400-ssha1","asa-md5","AzureAD","bcrypt","BestCrypt","BestCryptVE4","bfegg","Bitcoin","BitLocker","Bitwarden","BKS","Blackberry-ES10","Blockchain","bsdicrypt","chap","Citrix_NS10","cloudkeychain","cq","CRC32","crypt","cryptoSafe","dahua","dashlane","diskcryptor","Django","dmd5","dmg","dominosec","dominosec8","DPAPImk","dragonfly3-32","dragonfly4-32","dragonfly4-64","Drupal7","dynamic_n","eCryptfs","eigrp","EncFS","enpass","EPI","EPiServer","ethereum","fde","FormSpring","Fortigate256","FVDE","geli","gost","gpg","has-160","HAVAL-128-4","HAVAL-256-3","hdaa","HMAC-SHA1","HMAC-SHA224","HMAC-SHA256","HMAC-SHA384","HMAC-SHA512","hsrp","IKE","ipb2","itunes-backup","iwork","KeePass","keychain","keystore","known_hosts","krb4","krb5","krb5-18","krb5-3","krb5asrep","krb5pa-md5","krb5pa-sha1","krb5tgs","kwallet","LastPass","leet","lm","lotus5","lotus85","lp","lpcli","LUKS","md5crypt","md5crypt-long","md5ns","mdc2","MediaWiki","monero","money","MongoDB","Mozilla","mscash","MSCHAPv2","mschapv2-naive","mssql","mssql05","mssql12","mysql","mysqlna","mysql-sha1","net-ah","nethalflm","netlm","netlmv2","netntlm","netntlm-naive","netntlmv2","net-sha1","nk","notes","nt","o10glogon","o3logon","o5logon","ODF","Office","oldoffice","openssl-enc","OpenVMS","oracle","oracle11","Oracle12C","osc","ospf","Palshop","Panama","PBKDF2-HMAC-MD4","PBKDF2-HMAC-MD5","PBKDF2-HMAC-SHA1","PBKDF2-HMAC-SHA512","PDF","PEM","pfx","pgpdisk","pgpsda","phpass","PHPS","PHPS2","pix-md5","PKZIP","plaintext","po","postgres","PST","PuTTY","qnx","RACF","RACF-KDFAES","radius","RAdmin","RAKP","rar","RAR5","Raw-Keccak","Raw-Keccak-256","Raw-MD4","Raw-MD5","Raw-MD5u","Raw-SHA1","Raw-SHA1-Linkedin","Raw-SHA224","Raw-SHA256","Raw-SHA3","Raw-SHA512","restic","ripemd-128","ripemd-160","rsvp","RVARY","sapb","sapg","saph","sappse","scram","scrypt","securezip","sha1crypt","sha512crypt","Siemens-S7","Signal","SIP","skein-512","skey","SL3","Snefru-128","Snefru-256","SNMP","SSH","SSHA512","sspr","Stribog-256","Stribog-512","STRIP","SunMD5","SybaseASE","tacacs-plus","tc_aes_xts","tc_ripemd160boot","tc_sha512","tc_whirlpool","tcp-md5","telegram","tezos","Tiger","vdi","vmx","vtp","wbb3","whirlpool","whirlpool0","whirlpool1","WoWSRP","wpapsk","wpapsk-pmk","xsha","xsha512","zed","ZIP","ZipMonster","aix-ssha512","AxCrypt","bitshares","Clipperz","descrypt","django-scrypt","dragonfly3-64","dummy","electrum","Fortigate","HMAC-MD5","hMailServer","keyring","krb5-17","MD2","mscash2","multibit","net-md5","nsec3","OpenBSD-SoftRAID","Padlock","PBKDF2-HMAC-SHA256","pgpwde","pwsafe","Raw-Blake2","Raw-SHA1-AxCrypt","Raw-SHA384","Salted-SHA1","sha256crypt","skein-256","solarwinds","Sybase-PROP","tc_ripemd160","tripcode","VNC","xmpp-scram"],Po={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithIPFilter:mt,SelectWithServicesFilter:Ka,SelectWithFilter:Xo,SelectComponent:Wo},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)(!0),b=(0,n.KR)(e.CardAction),g=(0,n.KR)(e.CardName),v=(0,n.KR)(e.CardData),f=(0,n.KR)(zo),_=(0,n.KR)(Lo),k=(0,n.KR)(Ko),y=(0,n.KR)(No);function h(e){v.value.service=e}function C(e){v.value.type=e,"Metasploit::Credential::Password"==e&&(v.value.jtr_format=null),"Metasploit::Credential::NTLMHash"==e&&(v.value.jtr_format=["nt","lm"]),"Metasploit::Credential::NonreplayableHash"==e&&(v.value.jtr_format=["netntlmv2"])}async function F(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,u.state.current_user.token);if(void 0!=l&&0!=l&&200==l.status){l.data.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l}})}}async function x(e){var l=(0,m.y)("table","Creds","editItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(1==v.value.status&&(v.value.id=a.id,v.value.host=a.host,v.value.updated_at=a.updated_at),o(v.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function A(e){var l=(0,m.y)("table","Creds","addItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);if(void 0!=a&&0!=a)if(200==a.status){var n=[];if("::Service"==v.value.CredType){var s=0;a.logins_id.forEach(e=>{if(null!=e){var l=JSON.parse(JSON.stringify(v.value));l.id=a.id,l.logins_id=e,null!=l.service&&l.service!=[]?l.service=l.service[s]:l.service={id:a.service_id[s],port:0,proto:"",state:"",name:"system",info:""},l.host=a.host,l.origin=a.origin,l.created_at=a.created_at,l.updated_at=a.updated_at,n.push(l)}s+=1})}else{var r=JSON.parse(JSON.stringify(v.value));r.id=a.id,r.logins_id=null,r.host=a.host,r.service=null,r.origin=a.origin,r.created_at=a.created_at,r.updated_at=a.updated_at,n.push(r)}o(n),(0,Ie.e)(d,"positive","Запись добавлена","","done")}else(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem")}function w(e){null!=v.value.realm&&""!=v.value.realm||null==e&&""==e||(v.value.realm_type="Active Directory Domain"),null==v.value.realm&&""==v.value.realm||null!=e&&""!=e||(v.value.realm_type=null),v.value.realm=e}function S(){d.dialog({component:Tags,componentProps:{selected_hosts:v.value,original_call:"Add"}}).onOk(e=>{v.value.tags=e.row.value.tags})}function V(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}return(0,a.KC)(()=>{if(b.value,"EditItem"==b.value)if(p.value=!1,null!=v.value.logins_id)v.value.CredType="::Service";else if(null!=v.value.origin&&v.value.origin.hasOwnProperty("origin_type")){var e=v.value.origin.origin_type;v.value.CredType=e.replace("Metasploit::Credential::Origin","")}c.value=F()}),{dialogRef:l,SelectOptionsName:c,isMultiple:p,CardAction:b,CardName:g,CardData:v,SelectRealmOptions:f,TypePasswordSelectOptions:_,AccessLevelSelectOptions:k,JTRFormatSelectOption:y,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==V(e)||"Not valid IP-address"],updateService:h,updateJTRFormat:C,updateRealmType:w,Add:A,Edit:x,showTagDialog:S,onOKClick(){"AddItem"==b.value?A(JSON.stringify(v.value)):"EditItem"==b.value?x(JSON.stringify(v.value)):o(null)},onCancelClick:r,notes_type_icon:Xe,password_type_icon:Ke,services_name_icon:Te}}};var Mo=t(7878);const Uo=(0,_e.A)(Po,[["render",Ao]]),jo=Uo;we()(Po,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QRadio:Mo.A,QImg:Je.A,QInput:Me.A,QCardActions:Fe.A}),we()(Po,"directives",{ClosePopup:al.A});const Bo=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"host",align:"center",label:"IP",field:"host",sortable:!0,sort:(e,l,t,a,o)=>d(e,l,o)},{name:"service",align:"center",label:"Служба",field:"service",sortable:!0,sort:(e,l,t,a,o)=>u(e,l,o)},{name:"origin",align:"center",label:"Origin",field:"origin"},{name:"username",label:"Логин",align:"center",field:"username",sortable:!0},{name:"password",label:"Пароль",align:"center",field:"password",sortable:!0},{name:"realm",label:"Домен",align:"center",field:"realm",sortable:!0},{name:"realm_type",label:"Domain/Realm Type",align:"center",field:"realm_type",sortable:!0},{name:"access_level",label:"Уровень доступа",align:"center",field:"access_level",sortable:!0},{name:"type",label:"Тип пароля",align:"center",field:"type",sortable:!0},{name:"jtr_format",label:"JTR Формат",align:"center",field:"jtr_format",sortable:!0},{name:"comment",label:"Комментарий",align:"center",field:"comment",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],Jo=[],Ho={name:"TableCreds",components:{DownloadButtonMenu:xt.A,TableComponentsName:At.A,TableHostColumn:Xt,TableServiceColumn:$a,ActionsButtons:Kt.A},setup(){const e=(0,s.Pj)(),l=(0,n.KR)([]),t=(0,pe.A)(),o=(0,n.KR)(!1),d=(0,n.KR)([...Jo]),u=(0,n.KR)(e.state.user_settings),c=(0,n.KR)(!1),p=(0,n.KR)(""),b=(0,n.KR)(null);function g(){t.dialog({component:jo,componentProps:{CardAction:"AddItem",CardName:"Add Creds",CardData:{host:null,service:[],username:"",password:"",realm:"",realm_type:"",access_level:"",type:"Metasploit::Credential::Password",jtr_format:"",comment:null,CredType:"::Service"}}}).onOk(e=>{Array.isArray(e)?e.forEach(e=>{d.value.push(e)}):d.value.push(e)})}function v(e){t.dialog({component:jo,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}async function f(){c.value=!0;var l=(0,m.y)("table","Creds","getItem"),a={workspace:e.state.current_project,data:r(e.state.current_tree_node)},o=await(0,i.L)(l,a,null,e.state.current_user.token);void 0!=o&&o||Array.isArray(1==o)?(d.value=o,c.value=!1):(c.value=!1,o.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",o.message,"report_problem"))}async function _(a){var o=(0,m.y)("table","Creds","delItem"),n={workspace:e.state.current_project,data:{id:a.id,logins_id:a.logins_id,origin_id:a.origin_id}},s=await(0,i.L)(o,n,null,e.state.current_user.token);void 0!=s&&0!=s?(200==s.status&&(d.value=d.value.filter(e=>e.id!==a.id),l.value=l.value.filter(e=>e.id!=a.id)),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",s.message,"report_problem")}function k(){for(var e=l.value.filter(e=>e.id),t=0;t<e.length;t++)_(e[t])}function y(e){t.dialog({component:jo,componentProps:{CardAction:"EditItem",CardName:"Edit Creds",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=d.value.findIndex(l=>l.id==e.id);l>-1&&(d.value[l]=e)}})}function h(e){l.value=e.rows}function C(e){var l=null;if(void 0!=e&&null!=e&&"object"==typeof e&&e.hasOwnProperty("origin_type")&&"string"==typeof e.origin_type){var t=e.origin_type.toLowerCase();-1!=t.search("service")&&(l="service"),-1!=t.search("session")&&(l="session"),-1!=t.search("import")&&(l="import"),-1!=t.search("manual")&&(l="manual"),-1!=t.search("crackedpassword")&&(l="crackedpassword")}return l}return(0,a.wB)(()=>e.state.current_tree_node,()=>{f()}),(0,a.wB)(()=>e.state.user_settings,()=>{null!=e.state.user_settings&&(u.value=e.state.user_settings)}),(0,a.sV)(()=>{f()}),{q_table:b,loading:c,filter:p,selected:l,columns:Bo,Rows:d,tableSelectable:o,store:e,user_settings:u,visibleColumns:(0,n.KR)(["host","origin","service","username","password","realm","access_level","comment","actions"]),getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${Jo.length}`},handleSelectRow:h,loadData:f,AddItem:g,InfoItem:v,EditItem:y,DeleteItem:_,deleteItems:k,services_name_icon:Te,notes_type_icon:Xe,hosts_purpose_icon:De,hosts_osfamily_icon:Re,getOriginType:C}}},$o=(0,_e.A)(Ho,[["render",ho]]),Go=$o;we()(Ho,"components",{QTable:ce.A,QBtn:xe.A,QToggle:Pt.A,QInput:Me.A,QIcon:Ue.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QBadge:Jt.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A,QAvatar:nt.A});const Yo={key:0},Zo={key:0},en={key:1},ln={key:2},tn={key:3},an={key:0},on={key:0},nn={key:1},sn={key:4},rn={key:0},dn={key:5},un={key:0},cn={key:6,class:"truncate-text"},pn={key:7,align:"right"},mn={key:8,class:"truncate-text"};function bn(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("DownloadButtonMenu"),d=(0,a.g2)("q-toggle"),u=(0,a.g2)("TableComponentsName"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-input"),m=(0,a.g2)("q-checkbox"),g=(0,a.g2)("q-th"),v=(0,a.g2)("q-tr"),f=(0,a.g2)("q-popup-proxy"),_=(0,a.g2)("q-td"),k=(0,a.g2)("q-tooltip"),y=(0,a.g2)("q-img"),h=(0,a.g2)("TableHostColumn"),C=(0,a.g2)("TableServiceColumn"),F=(0,a.g2)("q-chip"),x=(0,a.g2)("q-expansion-item"),A=(0,a.g2)("ActionsButtons"),w=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.Wv)(w,{title:"Заметки",rows:o.Rows,columns:o.columns,"row-key":"id",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),selection:"multiple","selected-rows-label":o.getSelectedString,selected:o.selected,"onUpdate:selected":l[4]||(l[4]=e=>o.selected=e),onSelection:o.handleSelectRow,dense:"",loading:o.loading,filter:o.filter,"virtual-scroll":"","visible-columns":o.visibleColumns,"filter-method":o.customFilter},{"top-left":(0,a.k6)(()=>[(0,a.bF)(i,{color:"green",icon:"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:o.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.loadData())}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",icon:"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:o.deleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"indigo-7",icon:"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{table:o.q_table},null,8,["table"])]),_:1}),(0,a.bF)(d,{color:"blue",modelValue:o.tableSelectable,"onUpdate:modelValue":l[1]||(l[1]=e=>o.tableSelectable=e),label:"Select Rows"},null,8,["modelValue"])]),"top-right":(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(u,{name:"vulns",label:"Vulns",icon:{name:"gpp_bad",color:"red"}}),(0,a.bF)(p,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[2]||(l[2]=e=>o.filter=e),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(c,{name:"search"})]),_:1},8,["modelValue"])])]),header:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(g,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(g),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(g,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(f,{"context-menu":""},{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(d,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[3]||(l[3]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(_,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),(0,a.bF)(_,null,{default:(0,a.k6)(()=>[1==o.showExploitedCell(e.row.attempts)?((0,a.uX)(),(0,a.CE)("div",Yo,[(0,a.bF)(c,{name:"local_fire_department",color:"red",size:"md"},{default:(0,a.k6)(()=>[(0,a.bF)(k,null,{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)(" Exploited! ",-1)])]),_:1})]),_:1})])):(0,a.Q3)("",!0)]),_:2},1024),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(_,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["ltype"==l.name?((0,a.uX)(),(0,a.CE)("div",Zo,[null!=o.notes_type_icon(l.value)?((0,a.uX)(),(0,a.Wv)(y,{key:0,src:o.notes_type_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,b.v_)(l.value),1)])):"host"==l.name?((0,a.uX)(),(0,a.CE)("div",en,[(0,a.bF)(h,{model:l.value},null,8,["model"])])):"service"==l.name?((0,a.uX)(),(0,a.CE)("div",ln,[(0,a.bF)(C,{model:l.value},null,8,["model"])])):"attempts"==l.name?((0,a.uX)(),(0,a.CE)("div",tn,[void 0!=l.value&&null!=l.value&&1==o.showCell(l.value)?((0,a.uX)(),(0,a.CE)("div",an,[(0,a.bF)(x,{icon:"ads_click",label:"Попытки эксплуатации",caption:""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.value,e=>((0,a.uX)(),(0,a.CE)("div",null,[null!=e.exploited&&1==e.exploited?((0,a.uX)(),(0,a.CE)("div",on,[(0,a.bF)(F,{clickable:"",dense:"",color:"red","text-color":"white",icon:"check",label:e.module},null,8,["label"])])):((0,a.uX)(),(0,a.CE)("div",nn,[(0,a.bF)(F,{clickable:"",dense:"",color:"grey","text-color":"white",icon:"remove",label:e.fail_reason},null,8,["label"])]))]))),256))]),_:2},1024)])):(0,a.Q3)("",!0)])):"details"==l.name?((0,a.uX)(),(0,a.CE)("div",sn,[void 0!=l.value&&null!=l.value&&1==o.showCell(l.value)?((0,a.uX)(),(0,a.CE)("div",rn,[(0,a.bF)(x,{icon:"extension",label:"Детали",caption:""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.value,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(F,{clickable:"",dense:"",color:"grey","text-color":"white",icon:"extension",label:e.title},null,8,["label"])]))),256))]),_:2},1024)])):(0,a.Q3)("",!0)])):"refs"==l.name?((0,a.uX)(),(0,a.CE)("div",dn,[void 0!=l.value&&null!=l.value&&1==o.showCell(l.value)?((0,a.uX)(),(0,a.CE)("div",un,[(0,a.bF)(x,{icon:"link",label:"Ссылки",caption:""},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.value,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(F,{clickable:"",dense:"",color:"grey","text-color":"white",icon:"link",label:e.name},null,8,["label"])]))),256))]),_:2},1024)])):(0,a.Q3)("",!0)])):"data"==l.name?((0,a.uX)(),(0,a.CE)("div",cn,(0,b.v_)(l.value),1)):"actions"==l.name?((0,a.uX)(),(0,a.CE)("div",pn,[(0,a.bF)(A,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):((0,a.uX)(),(0,a.CE)("div",mn,(0,b.v_)(l.value),1))]),_:2},1024))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns","filter-method"])}const gn={class:"q-pa-md"},vn={class:"text-h6"},fn={key:0},_n={key:1};function kn(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-label"),v=(0,a.g2)("q-img"),f=(0,a.g2)("q-chip"),_=(0,a.g2)("SelectWithIPFilter"),k=(0,a.g2)("SelectWithServicesFilter"),y=(0,a.g2)("SelectWithFilter"),h=(0,a.g2)("q-input"),C=(0,a.g2)("ExpansionRefs"),F=(0,a.g2)("ExpansionDetails"),x=(0,a.g2)("ExpansionAttempts"),A=(0,a.g2)("q-card-actions"),w=(0,a.g2)("q-card"),S=(0,a.g2)("q-dialog"),V=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(S,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(w,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[12]||(l[12]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[V]])]),_:1}),(0,a.Lk)("div",gn,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"gpp_bad"})]),_:1}),(0,a.Lk)("div",vn,(0,b.v_)(o.CardName),1)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[13]||(l[13]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.host.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.services_name_icon(o.CardData.service.name),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)("Служба:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.service.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)("Уязвимость:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[16]||(l[16]=[(0,a.eW)("Информация:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.info),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"link",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[17]||(l[17]=[(0,a.eW)("Ссылки:",-1)])]),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.CardData.refs,e=>((0,a.uX)(),(0,a.CE)("div",null,[null!=e.id?((0,a.uX)(),(0,a.Wv)(f,{key:0,size:"md",icon:"link"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1024)):(0,a.Q3)("",!0)]))),256))])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"extension",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[18]||(l[18]=[(0,a.eW)("Детали:",-1)])]),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.CardData.details,e=>((0,a.uX)(),(0,a.CE)("div",null,[null!=e.id?((0,a.uX)(),(0,a.Wv)(f,{key:0,size:"md",icon:"extension"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.name),1)]),_:2},1024)):(0,a.Q3)("",!0)]))),256))])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"ads_click",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[19]||(l[19]=[(0,a.eW)("Попытки эксплуатации:",-1)])]),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.CardData.attempts,e=>((0,a.uX)(),(0,a.CE)("div",null,[1==e.exploited?((0,a.uX)(),(0,a.CE)("div",fn,[null!=e.id?((0,a.uX)(),(0,a.Wv)(f,{key:0,color:"red","text-color":"white",size:"md",icon:"ads_click"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.module),1)]),_:2},1024)):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",_n,[null!=e.id?((0,a.uX)(),(0,a.Wv)(f,{key:0,size:"md",icon:"ads_click"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.module),1)]),_:2},1024)):(0,a.Q3)("",!0)]))]))),256))])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(_,{modelValue:o.CardData.host,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.host=e),ref:"ipRef",rules:o.ipRules,selectOptions:o.SelectOptionsName,label:"IP-адрес",hint:"Text"},null,8,["modelValue","rules","selectOptions"]),(0,a.bF)(k,{modelValue:o.CardData.service,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.service=e),affectValue:o.CardData.host,label:"Служба",hint:"Text",isMultiple:o.isMultiple,onE_model:l[4]||(l[4]=e=>o.CardData.service=e)},null,8,["modelValue","affectValue","isMultiple"]),(0,a.bF)(y,{modelValue:o.CardData.name,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.name=e),selectOptions:o.SelectOptionsName,ImageFunction:o.notes_type_icon,label:"Уязвимость",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),(0,a.bF)(h,{filled:"",modelValue:o.CardData.info,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.info=e),label:"Информация",hint:"Text","lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue"]),(0,a.bF)(C,{refs:o.CardData.refs,onE_model:l[7]||(l[7]=e=>o.CardData.refs=e)},null,8,["refs"]),(0,a.bF)(F,{details:o.CardData.details,onE_model:l[8]||(l[8]=e=>o.CardData.details=e)},null,8,["details"]),(0,a.bF)(x,{attempts:o.CardData.attempts,onE_model:l[9]||(l[9]=e=>o.CardData.attempts=e)},null,8,["attempts"])]),_:1}))]),(0,a.bF)(A,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}function yn(e,l,t,o,n,s){const i=(0,a.g2)("q-item-label"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item"),u=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(u,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(d,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(i,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const hn={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),r=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),d=(0,n.KR)(e.ImageFunction),u=(0,n.KR)(e.label),c=(0,n.KR)(e.hint),p=(0,s.Pj)();async function b(e,l,t){setTimeout(()=>{l(()=>{if(""===e)r.value=o.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();r.value=o.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},1500)}function g(e){t.value=e}async function v(){var e=(0,m.y)("table","Vulns","getUnicName"),l=await(0,i.b)(e,null,p.state.current_user.token);void 0!=l&&0!=l&&(o.value=l.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:l,label:l}}))}return(0,a.KC)(()=>{v()}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:r,ImageFunction:d,filterFn:b,Label:u,Hint:c,setModel:g}}},Cn=(0,_e.A)(hn,[["render",yn]]),Fn=Cn;function xn(e,l,t,o,n,s){const i=(0,a.g2)("q-chip"),r=(0,a.g2)("q-card-section"),d=(0,a.g2)("SelectRefs"),u=(0,a.g2)("q-card"),c=(0,a.g2)("q-expansion-item");return(0,a.uX)(),(0,a.Wv)(c,{modelValue:o.Expanded,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Expanded=e),icon:"link",label:o.Label,caption:"",style:{"border-radius":"30px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,{bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"fit row inline justify-start"},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.Refs,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(i,{removable:"",label:e.name,onRemove:l=>o.removeChip(e)},null,8,["label","onRemove"])]))),256))]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,{label:"Ссылки",hint:"Text",onE_model:l[0]||(l[0]=e=>o.updateModel(e))})]),_:1})]),_:1})]),_:1},8,["modelValue","label"])}function An(e,l,t,o,n,s){const i=(0,a.g2)("q-item-label"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item"),u=(0,a.g2)("q-btn"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"",modelValue:o.Model,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Model=e),options:o.Options,label:o.Label,"option-label":"label",hint:o.Hint,"onUpdate:value":o.onUpdateValue,onInputValue:o.setModel,multiple:o.isMultiple,onFilter:o.filterFn},{option:(0,a.k6)(e=>[(0,a.bF)(d,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[2]||(l[2]=[(0,a.eW)(" No results ",-1)])]),_:1}),(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{color:"green",icon:"add","no-caps":"",size:"sm",class:"button-top",label:"Add Reference",onClick:l[0]||(l[0]=e=>o.AddNewRef())})]),_:1})]),_:1})]),_:1},8,["modelValue","options","label","hint","onUpdate:value","onInputValue","multiple","onFilter"])}we()(hn,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QItemLabel:el.A});const wn={props:{modelValue:{type:Object,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)([]),r=(0,n.KR)([]),d=(0,n.KR)(e.label),u=(0,n.KR)(e.hint),c=(0,s.Pj)(),p=(0,n.KR)(""),b=(0,n.KR)(!1);async function g(e,l,t){p.value=e,setTimeout(()=>{l(()=>{if(""===e)r.value=o.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();r.value=o.value.filter(e=>null!=e.name&&e.name.toLowerCase().indexOf(l)>-1)}})},1500)}function v(e){t.value=e,l("e_model",e)}function f(e){t.value=e}async function _(){var e=(0,m.y)("table","Vulns","getRefs"),l={workspace:c.state.current_project,data:null},t=await(0,i.L)(e,l,null,c.state.current_user.token);void 0!=t&&0!=t&&(o.value=t.map(function(e){return e.value=e.id,e.label=`${e.name}`,e}))}async function k(){var e=(0,m.y)("table","Vulns","addRef"),a={workspace:c.state.current_project,data:p.value},n=await(0,i.L)(e,a,null,c.state.current_user.token);if(void 0!=n&&0!=n){var s={id:n.id,name:p.value};o.value.push(s),r.value.push(s),l("e_model",s),p.value="",t.value=null}}return(0,a.KC)(()=>{Array.isArray(t.value)&&(b.value=!0),_()}),(0,a.nT)(()=>{}),(0,a.wB)(t,e=>{l("e_model",e),t.value=null}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),{Model:t,Options:r,Label:d,Hint:u,Filter:p,isMultiple:b,setModel:f,filterFn:g,onUpdateValue:v,AddNewRef:k,services_name_icon:Te}}},Sn=(0,_e.A)(wn,[["render",An]]),Vn=Sn;we()(wn,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QItemLabel:el.A,QBtn:xe.A});const Qn={props:{refs:{type:Object,default:null}},components:{SelectRefs:Vn},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(!1),o=(0,n.KR)(e.refs),s=(0,n.KR)("Ссылки");function i(e){null!=e&&"string"!=typeof e&&0==o.value.filter(l=>l.id==e.id).length&&(o.value.push(e),l("e_model",o.value),d())}function r(e){o.value=o.value.filter(l=>l!=e),l("e_model",o.value),d()}function d(){o.value.length>0?s.value=`Ссылки (${o.value.length})`:s.value="Ссылки"}return(0,a.KC)(()=>{(null==o.value||1==Array.isArray(o.value)&&1==o.value.length&&null==o.value[0].id)&&(o.value=[]),d()}),{Expanded:t,Refs:o,Label:s,updateModel:i,removeChip:r}}},In=(0,_e.A)(Qn,[["render",xn]]),Wn=In;we()(Qn,"components",{QExpansionItem:Hl.A,QCard:ye.A,QCardSection:ot.A,QChip:$l.A});var Dn=t(9104);const Rn={key:0},On={key:1};function Tn(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("q-card-section"),d=(0,a.g2)("q-input"),u=(0,a.g2)("q-popup-edit"),c=(0,a.g2)("q-td"),p=(0,a.g2)("q-tr"),m=(0,a.g2)("q-table"),g=(0,a.g2)("q-card"),v=(0,a.g2)("q-expansion-item");return(0,a.uX)(),(0,a.Wv)(v,{modelValue:o.Expanded,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Expanded=e),icon:"extension",label:o.Label,caption:"",style:{"border-radius":"30px"}},{default:(0,a.k6)(()=>[(0,a.bF)(g,{bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(i,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.addItem())})]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,{flat:"",bordered:"",dense:"",rows:o.Details,columns:o.Columns},{body:(0,a.k6)(e=>[(0,a.bF)(p,{props:e},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(c,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["action"==l.name?((0,a.uX)(),(0,a.CE)("div",Rn,[(0,a.bF)(i,{color:"green","icon-right":"edit",onClick:l=>o.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.bF)(i,{color:"red","icon-right":"delete",onClick:l=>o.delItem(e.row),size:"sm"},null,8,["onClick"])])):((0,a.uX)(),(0,a.CE)("div",On,[(0,a.eW)((0,b.v_)(l.value)+" ",1),(0,a.bF)(u,{modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l},{default:(0,a.k6)(e=>[(0,a.bF)(d,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,dense:"",autofocus:"",counter:"",onKeyup:(0,Dn.jR)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue","onUpdate:modelValue"])]))]),_:2},1024))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"])}const qn={class:"q-pa-md"},En={class:"text-h6"};function Xn(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-card-section"),p=(0,a.g2)("q-input"),m=(0,a.g2)("q-card-actions"),g=(0,a.g2)("q-card"),v=(0,a.g2)("q-dialog"),f=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(v,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[f]])]),_:1}),(0,a.Lk)("div",qn,[(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",En,(0,b.v_)(o.CardName),1)]),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(p,{filled:"",modelValue:o.CardData.title,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.title=e),label:"Заголовок",hint:"Text","lazy-rules":""},null,8,["modelValue"]),(0,a.bF)(p,{filled:"",modelValue:o.CardData.description,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.description=e),label:"Описание",hint:"Text","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.bF)(p,{filled:"",modelValue:o.CardData.solution,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.solution=e),label:"Как устранить",hint:"Text","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.bF)(p,{filled:"",modelValue:o.CardData.cvss,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.cvss=e),label:"CVSS",hint:"Int","lazy-rules":"",autogrow:""},null,8,["modelValue"])]),_:1})]),(0,a.bF)(m,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Kn={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:i}=(0,ge.A)(),r=(0,pe.A)(),d=((0,s.Pj)(),(0,n.KR)([])),u=(0,n.KR)("Text"),c=(0,n.KR)(!0),p=(0,n.KR)(e.CardAction),m=(0,n.KR)(e.CardName),b=(0,n.KR)(e.CardData);function g(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}function v(e){o(e)}function f(e){o(e)}function _(){r.dialog({component:Tags,componentProps:{selected_hosts:b.value,original_call:"Add"}}).onOk(e=>{b.value.tags=e.row.value.tags})}return(0,a.KC)(()=>{try{"object"==typeof b.value.data&&(u.value="JSON",b.value.data=JSON.stringify(JSON.parse(JSON.stringify(b.value.data)),null,2))}catch(e){type_data.value="Text"}"EditItem"==p.value&&(c.value=!1)}),(0,a.wB)(()=>b.value.data,()=>{u.value=g(b.value.data)}),{dialogRef:l,SelectOptionsName:d,TypeData:u,isMultiple:c,CardAction:p,CardName:m,CardData:b,maximizedToggle:(0,n.KR)(!1),Add:f,Edit:v,showTagDialog:_,onOKClick(){"AddItem"==p.value?f(JSON.stringify(b.value)):"EditItem"==p.value&&v(JSON.stringify(b.value))},onCancelClick:i,notes_type_icon:Xe}}},Ln=(0,_e.A)(Kn,[["render",Xn]]),zn=Ln;we()(Kn,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QInput:Me.A,QCardActions:Fe.A}),we()(Kn,"directives",{ClosePopup:al.A});const Nn={props:{details:{type:Object,default:null}},components:{AddEditItemDetail:zn},emits:[],setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(!1),s=(0,n.KR)(e.details),i=(0,n.KR)("Детали уязвимости"),r=(0,n.KR)([{name:"title",align:"center",label:"Заголовок",field:"title",sortable:!0},{name:"description",label:"Описание",field:"description",sortable:!0},{name:"solution",label:"Как устранить",field:"solution",sortable:!0},{name:"cvss",label:"CVSS",field:"cvss",sortable:!0},{name:"action",label:"Action",field:"action"}]);function d(){t.dialog({component:zn,componentProps:{CardAction:"AddItem",CardName:"Add Detail",CardData:{title:"",description:"",solution:"",cvss:0}}}).onOk(e=>{s.value.push(JSON.parse(e)),l("e_model",s.value),p()})}function u(e){t.dialog({component:zn,componentProps:{CardAction:"EditItem",CardName:"Edit Detail",CardData:JSON.parse(JSON.stringify(e))}}).onOk(t=>{if(void 0!=t){let a=JSON.parse(t);const o=s.value.findIndex(l=>l==e);o>-1&&(s.value[o]=a),l("e_model",s.value)}p()})}function c(e){s.value=s.value.filter(l=>l!=e),l("e_model",s.value),p()}function p(){s.value.length>0?i.value=`Детали уязвимости (${s.value.length})`:i.value="Детали уязвимости"}return(0,a.KC)(()=>{(null==s.value||1==Array.isArray(s.value)&&1==s.value.length&&null==s.value[0].id)&&(s.value=[]),p()}),{Expanded:o,Details:s,Label:i,Columns:r,addItem:d,editItem:u,delItem:c,labelCountRefsShow:p}}};var Pn=t(3486);const Mn=(0,_e.A)(Nn,[["render",Tn]]),Un=Mn;we()(Nn,"components",{QExpansionItem:Hl.A,QCard:ye.A,QCardSection:ot.A,QBtn:xe.A,QTable:ce.A,QTr:Mt.A,QTd:Bt.A,QPopupEdit:Pn.A,QInput:Me.A});const jn={key:0},Bn={key:1},Jn={key:2};function Hn(e,l,t,o,n,s){const i=(0,a.g2)("q-icon"),r=(0,a.g2)("q-avatar"),d=(0,a.g2)("q-item-section"),u=(0,a.g2)("q-btn"),c=(0,a.g2)("q-card-section"),p=(0,a.g2)("q-checkbox"),m=(0,a.g2)("q-input"),g=(0,a.g2)("q-popup-edit"),v=(0,a.g2)("q-td"),f=(0,a.g2)("q-tr"),_=(0,a.g2)("q-table"),k=(0,a.g2)("q-card"),y=(0,a.g2)("q-expansion-item");return(0,a.uX)(),(0,a.Wv)(y,{modelValue:o.Expanded,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Expanded=e),icon:"extension",caption:"",style:{"border-radius":"30px"}},{header:(0,a.k6)(()=>[(0,a.bF)(d,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{size:"24px"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"ads_click",size:"sm"})]),_:1})]),_:1}),(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.Label),1)]),_:1})]),default:(0,a.k6)(()=>[(0,a.bF)(k,{bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(u,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.addItem())})]),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(_,{flat:"",bordered:"",dense:"",rows:o.Attempts,columns:o.Columns},{body:(0,a.k6)(e=>[(0,a.bF)(f,{props:e},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(v,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["action"==l.name?((0,a.uX)(),(0,a.CE)("div",jn,[(0,a.bF)(u,{color:"green","icon-right":"edit",onClick:l=>o.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.bF)(u,{color:"red","icon-right":"delete",onClick:l=>o.delItem(e.row),size:"sm"},null,8,["onClick"])])):"exploited"==l.name?((0,a.uX)(),(0,a.CE)("div",Bn,[(0,a.bF)(p,{modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,disable:""},null,8,["modelValue","onUpdate:modelValue"])])):((0,a.uX)(),(0,a.CE)("div",Jn,[(0,a.eW)((0,b.v_)(l.value)+" ",1),(0,a.bF)(g,{modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l},{default:(0,a.k6)(e=>[(0,a.bF)(m,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,dense:"",autofocus:"",counter:"",onKeyup:(0,Dn.jR)(e.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue","onUpdate:modelValue"])]))]),_:2},1024))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const $n={class:"q-pa-md"},Gn={class:"text-h6"};function Yn(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-card-section"),p=(0,a.g2)("q-checkbox"),m=(0,a.g2)("q-input"),g=(0,a.g2)("q-card-actions"),v=(0,a.g2)("q-card"),f=(0,a.g2)("q-dialog"),_=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(f,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(v,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[_]])]),_:1}),(0,a.Lk)("div",$n,[(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",Gn,(0,b.v_)(o.CardName),1)]),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(p,{filled:"",modelValue:o.CardData.exploited,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.exploited=e),label:"Успешная эксплуатация"},null,8,["modelValue"]),(0,a.bF)(m,{filled:"",modelValue:o.CardData.module,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.module=e),label:"Модуль, задействованый при эксплаутации",hint:"Text","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.bF)(m,{filled:"",modelValue:o.CardData.fail_reason,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.fail_reason=e),label:"Причины неуспешной эксплуатации",hint:"Text","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.bF)(m,{filled:"",modelValue:o.CardData.fail_detail,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.fail_detail=e),label:"Детали неуспешной эксплуатации",hint:"Text","lazy-rules":"",autogrow:""},null,8,["modelValue"])]),_:1})]),(0,a.bF)(g,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Zn={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:i}=(0,ge.A)(),r=(0,pe.A)(),d=((0,s.Pj)(),(0,n.KR)([])),u=(0,n.KR)("Text"),c=(0,n.KR)(!0),p=(0,n.KR)(e.CardAction),m=(0,n.KR)(e.CardName),b=(0,n.KR)(e.CardData);function g(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}function v(e){o(e)}function f(e){o(e)}function _(){r.dialog({component:Tags,componentProps:{selected_hosts:b.value,original_call:"Add"}}).onOk(e=>{b.value.tags=e.row.value.tags})}return(0,a.KC)(()=>{try{"object"==typeof b.value.data&&(u.value="JSON",b.value.data=JSON.stringify(JSON.parse(JSON.stringify(b.value.data)),null,2))}catch(e){type_data.value="Text"}"EditItem"==p.value&&(c.value=!1)}),(0,a.wB)(()=>b.value.data,()=>{u.value=g(b.value.data)}),{dialogRef:l,SelectOptionsName:d,TypeData:u,isMultiple:c,CardAction:p,CardName:m,CardData:b,maximizedToggle:(0,n.KR)(!1),Add:f,Edit:v,showTagDialog:_,onOKClick(){"AddItem"==p.value?f(JSON.stringify(b.value)):"EditItem"==p.value&&v(JSON.stringify(b.value))},onCancelClick:i,notes_type_icon:Xe}}},es=(0,_e.A)(Zn,[["render",Yn]]),ls=es;we()(Zn,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QCheckbox:Be.A,QInput:Me.A,QCardActions:Fe.A}),we()(Zn,"directives",{ClosePopup:al.A});const ts={props:{attempts:{type:Object,default:null}},components:{AddEditItemAttempt:ls},emits:[],setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(!1),s=(0,n.KR)(e.attempts),i=(0,n.KR)("Попытки эксплуатации"),r=(0,n.KR)([{name:"exploited",align:"center",label:"Успешная эксплуатация",field:"exploited",sortable:!0},{name:"module",label:"Модуль, задействованый при эксплаутации",field:"module",sortable:!0},{name:"fail_reason",label:"Причины неуспешной эксплуатации",field:"fail_reason",sortable:!0},{name:"fail_detail",label:"Детали неуспешной эксплуатации",field:"fail_detail",sortable:!0},{name:"action",label:"Action",field:"action"}]);function d(){t.dialog({component:ls,componentProps:{CardAction:"AddItem",CardName:"Add Attempt",CardData:{exploited:!1,module:"",fail_reason:"",fail_detail:""}}}).onOk(e=>{s.value.push(JSON.parse(e)),l("e_model",s.value),p()})}function u(e){t.dialog({component:ls,componentProps:{CardAction:"EditItem",CardName:"Edit Attempt",CardData:JSON.parse(JSON.stringify(e))}}).onOk(t=>{if(void 0!=t){let a=JSON.parse(t);const o=s.value.findIndex(l=>l==e);o>-1&&(s.value[o]=a),l("e_model",s.value)}p()})}function c(e){s.value=s.value.filter(l=>l!=e),l("e_model",s.value),p()}function p(){s.value.length>0?i.value=`Попытки эксплуатации (${s.value.length})`:i.value="Попытки эксплуатации"}return(0,a.KC)(()=>{(null==s.value||1==Array.isArray(s.value)&&1==s.value.length&&null==s.value[0].id)&&(s.value=[]),p()}),{Expanded:o,Attempts:s,Label:i,Columns:r,addItem:d,editItem:u,delItem:c,labelCountRefsShow:p}}},as=(0,_e.A)(ts,[["render",Hn]]),os=as;we()(ts,"components",{QExpansionItem:Hl.A,QItemSection:Ze.A,QAvatar:nt.A,QIcon:Ue.A,QCard:ye.A,QCardSection:ot.A,QBtn:xe.A,QTable:ce.A,QTr:Mt.A,QTd:Bt.A,QCheckbox:Be.A,QPopupEdit:Pn.A,QInput:Me.A});const ns={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithFilter:Fn,SelectWithIPFilter:mt,SelectWithServicesFilter:Ka,ExpansionRefs:Wn,ExpansionDetails:Un,ExpansionAttempts:os},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)("Text"),b=(0,n.KR)(!1),g=(0,n.KR)(e.CardAction),v=(0,n.KR)(e.CardName),f=(0,n.KR)(e.CardData);function _(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}async function k(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,u.state.current_user.token);if(void 0!=l&&0!=l&&200==l.status){l.data.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l}})}}async function y(e){var l=(0,m.y)("table","Vulns","editItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);if(void 0!=a&&0!=a)if(200==a.status){if(Array.isArray(a.vuln_details_id)){let e=0;a.vuln_details_id.forEach(l=>{f.value.details[e].id=l})}if(Array.isArray(a.vuln_attempts_id)){let e=0;a.vuln_attempts_id.forEach(l=>{f.value.attempts[e].id=l})}f.value.created_at=a.created_at,o(f.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")}else(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem")}async function h(e){var l=(0,m.y)("table","Vulns","addItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);if(void 0!=a&&0!=a)if(200==a.status){if(f.value.id=a.id,Array.isArray(a.vuln_details_id)){let e=0;a.vuln_details_id.forEach(l=>{f.value.details[e].id=l})}if(Array.isArray(a.vuln_attempts_id)){let e=0;a.vuln_attempts_id.forEach(l=>{f.value.attempts[e].id=l})}f.value.created_at=a.created_at,f.value.updated_at=a.updated_at,o(f.value),(0,Ie.e)(d,"positive","Запись добавлена","","done")}else(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem")}function C(){d.dialog({component:Tags,componentProps:{selected_hosts:f.value,original_call:"Add"}}).onOk(e=>{f.value.tags=e.row.value.tags})}function F(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}return(0,a.KC)(()=>{try{"object"==typeof f.value.data&&(p.value="JSON",f.value.data=JSON.stringify(JSON.parse(JSON.stringify(f.value.data)),null,2))}catch(e){}c.value=k()}),(0,a.wB)(()=>f.value.data,()=>{p.value=_(f.value.data)}),{dialogRef:l,SelectOptionsName:c,TypeData:p,isMultiple:b,CardAction:g,CardName:v,CardData:f,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==F(e)||"Not valid IP-address"],Add:h,Edit:y,showTagDialog:C,onOKClick(){let e=JSON.parse(JSON.stringify(f.value));try{e.data=We.o4.fromUint8Array((0,za.Bh)(JSON.parse(e.data)).buffer,!0)}catch{e.data=We.o4.encode(e.data,!0)}"AddItem"==g.value?h(JSON.stringify(e)):"EditItem"==g.value?y(JSON.stringify(e)):o(null)},onCancelClick:r,notes_type_icon:Xe,services_name_icon:Te}}},ss=(0,_e.A)(ns,[["render",kn]]),is=ss;we()(ns,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QImg:Je.A,QChip:$l.A,QInput:Me.A,QCardActions:Fe.A}),we()(ns,"directives",{ClosePopup:al.A});const rs=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"host",align:"center",label:"IP",field:"host",sortable:!0,sort:(e,l,t,a,o)=>d(e,l,o)},{name:"service",align:"center",label:"Служба",field:"service",sortable:!0,sort:(e,l,t,a,o)=>u(e,l,o)},{name:"name",label:"Имя",align:"center",field:"name",sortable:!0},{name:"info",label:"Информация",align:"center",field:"info",sortable:!0},{name:"cvss",label:"CVSS",align:"center",field:"cvss",sortable:!0},{name:"details",label:"Детали",align:"center",field:"details"},{name:"attempts",label:"Попытки эксплуатации",align:"center",field:"attempts",sortable:!0},{name:"refs",label:"Ссылка",align:"center",field:"refs",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],ds=[],us={name:"TableVulns",components:{DownloadButtonMenu:xt.A,TableComponentsName:At.A,TableHostColumn:Xt,TableServiceColumn:$a,ActionsButtons:Kt.A},setup(){const e=(0,s.Pj)(),l=(0,n.KR)([]),t=(0,pe.A)(),o=(0,n.KR)(!1),d=(0,n.KR)([...ds]),u=(0,n.KR)(e.state.user_settings),c=(0,n.KR)(!1),b=(0,n.KR)(""),g=(0,n.KR)(null);function v(){t.dialog({component:is,componentProps:{CardAction:"AddItem",CardName:"Add Vuln",CardData:{host:{id:null,address:"",puprose:"",os_family:""},service:null,name:"",info:"",details:null,attempts:null,refs:null}}}).onOk(e=>{Array.isArray(e)?e.forEach(e=>{d.value.push(e)}):d.value.push(e)})}function f(e){t.dialog({component:is,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}async function _(){c.value=!0;var l=(0,m.y)("table","Vulns","getItem"),a={workspace:e.state.current_project,data:r(e.state.current_tree_node)},o=await(0,i.L)(l,a,null,e.state.current_user.token);void 0!=o&&o||Array.isArray(1==o)?(d.value=o,d.value.forEach(e=>{(null==e.refs||1==Array.isArray(e.refs)&&1==e.refs.length&&null==e.refs[0].id)&&(e.refs=null),(null==e.details||1==Array.isArray(e.details)&&1==e.details.length&&null==e.details[0].id)&&(e.details=null),(null==e.attempts||1==Array.isArray(e.attempts)&&1==e.attempts.length&&null==e.attempts[0].id)&&(e.attempts=null)}),c.value=!1):(c.value=!1,o.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",o.message,"report_problem"))}async function k(a){var o=(0,m.y)("table","Vulns","delItem"),n={workspace:e.state.current_project,data:a.id},s=await(0,i.L)(o,n,null,e.state.current_user.token);void 0!=s&&0!=s?(200==s.status&&(d.value=d.value.filter(e=>e.id!==a.id),l.value=l.value.filter(e=>e.id!=a.id)),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",s.message,"report_problem")}function y(){for(var e=l.value.filter(e=>e.id),t=0;t<e.length;t++)k(e[t])}function h(e){t.dialog({component:is,componentProps:{CardAction:"EditItem",CardName:"Edit Vuln",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=d.value.findIndex(l=>l.id==e.id);l>-1&&(d.value[l]=e)}})}function C(e){l.value=e.rows}function F(e){var l=!1;try{e.forEach(e=>{1==e.exploited&&(l=!0)})}catch(e){}return l}function x(e){var l=!1;try{Array.isArray(e)&&(l=1!=e.length||null!=e[0].id)}catch(e){}return l}return(0,a.wB)(()=>e.state.current_tree_node,()=>{_()}),(0,a.wB)(()=>e.state.user_settings,()=>{null!=e.state.user_settings&&(u.value=e.state.user_settings)}),(0,a.sV)(()=>{_()}),{store:e,loading:c,filter:b,q_table:g,selected:l,columns:rs,Rows:d,tableSelectable:o,user_settings:u,visibleColumns:(0,n.KR)(["exploited","host","service","name","info","cvss","details","attempts","refs","actions"]),loadData:_,AddItem:v,InfoItem:f,EditItem:h,DeleteItem:k,deleteItems:y,services_name_icon:Te,notes_type_icon:Xe,hosts_purpose_icon:De,hosts_osfamily_icon:Re,handleSelectRow:C,customFilter:p,showExploitedCell:F,showCell:x,getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${ds.length}`}}}},cs=(0,_e.A)(us,[["render",bn]]),ps=cs;we()(us,"components",{QTable:ce.A,QBtn:xe.A,QToggle:Pt.A,QInput:Me.A,QIcon:Ue.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QTooltip:He.A,QImg:Je.A,QExpansionItem:Hl.A,QChip:$l.A});const ms={key:0},bs={key:1},gs={key:2},vs={key:3,class:"truncate-text"},fs={key:4,align:"right"},_s={key:5};function ks(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("DownloadButtonMenu"),d=(0,a.g2)("q-toggle"),u=(0,a.g2)("TableComponentsName"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-input"),m=(0,a.g2)("q-checkbox"),g=(0,a.g2)("q-th"),v=(0,a.g2)("q-tr"),f=(0,a.g2)("q-popup-proxy"),_=(0,a.g2)("q-td"),k=(0,a.g2)("q-img"),y=(0,a.g2)("TableHostColumn"),h=(0,a.g2)("TableServiceColumn"),C=(0,a.g2)("ActionsButtons"),F=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.Wv)(F,{title:"Loots",rows:o.Rows,columns:o.columns,"row-key":"id",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),selection:"multiple","selected-rows-label":o.getSelectedString,selected:o.selected,"onUpdate:selected":l[4]||(l[4]=e=>o.selected=e),onSelection:o.handleSelectRow,dense:"",loading:o.loading,filter:o.filter,"virtual-scroll":"","visible-columns":o.visibleColumns,"filter-method":o.customFilter},{"top-left":(0,a.k6)(()=>[(0,a.bF)(i,{color:"green",icon:"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:o.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:l[0]||(l[0]=e=>o.loadData())}),o.selected.length>0?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",icon:"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:o.deleteItems},null,8,["onClick"])):(0,a.Q3)("",!0),(0,a.bF)(i,{color:"indigo-7",icon:"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{table:o.q_table},null,8,["table"])]),_:1}),(0,a.bF)(d,{color:"blue",modelValue:o.tableSelectable,"onUpdate:modelValue":l[1]||(l[1]=e=>o.tableSelectable=e),label:"Select Rows"},null,8,["modelValue"])]),"top-right":(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(u,{name:"loots",label:"Loots",icon:{name:"diamond",color:"blue"}}),(0,a.bF)(p,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":l[2]||(l[2]=e=>o.filter=e),placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(c,{name:"search"})]),_:1},8,["modelValue"])])]),header:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(g,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(g,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(f,{"context-menu":""},{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(d,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[3]||(l[3]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[(0,a.bF)(v,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(_,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(_,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["ltype"==l.name?((0,a.uX)(),(0,a.CE)("div",ms,[null!=o.notes_type_icon(l.value)?((0,a.uX)(),(0,a.Wv)(k,{key:0,src:o.notes_type_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,b.v_)(l.value),1)])):"host"==l.name?((0,a.uX)(),(0,a.CE)("div",bs,[(0,a.bF)(y,{model:l.value},null,8,["model"])])):"service"==l.name?((0,a.uX)(),(0,a.CE)("div",gs,[(0,a.bF)(h,{model:l.value},null,8,["model"])])):"data"==l.name?((0,a.uX)(),(0,a.CE)("div",vs,(0,b.v_)(l.value),1)):"actions"==l.name?((0,a.uX)(),(0,a.CE)("div",fs,[(0,a.bF)(C,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):((0,a.uX)(),(0,a.CE)("div",_s,(0,b.v_)(l.value),1))]),_:2},1024))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns","filter-method"])}const ys={class:"q-pa-md"},hs={class:"text-h6"};function Cs(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-label"),v=(0,a.g2)("q-img"),f=(0,a.g2)("JsonEditorVue"),_=(0,a.g2)("SelectWithIPFilter"),k=(0,a.g2)("SelectWithServicesFilter"),y=(0,a.g2)("SelectWithFilter"),h=(0,a.g2)("q-input"),C=(0,a.g2)("q-card-actions"),F=(0,a.g2)("q-card"),x=(0,a.g2)("q-dialog"),A=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(x,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(F,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[12]||(l[12]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[A]])]),_:1}),(0,a.Lk)("div",ys,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"diamond"})]),_:1}),(0,a.Lk)("div",hs,(0,b.v_)(o.CardName),1)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[13]||(l[13]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.host.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.services_name_icon(o.CardData.service.name),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)("Служба:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.service.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.notes_type_icon(o.CardData.ltype),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)("Loot Type:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.ltype),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[16]||(l[16]=[(0,a.eW)("Путь:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.path),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[17]||(l[17]=[(0,a.eW)("Информация:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.info),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[18]||(l[18]=[(0,a.eW)("Данные:",-1)])]),_:1}),(0,a.bF)(f,{modelValue:o.Data,"onUpdate:modelValue":l[2]||(l[2]=e=>o.Data=e),"read-only":!0,"main-menu-bar":!1,"navigation-bar":!1},null,8,["modelValue"])])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(_,{modelValue:o.CardData.host,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.host=e),ref:"ipRef",rules:o.ipRules,selectOptions:o.SelectOptionsName,label:"IP-адрес",hint:"Text"},null,8,["modelValue","rules","selectOptions"]),(0,a.bF)(k,{modelValue:o.CardData.service,"onUpdate:modelValue":l[4]||(l[4]=e=>o.CardData.service=e),affectValue:o.CardData.host,label:"Служба",hint:"Text",isMultiple:o.isMultiple},null,8,["modelValue","affectValue","isMultiple"]),(0,a.bF)(y,{modelValue:o.CardData.ltype,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.ltype=e),selectOptions:o.SelectOptionsName,ImageFunction:o.notes_type_icon,label:"Loots Type",hint:"Text"},null,8,["modelValue","selectOptions","ImageFunction"]),(0,a.bF)(h,{filled:"",modelValue:o.CardData.path,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.path=e),label:"Путь",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue"]),(0,a.bF)(h,{filled:"",modelValue:o.CardData.name,"onUpdate:modelValue":l[7]||(l[7]=e=>o.CardData.name=e),label:"Имя файла",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue"]),(0,a.bF)(h,{filled:"",modelValue:o.CardData.info,"onUpdate:modelValue":l[8]||(l[8]=e=>o.CardData.info=e),label:"Информация",hint:"Text","lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue"]),(0,a.bF)(h,{filled:"",modelValue:o.CardData.data,"onUpdate:modelValue":l[9]||(l[9]=e=>o.CardData.data=e),label:"Данные",hint:o.TypeData,"lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue","hint"])]),_:1}))]),(0,a.bF)(C,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Fs=["src"];function xs(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(c,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:e.opt.image},null,8,["src"])]),_:2},1024),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.label),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[1]||(l[1]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.Lk)("img",{src:o.ImageFunction(o.Model),style:{width:"25px",height:"25px"}},null,8,Fs)]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const As={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},ImageFunction:{type:Function,default:null},label:{type:String,default:""},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),r=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),d=(0,n.KR)(e.ImageFunction),u=(0,n.KR)(e.label),c=(0,n.KR)(e.hint),p=(0,s.Pj)();async function b(e,l,t){setTimeout(()=>{l(()=>{if(""===e)r.value=o.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();r.value=o.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},1500)}function g(e){t.value=e}async function v(){var e=(0,m.y)("table","Loots","getUnicName"),l=await(0,i.b)(e,null,p.state.current_user.token);void 0!=l&&0!=l&&(o.value=l.map(function(e){var l="";return null!=e.ltype&&(l=e.ltype),{value:l,label:l,image:d.value(l)}}))}return(0,a.KC)(()=>{v()}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("update:modelValue",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:r,ImageFunction:d,filterFn:b,Label:u,Hint:c,setModel:g}}},ws=(0,_e.A)(As,[["render",xs]]),Ss=ws;we()(As,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QImg:Je.A,QItemLabel:el.A});const Vs={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithFilter:Ss,SelectWithIPFilter:mt,SelectWithServicesFilter:Ka,JsonEditorVue:La.A},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)("Text"),b=(0,n.KR)(!0),g=(0,n.KR)(null),v=(0,n.KR)(e.CardAction),f=(0,n.KR)(e.CardName),_=(0,n.KR)(e.CardData);function k(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}async function y(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,u.state.current_user.token);if(void 0!=l&&0!=l&&200==l.status){l.data.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l}})}}async function h(e){var l=(0,m.y)("table","Loots","editItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(1==_.value.status&&(_.value.id=a.id,_.value.host=a.host,_.value.updated_at=a.updated_at),o(_.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function C(e){var l=(0,m.y)("table","Loots","addItem"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);if(void 0!=a&&0!=a)if(200==a.status){if(Array.isArray(a.loot)){var n=[];a.loot.forEach(e=>{var l=JSON.parse(JSON.stringify(_.value));l.id=e.id,l.service=_.value.service,l.created_at=e.created_at,l.updated_at=e.updated_at,n.push(l)}),o(n)}else _.value.id=a.loot.id,_.value.service=a.loot.service,_.value.host=a.loot.host,_.value.created_at=a.loot.created_at,_.value.updated_at=a.loot.updated_at,o(_.value);(0,Ie.e)(d,"positive","Запись добавлена","","done")}else(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem")}function F(){d.dialog({component:Tags,componentProps:{selected_hosts:_.value,original_call:"Add"}}).onOk(e=>{_.value.tags=e.row.value.tags})}function x(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}return(0,a.KC)(()=>{try{"object"==typeof _.value.data&&(p.value="JSON",_.value.data=JSON.stringify(JSON.parse(JSON.stringify(_.value.data)),null,2))}catch(e){p.value="Text"}"EditItem"==v.value&&(b.value=!1),"InfoItem"==v.value&&("JSON"==k(_.value.data)?g.value=JSON.parse(_.value.data):g.value=_.value.data),c.value=y()}),(0,a.wB)(()=>_.value.data,()=>{p.value=k(_.value.data)}),{dialogRef:l,SelectOptionsName:c,TypeData:p,isMultiple:b,CardAction:v,CardName:f,CardData:_,Data:g,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==x(e)||"Not valid IP-address"],Add:C,Edit:h,showTagDialog:F,onOKClick(){let e=JSON.parse(JSON.stringify(_.value));try{e.data=We.o4.fromUint8Array((0,za.Bh)(JSON.parse(e.data)).buffer,!0)}catch{e.data=We.o4.encode(e.data,!0)}"AddItem"==v.value?C(JSON.stringify(e)):"EditItem"==v.value?h(JSON.stringify(e)):o(null)},onCancelClick:r,notes_type_icon:Xe,services_name_icon:Te}}},Qs=(0,_e.A)(Vs,[["render",Cs]]),Is=Qs;we()(Vs,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QImg:Je.A,QInput:Me.A,QCardActions:Fe.A}),we()(Vs,"directives",{ClosePopup:al.A});const Ws=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"host",align:"center",label:"IP",field:"host",sortable:!0,sort:(e,l,t,a,o)=>d(e,l,o)},{name:"service",align:"center",label:"Служба",field:"service",sortable:!0,sort:(e,l,t,a,o)=>u(e,l,o)},{name:"ltype",label:"Тип",align:"center",field:"ltype",sortable:!0},{name:"name",label:"Имя",align:"center",field:"name",sortable:!0},{name:"info",label:"Информация",align:"center",field:"info",sortable:!0},{name:"path",label:"Путь",align:"center",field:"path",sortable:!0},{name:"data",label:"Данные",align:"center",field:"data"},{name:"content_type",label:"Тип данных",align:"center",field:"content_type",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],Ds=[],Rs={name:"TableLoots",components:{DownloadButtonMenu:xt.A,TableComponentsName:At.A,TableHostColumn:Xt,TableServiceColumn:$a,ActionsButtons:Kt.A},setup(){const e=(0,s.Pj)(),l=(0,n.KR)([]),t=(0,pe.A)(),o=(0,n.KR)(!1),d=(0,n.KR)([...Ds]),u=(0,n.KR)(e.state.user_settings),c=(0,n.KR)(!1),b=(0,n.KR)(""),g=(0,n.KR)(null);function v(){t.dialog({component:Is,componentProps:{CardAction:"AddItem",CardName:"Add Loot",CardData:{host:{id:null,address:"",puprose:"",os_family:""},service:[],ltype:"",name:"",info:"",content_type:"text/plain",data:""}}}).onOk(e=>{Array.isArray(e)?e.forEach(e=>{d.value.push(e)}):d.value.push(e)})}function f(e){t.dialog({component:Is,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}async function _(){c.value=!0;var l=(0,m.y)("table","Loots","getItem"),a={workspace:e.state.current_project,data:r(e.state.current_tree_node)},o=await(0,i.L)(l,a,null,e.state.current_user.token);void 0!=o&&o||Array.isArray(1==o)?(d.value=o,d.value.forEach(e=>{try{e.data=(0,za.Hh)(We.o4.toUint8Array(e.data).buffer,{hashToJS:!0})}catch(l){e.data=We.o4.decode(e.data)}}),c.value=!1):(c.value=!1,o.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",o.message,"report_problem"))}async function k(a){var o=(0,m.y)("table","Loots","delItem"),n={workspace:e.state.current_project,data:a.id},s=await(0,i.L)(o,n,null,e.state.current_user.token);void 0!=s&&0!=s?(200==s.status&&(d.value=d.value.filter(e=>e.id!==a.id),l.value=l.value.filter(e=>e.id!=a.id)),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",s.message,"report_problem")}function y(){for(var e=l.value.filter(e=>e.id),t=0;t<e.length;t++)k(e[t])}function h(e){t.dialog({component:Is,componentProps:{CardAction:"EditItem",CardName:"Edit Loot",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=d.value.findIndex(l=>l.id==e.id);l>-1&&(d.value[l]=e)}})}function C(e){l.value=e.rows}return(0,a.wB)(()=>e.state.current_tree_node,()=>{_()}),(0,a.wB)(()=>e.state.user_settings,()=>{null!=e.state.user_settings&&(u.value=e.state.user_settings)}),(0,a.sV)(()=>{_()}),{selected:l,columns:Ws,Rows:d,store:e,loading:c,filter:b,q_table:g,tableSelectable:o,user_settings:u,visibleColumns:(0,n.KR)(["host","service","ltype","data","name","info","actions"]),loadData:_,AddItem:v,InfoItem:f,EditItem:h,DeleteItem:k,deleteItems:y,handleSelectRow:C,customFilter:p,services_name_icon:Te,notes_type_icon:Xe,hosts_purpose_icon:De,hosts_osfamily_icon:Re,getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${Ds.length}`}}}},Os=(0,_e.A)(Rs,[["render",ks]]),Ts=Os;we()(Rs,"components",{QTable:ce.A,QBtn:xe.A,QToggle:Pt.A,QInput:Me.A,QIcon:Ue.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QImg:Je.A});const qs={class:"row wrap justify-end items-start content-start"};function Es(e,l,t,o,n,s){const i=(0,a.g2)("TableComponentsName"),r=(0,a.g2)("TreeSites"),d=(0,a.g2)("TableSites"),u=(0,a.g2)("InfoCard"),c=(0,a.g2)("q-splitter"),p=(0,a.g2)("q-card");return(0,a.uX)(),(0,a.Wv)(p,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",qs,[(0,a.bF)(i,{name:"web",label:"Web",icon:{name:"web",color:"indigo-13"}})]),(0,a.bF)(c,{modelValue:e.splitterModel,"onUpdate:modelValue":l[1]||(l[1]=l=>e.splitterModel=l)},{before:(0,a.k6)(()=>[(0,a.bF)(r,{model:e.site,onE_model:l[0]||(l[0]=l=>e.clickTree(l))},null,8,["model"])]),after:(0,a.k6)(()=>[(0,a.bF)(d,{model:e.site},null,8,["model"]),(0,a.bF)(u,{model:e.site},null,8,["model"])]),_:1},8,["modelValue"])]),_:1})}const Xs={key:0},Ks={key:1},Ls={key:2,align:"right"},zs={key:3};function Ns(e,l,t,o,n,s){const i=(0,a.g2)("q-checkbox"),r=(0,a.g2)("q-th"),d=(0,a.g2)("q-tr"),u=(0,a.g2)("q-toggle"),c=(0,a.g2)("q-popup-proxy"),p=(0,a.g2)("q-td"),m=(0,a.g2)("TableHostColumn"),g=(0,a.g2)("TableServiceColumn"),v=(0,a.g2)("ActionsButtons"),f=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.Wv)(f,{rows:o.Rows,columns:o.columns,"row-key":"id",ref:"q_table",class:(0,b.C4)(["split"==o.user_settings.main_layout?"my-sticky-header-table":"my-sticky-header-table-single"]),"selected-rows-label":o.getSelectedString,selection:"multiple",dense:"",selected:o.selected,"onUpdate:selected":l[1]||(l[1]=e=>o.selected=e),onSelection:o.handleSelectRow,loading:o.loading,filter:o.filter,"visible-columns":o.visibleColumns,"filter-method":o.customFilter},{header:(0,a.k6)(e=>[(0,a.bF)(d,{props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(r,{key:0,align:"left"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,l=>((0,a.uX)(),(0,a.Wv)(r,{key:l.name,props:e},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),(0,a.bF)(c,{"context-menu":""},{default:(0,a.k6)(()=>[l[2]||(l[2]=(0,a.Lk)("div",{align:"center"},"Visible Columns",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(u,{modelValue:o.visibleColumns,"onUpdate:modelValue":l[0]||(l[0]=e=>o.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])]))),256))]),_:1})]),body:(0,a.k6)(e=>[0!=e.row.port?((0,a.uX)(),(0,a.Wv)(d,{key:0,props:e},{default:(0,a.k6)(()=>[1==o.tableSelectable?((0,a.uX)(),(0,a.Wv)(p,{key:0},{default:(0,a.k6)(()=>[(0,a.bF)(i,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols.filter(e=>"desc"!==e.name),l=>((0,a.uX)(),(0,a.Wv)(p,{key:l.name,align:"center"},{default:(0,a.k6)(()=>["host"==l.name?((0,a.uX)(),(0,a.CE)("div",Xs,[(0,a.bF)(m,{model:l.value},null,8,["model"])])):"service"==l.name?((0,a.uX)(),(0,a.CE)("div",Ks,[(0,a.bF)(g,{model:l.value},null,8,["model"])])):"actions"==l.name?((0,a.uX)(),(0,a.CE)("div",Ls,[(0,a.bF)(v,{onE_edit_click:l=>o.EditItem(e.row),onE_delete_click:l=>o.DeleteItem(e.row),onE_info_click:l=>o.InfoItem(e.row)},null,8,["onE_edit_click","onE_delete_click","onE_info_click"])])):((0,a.uX)(),(0,a.CE)("div",zs,(0,b.v_)(l.value),1))]),_:2},1024))),128))]),_:2},1032,["props"])):(0,a.Q3)("",!0)]),_:1},8,["rows","columns","class","selected-rows-label","selected","onSelection","loading","filter","visible-columns","filter-method"])}const Ps={class:"q-pa-md"},Ms={class:"text-h6"};function Us(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-label"),v=(0,a.g2)("q-img"),f=(0,a.g2)("SelectWithIPFilter"),_=(0,a.g2)("SelectWithServicesFilter"),k=(0,a.g2)("q-input"),y=(0,a.g2)("q-card-actions"),h=(0,a.g2)("q-card"),C=(0,a.g2)("q-dialog"),F=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(C,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[10]||(l[10]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[F]])]),_:1}),(0,a.Lk)("div",Ps,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"xl"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"language"})]),_:1}),(0,a.Lk)("div",Ms,(0,b.v_)(o.CardName),1)]),_:1}),"InfoItem"==o.CardAction?((0,a.uX)(),(0,a.Wv)(m,{key:0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"cloud",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[11]||(l[11]=[(0,a.eW)("IP-адрес:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.host.address),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(v,{src:o.services_name_icon(o.CardData.service.name),style:{width:"36px",height:"36px","padding-right":"5px"}},null,8,["src"]),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[12]||(l[12]=[(0,a.eW)("Служба:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.service.name),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"language",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[13]||(l[13]=[(0,a.eW)("Note Type:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.vhost),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"article",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[14]||(l[14]=[(0,a.eW)("Note Type:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.options),1)]),_:1})])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.bF)(c,{name:"description",size:"md",color:"grey",style:{"padding-right":"5px"}}),(0,a.bF)(g,{class:"text-subtitle1 text-bold",style:{"padding-right":"5px"}},{default:(0,a.k6)(()=>[...l[15]||(l[15]=[(0,a.eW)("Note Type:",-1)])]),_:1}),(0,a.bF)(g,{class:"text-body1"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CardData.comments),1)]),_:1})])])]),_:1})):((0,a.uX)(),(0,a.Wv)(m,{key:1},{default:(0,a.k6)(()=>[(0,a.bF)(f,{modelValue:o.CardData.host,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.host=e),ref:"ipRef",rules:o.ipRules,selectOptions:o.SelectOptionsName,label:"IP-адрес",hint:"Text"},null,8,["modelValue","rules","selectOptions"]),(0,a.bF)(_,{modelValue:o.CardData.service,"onUpdate:modelValue":l[3]||(l[3]=e=>o.CardData.service=e),affectValue:o.CardData.host,label:"Служба",hint:"Text",isMultiple:o.isMultiple,onE_model:l[4]||(l[4]=e=>o.CardData.service=e)},null,8,["modelValue","affectValue","isMultiple"]),(0,a.bF)(k,{filled:"",modelValue:o.CardData.vhost,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.vhost=e),label:"Vitrual Host",hint:o.TypeData,"lazy-rules":""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"language"})]),_:1},8,["modelValue","hint"]),(0,a.bF)(k,{filled:"",modelValue:o.CardData.options,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.options=e),label:"Опции",hint:o.TypeData,"lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1},8,["modelValue","hint"]),(0,a.bF)(k,{filled:"",modelValue:o.CardData.comments,"onUpdate:modelValue":l[7]||(l[7]=e=>o.CardData.comments=e),label:"Коментарии",hint:o.TypeData,"lazy-rules":"",autogrow:""},{before:(0,a.k6)(()=>[(0,a.bF)(c,{name:"description"})]),_:1},8,["modelValue","hint"])]),_:1}))]),(0,a.bF)(y,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const js={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{SelectWithIPFilter:mt,SelectWithServicesFilter:Ka},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)("Text"),b=(0,n.KR)(!0),g=(0,n.KR)(e.CardAction),v=(0,n.KR)(e.CardName),f=(0,n.KR)(e.CardData);function _(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}async function k(){var e=(0,m.y)("table","Services","getUnicName"),l=await(0,i.b)(e,null,u.state.current_user.token);if(void 0!=l&&0!=l&&200==l.status){l.data.map(function(e){var l="";return null!=e.name&&(l=e.name),{value:e.name,label:l}})}}async function y(e){var l=(0,m.y)("table","Web","editSite"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(1==f.value.status&&(f.value.id=a.id,f.value.host=a.host,f.value.updated_at=a.updated_at),o(f.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function h(e){var l=(0,m.y)("table","Web","addSite"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(f.value.id=a.id,o(f.value),(0,Ie.e)(d,"positive","Запись добавлена","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}function C(){d.dialog({component:Tags,componentProps:{selected_hosts:f.value,original_call:"Add"}}).onOk(e=>{f.value.tags=e.row.value.tags})}function F(e){let l=e;return"object"==typeof l&&(l=e.address),!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(l)}return(0,a.KC)(()=>{b.value=!1,c.value=k()}),(0,a.wB)(()=>f.value.data,()=>{p.value=_(f.value.data)}),{dialogRef:l,SelectOptionsName:c,TypeData:p,isMultiple:b,CardAction:g,CardName:v,CardData:f,maximizedToggle:(0,n.KR)(!1),ipRef:(0,n.KR)(null),ipRules:[e=>null!=e&&1==F(e)||"Not valid IP-address"],Add:h,Edit:y,showTagDialog:C,onOKClick(){"AddItem"==g.value?h(JSON.stringify(f.value)):"EditItem"==g.value&&y(JSON.stringify(f.value))},onCancelClick:r,notes_type_icon:Xe,services_name_icon:Te}}},Bs=(0,_e.A)(js,[["render",Us]]),Js=Bs;we()(js,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QImg:Je.A,QInput:Me.A,QCardActions:Fe.A}),we()(js,"directives",{ClosePopup:al.A});const Hs=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"host",align:"center",label:"IP",field:"host",sortable:!0,sort:(e,l,t,a,o)=>d(e,l,o)},{name:"service",align:"center",label:"Служба",field:"service",sortable:!0,sort:(e,l,t,a,o)=>u(e,l,o)},{name:"vhost",align:"center",label:"Virtual host",field:"vhost",sortable:!0},{name:"comments",align:"center",label:"Комментарий",field:"comments",sortable:!0},{name:"options",align:"center",label:"Опции",field:"options",sortable:!0},{name:"forms",align:"center",label:"Формы",field:"forms",sortable:!0},{name:"pages",align:"center",label:"Страницы",field:"pages",sortable:!0},{name:"vulns",align:"center",label:"Уязвимости",field:"vulns",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],$s=[],Gs={name:"TableForms",components:{TableHostColumn:Xt,TableServiceColumn:$a,ActionsButtons:Kt.A,DownloadButtonMenu:xt.A},props:{model:{type:Object,default:null}},setup(e,{emit:l}){const t=(0,n.KR)(e.model),o=(0,s.Pj)(),r=(0,n.KR)([]),d=(0,pe.A)(),u=(0,n.KR)(!1),c=(0,n.KR)([]),b=(0,n.KR)([...$s]),g=(0,n.KR)([...Hs]),v=(0,n.KR)(o.state.current_tree_node),f=(0,n.KR)(o.state.user_settings),_=(0,n.KR)(!0),k=(0,n.KR)(!1),y=(0,n.KR)(""),h=(0,n.KR)(null);function C(){d.dialog({component:Js,componentProps:{CardAction:"AddItem",CardName:"Add Site",CardData:{host:{id:null,address:"",puprose:"",os_family:""},service:null,vhost:"",options:"",comments:""}}}).onOk(e=>{b.value.push(e)})}function F(e){d.dialog({component:Js,componentProps:{CardAction:"InfoItem",CardName:"Information",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{})}function x(){var e=JSON.parse(JSON.stringify(r.value));d.dialog({component:EditServicesValue,componentProps:{selected_items:e.map(e=>e.id),columns:c}}).onOk(e=>{e.row_temp.id.forEach(l=>{const t=b.value.findIndex(e=>e.id==l);t>-1&&e.row_temp.data.forEach(e=>{Object.keys(b.value[t]).forEach(l=>{l===e["column"]&&(b.value[t][l]=e["value"])})}),o.commit("SET_EVENT_HOST",{event:"edit_host",data:b.value[t]})})})}async function A(e){k.value=!0;var l=(0,m.y)("table","Web","getSites"),t={workspace:o.state.current_project,data:e},a=await(0,i.L)(l,t,null,o.state.current_user.token);void 0!=a&&a&&0==a.hasOwnProperty("message")||Array.isArray(1==a)?(b.value=a,k.value=!1):(k.value=!1,a.hasOwnProperty("message")&&(0,Ie.e)(d,"negative","Error",a.message,"report_problem"))}async function w(e){var l=(0,m.y)("table","Services","delItem"),t={workspace:o.state.current_project,data:e.id},a=await(0,i.L)(l,t,null,o.state.current_user.token);void 0!=a&&0!=a?(200==a.status&&(b.value=b.value.filter(l=>l.id!==e),r.value=r.value.filter(l=>l.id!=e.id)),(0,Ie.e)(d,"positive","Запись удалена","","done")):(0,Ie.e)(d,"negative","Error",a.message,"report_problem")}function S(){for(var e=r.value.filter(e=>e.id),l=0;l<e.length;l++)w(e[l])}function V(e){d.dialog({component:Js,componentProps:{CardAction:"EditItem",CardName:"Edit Site",CardData:JSON.parse(JSON.stringify(e))}}).onOk(e=>{if(void 0!=e){const l=b.value.findIndex(l=>l.id==e.id);l>-1&&(b.value[l]=e)}})}function Q(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function I(){}function W(e){r.value=e.rows}function D(){o.commit("SET_CURRENT_TAB","services")}return(0,a.nT)(()=>{t.value=e.model,null!=t.value&&t.value.hasOwnProperty("site_id")&&A({site_id:t.value.site_id})}),(0,a.wB)(()=>o.state.user_settings,()=>{null!=o.state.user_settings&&(f.value=o.state.user_settings)}),(0,a.sV)(()=>{}),{selected:r,columns:Hs,Rows:b,store:o,tableSelectable:u,Columns:g,loadData:A,AddItem:C,InfoItem:F,deleteItems:S,EditItem:V,drawChip:Q,DeleteItem:w,set_current_tab:D,services_name_icon:Te,hosts_osfamily_icon:Re,hosts_purpose_icon:De,current_tree_node:v,chiphost:_,user_settings:f,removeChip:I,loadData:A,loading:k,handleSelectRow:W,customFilter:p,filter:y,q_table:h,editservicesvalue_show:x,selection_edititems:c,visibleColumns:(0,n.KR)(["host","service","vhost","comments","options","actions"]),getSelectedString(){return 0===r.value.length?"":`${r.value.length} record${r.value.length>1?"s":""} selected of ${$s.length}`}}}},Ys=(0,_e.A)(Gs,[["render",Ns]]),Zs=Ys;we()(Gs,"components",{QTable:ce.A,QBtn:xe.A,QToggle:Pt.A,QInput:Me.A,QIcon:Ue.A,QTr:Mt.A,QTh:Ut.A,QCheckbox:Be.A,QPopupProxy:jt.A,QTd:Bt.A,QChip:$l.A});const ei={class:"tree_margin"},li={key:1,class:"",style:{display:"inline-block"}},ti={key:0},ai={key:0},oi={class:"text-caption grey-6"},ni={key:1},si={class:"text-caption text-grey"},ii={key:1},ri={key:0},di={class:"text-caption text-grey"},ui={key:2},ci={key:0},pi={class:"text-caption text-grey"},mi={key:3},bi={key:0},gi={class:"text-caption text-grey"};function vi(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("q-icon"),d=(0,a.g2)("q-input"),u=(0,a.g2)("q-checkbox"),c=(0,a.g2)("q-img"),p=(0,a.g2)("q-item-section"),m=(0,a.g2)("q-item-label"),g=(0,a.g2)("q-item"),v=(0,a.g2)("q-separator"),f=(0,a.g2)("q-list"),_=(0,a.g2)("q-menu"),k=(0,a.g2)("q-tree"),y=(0,a.g2)("q-scroll-area"),h=(0,a.gN)("ripple"),C=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(y,{style:{height:"calc(100vh - 50px)"}},{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.bF)(i,{color:"green",icon:"add",label:"","no-caps":"",size:"xs",class:"button-top",onClick:e.AddItem},null,8,["onClick"]),(0,a.bF)(i,{color:"blue",icon:"refresh",label:"","no-caps":"",size:"xs",class:"button-top",onClick:l[0]||(l[0]=l=>e.loadData())})]),(0,a.bF)(d,{borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":l[1]||(l[1]=l=>e.filter=l),ref:"filterRef",placeholder:"Поиск"},{append:(0,a.k6)(()=>[(0,a.bF)(r,{name:"search"})]),_:1},8,["modelValue"]),(0,a.Lk)("div",ei,[(0,a.bF)(k,{nodes:e.Items,"no-transition":"",ref:"treeRef","node-key":"id",filter:e.filter,"default-expand-all":"","filter-method":e.myFilterMethod,"selected-color":"primary",selected:e.selected,"onUpdate:selected":[l[2]||(l[2]=l=>e.selected=l),l[4]||(l[4]=l=>e.handleSelectItem(e.selected))],expanded:e.expanded,"onUpdate:expanded":l[3]||(l[3]=l=>e.expanded=l),onLazyLoad:e.onLazyLoad,dense:""},{"default-header":(0,a.k6)(({node:t})=>[1==e.f_ticked?((0,a.uX)(),(0,a.Wv)(u,{key:0,modelValue:t.ticked,"onUpdate:modelValue":e=>t.ticked=e,onClick:l=>e.sel_ticked(t),size:"xs"},null,8,["modelValue","onUpdate:modelValue","onClick"])):(0,a.Q3)("",!0),1==e.user_settings.display_icon_tree_hosts?((0,a.uX)(),(0,a.CE)("div",li,["site"==t.type?((0,a.uX)(),(0,a.CE)("div",ti,[(0,a.bF)(r,{name:"language",class:"node_icon"}),(0,a.eW)(" "+(0,b.v_)(t.label)+" ",1),null!=t.comments?((0,a.uX)(),(0,a.CE)("div",ai,[(0,a.Lk)("span",oi,(0,b.v_)(t.comments),1)])):(0,a.Q3)("",!0),0!=t.pages||0!=t.forms||0!=t.vulns?((0,a.uX)(),(0,a.CE)("div",ni,[(0,a.Lk)("span",si,"Pages "+(0,b.v_)(t.pages)+", Forms "+(0,b.v_)(t.forms)+", Vulns "+(0,b.v_)(t.vulns),1)])):(0,a.Q3)("",!0)])):"directory"==t.type?((0,a.uX)(),(0,a.CE)("div",ii,[(0,a.bF)(c,{src:"icons/directory.png",class:"node_icon"}),(0,a.eW)(" "+(0,b.v_)(t.name)+" ",1),null!=t.comment?((0,a.uX)(),(0,a.CE)("div",ri,[(0,a.Lk)("span",di,(0,b.v_)(t.comment.comment),1)])):(0,a.Q3)("",!0)])):"file"==t.type||"vuln"==t.type?((0,a.uX)(),(0,a.CE)("div",ui,[(0,a.bF)(c,{src:e.web_type_icon(t.name),class:"node_icon"},null,8,["src"]),(0,a.eW)(" "+(0,b.v_)(t.name)+" ",1),null!=t.comment?((0,a.uX)(),(0,a.CE)("div",ci,[(0,a.Lk)("span",pi,(0,b.v_)(t.comment.comment),1)])):(0,a.Q3)("",!0)])):"form"==t.type?((0,a.uX)(),(0,a.CE)("div",mi,[(0,a.bF)(r,{name:"settings",class:"node_icon"}),(0,a.eW)(" "+(0,b.v_)(t.name)+" ",1),null!=t.comment?((0,a.uX)(),(0,a.CE)("div",bi,[(0,a.Lk)("span",gi,(0,b.v_)(t.comment.comment),1)])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),t.creds>0&&1==e.user_settings.display_icon_tree_creds?((0,a.uX)(),(0,a.Wv)(r,{key:2,color:"green",name:"check"})):(0,a.Q3)("",!0),(0,a.bF)(_,{"touch-position":"","context-menu":""},{default:(0,a.k6)(()=>[(0,a.bF)(f,{dense:"",style:{"min-width":"100px"}},{default:(0,a.k6)(()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:l=>e.add_node(t)},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{name:"add"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[5]||(l[5]=[(0,a.eW)("Добавить",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[h],[C]]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:"",onClick:l=>e.context_refresh(t)},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{name:"refresh"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Обновить",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[C]]),"site"!=t.type?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:0,clickable:"",onClick:l=>e.add_comment(t)},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{name:"comment"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Комментарий",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[C]]):(0,a.Q3)("",!0),"site"!=t.type?(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{key:1,clickable:"",onClick:l=>e.delete_node(t)},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{name:"delete"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Удалить",-1)])]),_:1})]),_:1})]),_:1},8,["onClick"])),[[C]]):(0,a.Q3)("",!0),(0,a.bF)(v),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(g,{clickable:""},{default:(0,a.k6)(()=>[(0,a.bF)(p,{side:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{name:"exit_to_app"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Выход",-1)])]),_:1})]),_:1})]),_:1})),[[C]])]),_:2},1024)]),_:2},1024)]),_:1},8,["nodes","filter","filter-method","selected","expanded","onLazyLoad"])])]),_:1})}const fi={class:"q-pa-md"},_i={class:"text-h6"},ki={key:0},yi={key:1},hi={key:2};function Ci(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-radio"),g=(0,a.g2)("q-card-section"),v=(0,a.g2)("q-input"),f=(0,a.g2)("q-select"),_=(0,a.g2)("q-card-actions"),k=(0,a.g2)("q-card"),y=(0,a.g2)("q-dialog"),h=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(y,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(k,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[30]||(l[30]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[31]||(l[31]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[32]||(l[32]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[h]])]),_:1}),(0,a.Lk)("div",fi,[(0,a.bF)(g,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"md"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1}),(0,a.Lk)("div",_i,(0,b.v_)(o.CardName)+" "+(0,b.v_)(o.TypeCard),1),(0,a.Lk)("div",null,[(0,a.bF)(m,{modelValue:o.TypeCard,"onUpdate:modelValue":l[2]||(l[2]=e=>o.TypeCard=e),disable:o.DisableState,val:"Page",label:"Page",color:"teal"},null,8,["modelValue","disable"]),(0,a.bF)(m,{modelValue:o.TypeCard,"onUpdate:modelValue":l[3]||(l[3]=e=>o.TypeCard=e),disable:o.DisableState,val:"Form",label:"Form",color:"deep-orange"},null,8,["modelValue","disable"]),(0,a.bF)(m,{modelValue:o.TypeCard,"onUpdate:modelValue":l[4]||(l[4]=e=>o.TypeCard=e),disable:o.DisableState,val:"Vuln",label:"Vuln",color:"black"},null,8,["modelValue","disable"])])]),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)(()=>["Page"==o.TypeCard?((0,a.uX)(),(0,a.CE)("div",ki,[(0,a.bF)(v,{filled:"",modelValue:o.CardData.fullpath,"onUpdate:modelValue":l[5]||(l[5]=e=>o.CardData.fullpath=e),disable:o.DisableState,label:"Полный путь",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","disable","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.query,"onUpdate:modelValue":l[6]||(l[6]=e=>o.CardData.query=e),label:"Параметры запроса",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.code,"onUpdate:modelValue":l[7]||(l[7]=e=>o.CardData.code=e),label:"Код ответа",hint:o.TypeData,type:"number","lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.cookie,"onUpdate:modelValue":l[8]||(l[8]=e=>o.CardData.cookie=e),label:"Cookie",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.auth,"onUpdate:modelValue":l[9]||(l[9]=e=>o.CardData.auth=e),label:"Параметры аутентификации",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.ctype,"onUpdate:modelValue":l[10]||(l[10]=e=>o.CardData.ctype=e),label:"Тип контента",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.request,"onUpdate:modelValue":l[11]||(l[11]=e=>o.CardData.request=e),label:"Запрос",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.headers,"onUpdate:modelValue":l[12]||(l[12]=e=>o.CardData.headers=e),label:"Заголовки",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.body,"onUpdate:modelValue":l[13]||(l[13]=e=>o.CardData.body=e),label:"Тело ответа",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"])])):(0,a.Q3)("",!0),"Form"==o.TypeCard?((0,a.uX)(),(0,a.CE)("div",yi,[(0,a.bF)(v,{filled:"",modelValue:o.CardData.fullpath,"onUpdate:modelValue":l[14]||(l[14]=e=>o.CardData.fullpath=e),disable:o.DisableState,label:"Полный путь",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","disable","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.query,"onUpdate:modelValue":l[15]||(l[15]=e=>o.CardData.query=e),label:"Параметры запроса",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(f,{filled:"",modelValue:o.CardData.method,"onUpdate:modelValue":l[16]||(l[16]=e=>o.CardData.method=e),label:"HTTP Метод",options:o.options,hint:o.TypeData},null,8,["modelValue","options","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.params,"onUpdate:modelValue":l[17]||(l[17]=e=>o.CardData.params=e),label:"Параметры",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"])])):(0,a.Q3)("",!0),"Vuln"==o.TypeCard?((0,a.uX)(),(0,a.CE)("div",hi,[(0,a.bF)(v,{filled:"",modelValue:o.CardData.fullpath,"onUpdate:modelValue":l[18]||(l[18]=e=>o.CardData.fullpath=e),disable:o.DisableState,label:"Полный путь",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","disable","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.name,"onUpdate:modelValue":l[19]||(l[19]=e=>o.CardData.name=e),label:"Наименование",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.query,"onUpdate:modelValue":l[20]||(l[20]=e=>o.CardData.query=e),label:"Параметры запроса",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(f,{filled:"",modelValue:o.CardData.method,"onUpdate:modelValue":l[21]||(l[21]=e=>o.CardData.method=e),label:"HTTP Метод",options:o.options,hint:o.TypeData},null,8,["modelValue","options","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.params,"onUpdate:modelValue":l[22]||(l[22]=e=>o.CardData.params=e),label:"Параметры",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.risk,"onUpdate:modelValue":l[23]||(l[23]=e=>o.CardData.risk=e),label:"Индекс риска (0-10)",hint:o.TypeData,type:"number","lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.category,"onUpdate:modelValue":l[24]||(l[24]=e=>o.CardData.category=e),label:"Категория",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.confidence,"onUpdate:modelValue":l[25]||(l[25]=e=>o.CardData.confidence=e),label:"Достоверность (0-100)",hint:o.TypeData,type:"number","lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.description,"onUpdate:modelValue":l[26]||(l[26]=e=>o.CardData.description=e),label:"Описание",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.request,"onUpdate:modelValue":l[27]||(l[27]=e=>o.CardData.request=e),label:"Запрос",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.proof,"onUpdate:modelValue":l[28]||(l[28]=e=>o.CardData.proof=e),label:"Доказательство",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"]),(0,a.bF)(v,{filled:"",modelValue:o.CardData.payload,"onUpdate:modelValue":l[29]||(l[29]=e=>o.CardData.payload=e),label:"Полезная нагрузка",hint:o.TypeData,"lazy-rules":""},null,8,["modelValue","hint"])])):(0,a.Q3)("",!0)]),_:1})]),(0,a.bF)(_,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Fi={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)("Text"),b=(0,n.KR)(!0),g=(0,n.KR)("Page"),v=(0,n.KR)(!1),f=(0,n.KR)(e.CardAction),_=(0,n.KR)(e.CardName),k=(0,n.KR)(e.CardData);async function y(e){var l=(0,m.y)("table","Web",`edit${g.value}`),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(1==k.value.status&&(k.value.id=a.id,k.value.host=a.host,k.value.updated_at=a.updated_at),o(k.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function h(e){var l=(0,m.y)("table","Web","addInfo"),t={site_id:k.value.site_id,type:g.value,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(o(k.value),(0,Ie.e)(d,"positive","Запись добавлена","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}return(0,a.KC)(()=>{b.value=!1,"AddItem"==f.value&&(k.value.method="GET",k.value.risk=0,k.value.confidence=0,k.value.category="web",k.value.proof=""),"EditItem"==f.value&&(k.value.fullpath=k.value.path,v.value=!0,g.value=k.value.type)}),(0,a.wB)(()=>k.value.data,()=>{}),{dialogRef:l,SelectOptionsName:c,TypeData:p,isMultiple:b,CardAction:f,CardName:_,CardData:k,TypeCard:g,maximizedToggle:(0,n.KR)(!1),options:["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"],DisableState:v,Add:h,Edit:y,onOKClick(){"AddItem"==f.value?h(JSON.stringify(k.value)):"EditItem"==f.value&&y(JSON.stringify(k.value))},onCancelClick:r,notes_type_icon:Xe}}},xi=(0,_e.A)(Fi,[["render",Ci]]),Ai=xi;we()(Fi,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QRadio:Mo.A,QInput:Me.A,QSelect:Ce.A,QCardActions:Fe.A}),we()(Fi,"directives",{ClosePopup:al.A});const wi={class:"q-pa-md"},Si={class:"text-h6"};function Vi(e,l,t,o,n,s){const i=(0,a.g2)("q-space"),r=(0,a.g2)("q-tooltip"),d=(0,a.g2)("q-btn"),u=(0,a.g2)("q-bar"),c=(0,a.g2)("q-icon"),p=(0,a.g2)("q-avatar"),m=(0,a.g2)("q-card-section"),g=(0,a.g2)("q-input"),v=(0,a.g2)("q-card-actions"),f=(0,a.g2)("q-card"),_=(0,a.g2)("q-dialog"),k=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(_,{ref:"dialogRef",maximized:o.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.k6)(()=>[(0,a.bF)(f,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(i),(0,a.bF)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>o.maximizedToggle=!1),disable:!o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[3]||(l[3]=[(0,a.eW)("Minimize",-1)])]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["disable"]),(0,a.bF)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>o.maximizedToggle=!0),disable:o.maximizedToggle},{default:(0,a.k6)(()=>[o.maximizedToggle?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(r,{key:0,class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[4]||(l[4]=[(0,a.eW)("Maximize",-1)])]),_:1}))]),_:1},8,["disable"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"bg-white text-primary"},{default:(0,a.k6)(()=>[...l[5]||(l[5]=[(0,a.eW)("Close",-1)])]),_:1})]),_:1})),[[k]])]),_:1}),(0,a.Lk)("div",wi,[(0,a.bF)(m,{class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{size:"md"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{name:"article"})]),_:1}),(0,a.Lk)("div",Si,[(0,a.eW)((0,b.v_)(o.CardName)+" ",1),l[6]||(l[6]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" "+(0,b.v_)(o.CardData.fullpath),1)])]),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)(()=>[(0,a.bF)(g,{filled:"",modelValue:o.CardData.comment.comment,"onUpdate:modelValue":l[2]||(l[2]=e=>o.CardData.comment.comment=e),label:"Коментарии",hint:o.TypeData,"lazy-rules":"",autogrow:""},null,8,["modelValue","hint"])]),_:1})]),(0,a.bF)(v,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{color:"green",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.bF)(d,{color:"red",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["maximized"])}const Qi={props:{CardAction:{type:String,default:null},CardName:{type:String,default:null},CardData:{type:Object,default:null}},components:{},emits:[...ge.A.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:r}=(0,ge.A)(),d=(0,pe.A)(),u=(0,s.Pj)(),c=(0,n.KR)([]),p=(0,n.KR)("Text"),b=(0,n.KR)(!0),g=(0,n.KR)(e.CardAction),v=(0,n.KR)(e.CardName),f=(0,n.KR)(e.CardData);async function _(e){var l=(0,m.y)("table","Web","editComment"),t={workspace:u.state.current_project,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(f.value.comment={id:a.id,comment:f.value.comment.comment},o(f.value),(0,Ie.e)(d,"positive","Запись отредактирована","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}async function k(e){var l=(0,m.y)("table","Web","addComment"),t={site_id:f.value.site_id,data:e},a=await(0,i.L)(l,t,null,u.state.current_user.token);void 0!=a&&0!=a&&(200==a.status?(f.value.comment={id:a.id,comment:f.value.comment.comment},o(f.value),(0,Ie.e)(d,"positive","Запись добавлена","","done")):(0,Ie.e)(d,"negative","Ошибка",a.message,"report_problem"))}return(0,a.KC)(()=>{b.value=!1,null==f.value.comment&&(f.value.comment={id:null,comment:null})}),(0,a.wB)(()=>f.value.data,()=>{}),{dialogRef:l,SelectOptionsName:c,TypeData:p,isMultiple:b,CardAction:g,CardName:v,CardData:f,maximizedToggle:(0,n.KR)(!1),Add:k,Edit:_,onOKClick(){"AddItem"==g.value?k(JSON.stringify(f.value)):"EditItem"==g.value&&_(JSON.stringify(f.value))},onCancelClick:r,notes_type_icon:Xe}}},Ii=(0,_e.A)(Qi,[["render",Vi]]),Wi=Ii;we()(Qi,"components",{QDialog:ke.A,QCard:ye.A,QBar:tt.A,QSpace:at.A,QBtn:xe.A,QTooltip:He.A,QCardSection:ot.A,QAvatar:nt.A,QIcon:Ue.A,QInput:Me.A,QCardActions:Fe.A}),we()(Qi,"directives",{ClosePopup:al.A});const Di=(0,a.pM)({name:"TreeSites",components:{AddEditItem:Js,AddEditItemCard:Ai},props:{},setup(e,{emit:l}){const t=(0,s.Pj)(),o=(0,pe.A)(),d=(0,n.KR)(null),u=(0,n.KR)(!1),c=(0,n.KR)([]),p=(0,n.KR)(t.state.user_settings),b=(0,n.KR)(0),g=(0,n.KR)("");async function v(){u.value=!0;var e=(0,m.y)("table","Web","getSites"),l={workspace:t.state.current_project,data:r(t.state.current_tree_node)},a=await(0,i.L)(e,l,null,t.state.current_user.token);void 0!=a&&a&&0==a.hasOwnProperty("message")||Array.isArray(1==a)?(c.value=[],a.forEach(e=>{let l=`${e.service.name}://${e.vhost}:${e.service.port}`;null!=e.service&&"object"==typeof e.service&&null!=e.service.name&&(l=`${e.service.name}://${e.vhost}:${e.service.port}`),c.value.push({id:b.value,label:l,site_id:e.id,comments:e.comments,type:"site",pages:e.pages,forms:e.forms,vulns:e.vulns,lazy:!0,children:[]}),b.value+=1}),u.value=!1):(u.value=!1,a.hasOwnProperty("message")&&(0,Ie.e)(o,"negative","Error",a.message,"report_problem"))}async function f(e){u.value=!0;var l=e.site_id,a=(0,m.y)("table","Web","getSiteStruct"),n={workspace:t.state.current_project,site_id:e.site_id},s=await(0,i.L)(a,n,null,t.state.current_user.token);return void 0!=s&&s&&0==s.hasOwnProperty("message")||Array.isArray(1==s)?(s.forEach(e=>{e.site_id=l,x(e,b,l)}),s):(u.value=!1,s.hasOwnProperty("message")&&(0,Ie.e)(o,"negative","Error",s.message,"report_problem"),[])}function _(){o.dialog({component:Js,componentProps:{CardAction:"AddItem",CardName:"Add Site",CardData:{host:{id:null,address:"",puprose:"",os_family:""},service:null,vhost:"",options:"",comments:""}}}).onOk(e=>{e.id=b.value+1,c.value.push(e),b.value+=1})}async function k(e){var l=[];l=await f(e),l.length>0&&("host"!=e.type?e.children=l:e=l[0])}async function y(e){o.dialog({component:Ai,componentProps:{CardAction:"AddItem",CardName:"Add ",CardData:{fullpath:e.fullpath,type:e.type,site_id:e.site_id}}}).onOk(e=>{e&&w(e.site_id,e.fullpath)})}async function h(e){var l=(0,m.y)("table","Web","delPath"),a={workspace:t.state.current_project,site_id:e.site_id,path:e.fullpath},n=await(0,i.L)(l,a,null,t.state.current_user.token);if(void 0!=n&&n&&0==n.hasOwnProperty("message")&&200==n.status){const l=K(c.value,e.id);l&&l.parentArray.splice(l.index,1)}else n.hasOwnProperty("message")&&(0,Ie.e)(o,"negative","Error",n.message,"report_problem")}async function C(e){var l=JSON.parse(JSON.stringify({comment:e.comment,fullpath:e.fullpath,type:e.type,site_id:e.site_id}));o.dialog({component:Wi,componentProps:{CardAction:"AddItem",CardName:"Comment",CardData:l}}).onOk(l=>{e.comment=l.comment})}async function F({node:e,key:l,done:t,fail:a}){var o=[];o=await f(e),t(o)}function x(e,l,t){if(e.id=l.value++,e.site_id=t,l.value+=1,e.children&&e.children.length>0)for(const a of e.children)x(a,l,t)}function A(e){if(null==e);else{var t=JSON.parse(JSON.stringify(L(c.value,e)));l("e_model",t),delete t.children}}(0,a.wB)(()=>t.state.current_tree_node,()=>{c.value=[],v()}),(0,a.KC)(()=>{v()});const w=(e,l)=>{if(!e)return void(0,Ie.e)(o,"negative","Error","site_id is null","report_problem");if(!l||"string"!==typeof l)return void(0,Ie.e)(o,"negative","Error","Incorrect path","report_problem");const t=S(l),a=V(e);if(!a)return void(0,Ie.e)(o,"negative","Error",`Site site_id=${e} not found`,"report_problem");const n=Q(a,t);return n},S=e=>{let l=e.trim();return l=l.replace(/\/+/g,"/"),"/"!==l&&l.endsWith("/")&&(l=l.slice(0,-1)),l.startsWith("/")||(l="/"+l),l},V=e=>c.value.find(l=>l.site_id===e),Q=(e,l)=>{try{const t=I(e),a=l.split("/").filter(e=>""!==e);return 0===a.length?((0,Ie.e)(o,"negative","Error","The path cannot be empty","report_problem"),!1):(W(t,a,l,e.site_id),!0)}catch(e){return(0,Ie.e)(o,"negative","Error",`${e.message}`,"report_problem"),!1}},I=e=>{e.children||(e.children=[]);let l=e.children.find(e=>"/"===e.fullpath);return l||(l={code:null,comment:{comment:"",id:X(),path:"/"},fullpath:"/",id:X(),name:"/",site_id:e.site_id,type:"directory",children:[]},e.children.unshift(l)),l},W=(e,l,t,a)=>{let o=e,n=e.fullpath;for(let e=0;e<l.length;e++){const s=l[e],i=e===l.length-1,r=D(s,t,i),d="/"===n?`/${s}`:`${n}/${s}`;let u=R(o,d);if(u)q(u,r),console.log(`Узел уже существует: ${d}`);else{const e=O(s,d,r,a);T(o,e),u=e,console.log(`Создан новый узел: ${d} (тип: ${r})`)}n=d,i?"vuln"===u.type&&(u.children=void 0):(u.children||"vuln"===u.type||(u.children=[]),o=u)}},D=(e,l,t)=>g.value.endsWith("/")?"directory":t&&e.includes(".")?"vuln":"directory",R=(e,l)=>e.children&&0!==e.children.length?e.children.find(e=>e.fullpath===l):null,O=(e,l,t,a)=>{const o=X(),n={code:null,comment:null,fullpath:l,id:o,name:e,site_id:a,type:t};return"vuln"===t?n:{...n,children:[]}},T=(e,l)=>{e.children||(e.children=[]);const t=e.children.find(e=>e.fullpath===l.fullpath);t||(e.children.push(l),e.children.sort((e,l)=>e.type===l.type?e.name.localeCompare(l.name):"directory"===e.type?-1:1))},q=(e,l)=>{"vuln"===e.type&&"directory"===l&&(e.type="directory",e.children||(e.children=[])),"directory"===e.type&&"vuln"===l&&(e.type="vuln",e.children=void 0)};let E=1e3;const X=()=>++E;function K(e,l,t=null){for(let a=0;a<e.length;a++){if(e[a].id===l)return{parentArray:e,index:a,parentNode:t};if(e[a].children){const t=K(e[a].children,l,e[a]);if(t)return t}}return null}function L(e,l){let t=null;function a(e){return e.id===l?(t=e,!0):Array.isArray(e.children)&&e.children.some(a)}return e.some(a),t}return{selected:d,loading:u,Items:c,user_settings:p,last_index:b,newPath:g,AddItem:_,loadData:v,context_refresh:k,add_node:y,delete_node:h,add_comment:C,onLazyLoad:F,assignIdsToTree:x,handleSelectItem:A,findNodeByID:L,web_type_icon:Le}}}),Ri=(0,_e.A)(Di,[["render",vi]]),Oi=Ri;function Ti(e,l,t,o,n,s){const i=(0,a.g2)("q-badge"),r=(0,a.g2)("q-tab"),d=(0,a.g2)("q-tabs"),u=(0,a.g2)("q-separator"),c=(0,a.g2)("PageCard"),p=(0,a.g2)("q-tab-panel"),m=(0,a.g2)("FormCard"),g=(0,a.g2)("VulnCard"),v=(0,a.g2)("q-tab-panels");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(d,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=l=>e.tab=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:(0,a.k6)(()=>[(0,a.bF)(r,{name:"pages",label:"Pages",icon:"article"},{default:(0,a.k6)(()=>[0!=e.CountInformation.pages?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.CountInformation.pages),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(r,{name:"forms",label:"Forms",icon:"settings"},{default:(0,a.k6)(()=>[0!=e.CountInformation.forms?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.CountInformation.forms),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(r,{name:"vulns",label:"Vulns",icon:"gpp_bad"},{default:(0,a.k6)(()=>[0!=e.CountInformation.vulns?((0,a.uX)(),(0,a.Wv)(i,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.CountInformation.vulns),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})]),_:1},8,["modelValue"]),(0,a.bF)(u),(0,a.bF)(v,{modelValue:e.tab,"onUpdate:modelValue":l[1]||(l[1]=l=>e.tab=l),animated:""},{default:(0,a.k6)(()=>[(0,a.bF)(p,{name:"pages",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(c,{model:e.site},null,8,["model"])]),_:1}),(0,a.bF)(p,{name:"forms",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(m,{model:e.site},null,8,["model"])]),_:1}),(0,a.bF)(p,{name:"vulns",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(g,{model:e.site},null,8,["model"])]),_:1})]),_:1},8,["modelValue"])],64)}we()(Di,"components",{QScrollArea:Pe.A,QBtn:xe.A,QInput:Me.A,QIcon:Ue.A,QTree:je.A,QCheckbox:Be.A,QImg:Je.A,QMenu:$e.A,QList:Ge.A,QItem:Ye.A,QItemSection:Ze.A,QItemLabel:el.A,QSeparator:ll.A}),we()(Di,"directives",{Ripple:Gl.A,ClosePopup:al.A});const qi={align:"right"};function Ei(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("q-card-section"),d=(0,a.g2)("JsonEditorVue"),u=(0,a.g2)("q-spinner-gears"),c=(0,a.g2)("q-inner-loading"),p=(0,a.g2)("q-card");return null!=o.Rows?((0,a.uX)(),(0,a.Wv)(p,{key:0,bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",qi,[(0,a.bF)(i,{color:"green","icon-right":"edit",onClick:l[0]||(l[0]=e=>o.EditItem(o.Rows)),size:"sm"}),(0,a.bF)(i,{color:"red","icon-right":"delete",onClick:l[1]||(l[1]=e=>o.DeleteItem(o.Rows)),size:"sm"})])]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[4]||(l[4]=(0,a.Lk)("div",{class:"text-h6"},"Query:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.query),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("div",{class:"text-h6"},"Authentification:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.auth),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[6]||(l[6]=(0,a.Lk)("div",{class:"text-h6"},"Content Type:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.ctype),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[7]||(l[7]=(0,a.Lk)("div",{class:"text-h6"},"Headers:",-1)),(0,a.bF)(d,{modelValue:o.Rows.headers,"onUpdate:modelValue":l[2]||(l[2]=e=>o.Rows.headers=e),"read-only":!0,"main-menu-bar":!1,"navigation-bar":!1,mode:e.text,"onUpdate:mode":l[3]||(l[3]=l=>e.text=l)},null,8,["modelValue","mode"])]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[8]||(l[8]=(0,a.Lk)("div",{class:"text-h6"},"Cookie:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.cookie),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[9]||(l[9]=(0,a.Lk)("div",{class:"text-h6"},"Body:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.body),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[10]||(l[10]=(0,a.Lk)("div",{class:"text-h6"},"Request:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.request),1)]),_:1}),(0,a.bF)(c,{showing:o.loading},{default:(0,a.k6)(()=>[(0,a.bF)(u,{size:"50px",color:"primary"})]),_:1},8,["showing"])]),_:1})):(0,a.Q3)("",!0)}const Xi={name:"PageCard",components:{JsonEditorVue:La.A,AddEditItemCard:Ai},props:{model:{type:Object,default:null},stateLoad:{type:Boolean,default:!1}},setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(e.model),r=(0,n.KR)(e.stateLoad),d=(0,n.KR)(!1),u=(0,s.Pj)(),c=(0,n.KR)(null);async function p(){d.value=!0;var e=(0,m.y)("table","Web","getPageInfo"),l={workspace:u.state.current_project,page_id:o.value},a=await(0,i.L)(e,l,null,u.state.current_user.token);if(void 0!=a&&a&&0==a.hasOwnProperty("message")||Array.isArray(1==a)){c.value=a;try{null!=c.value.headers&&(c.value.headers=(0,za.Hh)(We.o4.toUint8Array(c.value.headers).buffer,{hashToJS:!0}),c.value.headers.hasOwnProperty("wrapped")&&(c.value.headers=c.value.headers.wrapped))}catch(e){try{c.value.headers=We.o4.decode(c.value.headers)}catch(e){}}d.value=!1}else d.value=!1,a.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",a.message,"report_problem")}async function b(e){var l=e;l.type="Page",l=JSON.parse(JSON.stringify(l)),t.dialog({component:Ai,componentProps:{CardAction:"EditItem",CardName:"Edit ",CardData:l}}).onOk(e=>{c.value=e})}async function g(e){var a=(0,m.y)("table","Web","delPage"),o={workspace:u.state.current_project,page_id:e.id},n=await(0,i.L)(a,o,null,u.state.current_user.token);void 0!=n&&0!=n?(200==n.status&&l("e_delete",e.id),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",n.message,"report_problem")}return(0,a.sV)(()=>{}),(0,a.nT)(()=>{o.value=e.model,0==r.value&&1==e.stateLoad&&p(),r.value=e.stateLoad}),{Model:o,loading:d,Rows:c,StateLoad:r,loadData:p,EditItem:b,DeleteItem:g}}};var Ki=t(9035),Li=t(5792);const zi=(0,_e.A)(Xi,[["render",Ei]]),Ni=zi;we()(Xi,"components",{QCard:ye.A,QCardSection:ot.A,QBtn:xe.A,QInnerLoading:Ki.A,QSpinnerGears:Li.A});const Pi={align:"right"};function Mi(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("q-card-section"),d=(0,a.g2)("q-spinner-gears"),u=(0,a.g2)("q-inner-loading"),c=(0,a.g2)("q-card");return null!=o.Rows?((0,a.uX)(),(0,a.Wv)(c,{key:0,bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",Pi,[(0,a.bF)(i,{color:"green","icon-right":"edit",onClick:l[0]||(l[0]=e=>o.EditItem(o.Rows)),size:"sm"}),(0,a.bF)(i,{color:"red","icon-right":"delete",onClick:l[1]||(l[1]=e=>o.DeleteItem(o.Rows)),size:"sm"})])]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[2]||(l[2]=(0,a.Lk)("div",{class:"text-h6"},"HTTP Method:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.method),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[3]||(l[3]=(0,a.Lk)("div",{class:"text-h6"},"Query:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.query),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[4]||(l[4]=(0,a.Lk)("div",{class:"text-h6"},"Params:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.params),1)]),_:1}),(0,a.bF)(u,{showing:o.loading},{default:(0,a.k6)(()=>[(0,a.bF)(d,{size:"50px",color:"primary"})]),_:1},8,["showing"])]),_:1})):(0,a.Q3)("",!0)}const Ui=[],ji={name:"FormCard",components:{JsonEditorVue:La.A,AddEditItemCard:Ai},props:{model:{type:Object,default:null},stateLoad:{type:Boolean,default:!1}},setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(e.model),r=(0,n.KR)(e.stateLoad),d=(0,n.KR)(!1),u=(0,s.Pj)(),c=(0,n.KR)([...Ui]);async function p(){d.value=!0;var e=(0,m.y)("table","Web","getFormInfo"),l={workspace:u.state.current_project,page_id:o.value},a=await(0,i.L)(e,l,null,u.state.current_user.token);if(void 0!=a&&a&&0==a.hasOwnProperty("message")||Array.isArray(1==a)){if(c.value=a,null!=c.value.params)try{c.value.params=(0,za.Hh)(We.o4.toUint8Array(c.value.params).buffer,{hashToJS:!0})}catch(e){try{c.value.params=We.o4.decode(c.value.params)}catch(e){}}d.value=!1}else d.value=!1,a.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",a.message,"report_problem")}async function b(e){var l=e;l.type="Form",l=JSON.parse(JSON.stringify(l)),t.dialog({component:Ai,componentProps:{CardAction:"EditItem",CardName:"Edit ",CardData:l}}).onOk(e=>{c.value=e})}async function g(e){var a=(0,m.y)("table","Web","delForm"),o={workspace:u.state.current_project,form_id:e.id},n=await(0,i.L)(a,o,null,u.state.current_user.token);void 0!=n&&0!=n?(200==n.status&&l("e_delete",e.id),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",n.message,"report_problem")}return(0,a.sV)(()=>{}),(0,a.nT)(()=>{o.value=e.model,0==r.value&&1==e.stateLoad&&p(),r.value=e.stateLoad}),{Model:o,loading:d,Rows:c,StateLoad:r,loadData:p,EditItem:b,DeleteItem:g}}},Bi=(0,_e.A)(ji,[["render",Mi]]),Ji=Bi;we()(ji,"components",{QCard:ye.A,QCardSection:ot.A,QBtn:xe.A,QInnerLoading:Ki.A,QSpinnerGears:Li.A});const Hi={align:"right"};function $i(e,l,t,o,n,s){const i=(0,a.g2)("q-btn"),r=(0,a.g2)("q-card-section"),d=(0,a.g2)("q-spinner-gears"),u=(0,a.g2)("q-inner-loading"),c=(0,a.g2)("q-card");return null!=o.Rows?((0,a.uX)(),(0,a.Wv)(c,{key:0,bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",Hi,[(0,a.bF)(i,{color:"green","icon-right":"edit",onClick:l[0]||(l[0]=e=>o.EditItem(o.Rows)),size:"sm"}),(0,a.bF)(i,{color:"red","icon-right":"delete",onClick:l[1]||(l[1]=e=>o.DeleteItem(o.Rows)),size:"sm"})])]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[2]||(l[2]=(0,a.Lk)("div",{class:"text-h6"},"Name:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.name),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[3]||(l[3]=(0,a.Lk)("div",{class:"text-h6"},"Category:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.category),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[4]||(l[4]=(0,a.Lk)("div",{class:"text-h6"},"Description:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.description),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("div",{class:"text-h6"},"Risk:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.risk),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[6]||(l[6]=(0,a.Lk)("div",{class:"text-h6"},"Query:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.query),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[7]||(l[7]=(0,a.Lk)("div",{class:"text-h6"},"HTTP Method:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.method),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[8]||(l[8]=(0,a.Lk)("div",{class:"text-h6"},"Confidence:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.confidence),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[9]||(l[9]=(0,a.Lk)("div",{class:"text-h6"},"Params:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.params),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[10]||(l[10]=(0,a.Lk)("div",{class:"text-h6"},"Proofs:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.proof),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[11]||(l[11]=(0,a.Lk)("div",{class:"text-h6"},"Payload:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.payload),1)]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[l[12]||(l[12]=(0,a.Lk)("div",{class:"text-h6"},"Request:",-1)),(0,a.eW)(" "+(0,b.v_)(o.Rows.request),1)]),_:1}),(0,a.bF)(u,{showing:o.loading},{default:(0,a.k6)(()=>[(0,a.bF)(d,{size:"50px",color:"primary"})]),_:1},8,["showing"])]),_:1})):(0,a.Q3)("",!0)}const Gi=[],Yi={name:"PageCard",components:{JsonEditorVue:La.A,AddEditItemCard:Ai},props:{model:{type:Object,default:null},stateLoad:{type:Boolean,default:!1}},setup(e,{emit:l}){const t=(0,pe.A)(),o=(0,n.KR)(e.model),r=(0,n.KR)(e.stateLoad),d=(0,n.KR)(!1),u=(0,s.Pj)(),c=(0,n.KR)([...Gi]);async function p(){d.value=!0;var e=(0,m.y)("table","Web","getVulnInfo"),l={workspace:u.state.current_project,page_id:o.value},a=await(0,i.L)(e,l,null,u.state.current_user.token);void 0!=a&&a&&0==a.hasOwnProperty("message")||Array.isArray(1==a)?(c.value=a,null!=c.value.proof&&-1!=c.value.proof.search("Res code: ")&&(c.value.code=c.value.proof.slice(10)),d.value=!1):(d.value=!1,a.hasOwnProperty("message")&&(0,Ie.e)(t,"negative","Error",a.message,"report_problem"))}async function b(e){var l=e;l.type="Vuln",l=JSON.parse(JSON.stringify(l)),t.dialog({component:Ai,componentProps:{CardAction:"EditItem",CardName:"Edit ",CardData:l}}).onOk(e=>{c.value=e})}async function g(e){var a=(0,m.y)("table","Web","delVuln"),o={workspace:u.state.current_project,vuln_id:e.id},n=await(0,i.L)(a,o,null,u.state.current_user.token);void 0!=n&&0!=n?(200==n.status&&l("e_delete",e.id),(0,Ie.e)(t,"positive","Запись удалена","","done")):(0,Ie.e)(t,"negative","Error",n.message,"report_problem")}return(0,a.sV)(()=>{}),(0,a.nT)(()=>{o.value=e.model,0==r.value&&1==e.stateLoad&&p(),r.value=e.stateLoad}),{Model:o,loading:d,Rows:c,StateLoad:r,loadData:p,EditItem:b,DeleteItem:g}}},Zi=(0,_e.A)(Yi,[["render",$i]]),er=Zi;we()(Yi,"components",{QCard:ye.A,QCardSection:ot.A,QBtn:xe.A,QInnerLoading:Ki.A,QSpinnerGears:Li.A});const lr={pages:0,forms:0,vulns:0},tr=(0,a.pM)({name:"Web",components:{PageCard:Ni,FormCard:Ji,VulnCard:er},props:{model:{type:Object,default:null}},setup(e){const l=(0,s.Pj)(),t=(0,n.KR)(lr),o=(0,n.KR)(e.model);async function r(){var e=(0,m.y)("table","Web","getCountInformation"),a={workspace:l.state.current_project,site_id:o.value.site_id,fullpath:o.value.fullpath},n=await(0,i.L)(e,a,null,l.state.current_user.token);void 0!=n&&n||Array.isArray(1==n)?t.value=n:n.hasOwnProperty("message")&&(0,Ie.e)($q,"negative","Error",n.message,"report_problem")}return(0,a.nT)(()=>{o.value=e.model,r()}),{CountInformation:t,site:o,tab:(0,n.KR)("pages"),loadData:r}}});var ar=t(2980),or=t(327),nr=t(9041),sr=t(1746);const ir=(0,_e.A)(tr,[["render",Ti]]),rr=ir;we()(tr,"components",{QTabs:ar.A,QTab:or.A,QBadge:Jt.A,QSeparator:ll.A,QTabPanels:nr.A,QTabPanel:sr.A});const dr={key:0},ur={key:1},cr={key:2},pr={key:0,class:"text-h6"},mr={key:1,class:"text-caption text-grey"},br={key:0},gr={key:1},vr={key:2},fr={key:0},_r={key:1},kr={key:0},yr={key:0},hr={key:1},Cr={key:2},Fr={key:3},xr={key:4},Ar={key:0},wr={key:1},Sr={key:2};function Vr(e,l,t,o,n,s){const i=(0,a.g2)("q-img"),r=(0,a.g2)("q-avatar"),d=(0,a.g2)("q-icon"),u=(0,a.g2)("q-card-section"),c=(0,a.g2)("q-separator"),p=(0,a.g2)("q-badge"),m=(0,a.g2)("q-item-section"),g=(0,a.g2)("PageCard"),v=(0,a.g2)("FormCard"),f=(0,a.g2)("VulnCard"),_=(0,a.g2)("q-card"),k=(0,a.g2)("q-expansion-item"),y=(0,a.g2)("q-spinner-gears"),h=(0,a.g2)("q-inner-loading");return(0,a.uX)(),(0,a.Wv)(_,null,{default:(0,a.k6)(()=>[null!=o.Model?((0,a.uX)(),(0,a.Wv)(u,{key:0,class:"fit row wrap justify-start items-start content-start"},{default:(0,a.k6)(()=>["directory"==o.Model.type?((0,a.uX)(),(0,a.CE)("div",dr,[(0,a.bF)(r,{square:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:"icons/directory.png"})]),_:1})])):"file"==o.Model.type||"vuln"==o.Model.type?((0,a.uX)(),(0,a.CE)("div",ur,[(0,a.bF)(r,{square:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{src:o.web_type_icon(o.Model.name)},null,8,["src"])]),_:1})])):"form"==o.Model.type?((0,a.uX)(),(0,a.CE)("div",cr,[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,{name:"settings",size:"md"})]),_:1})])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[null!=o.Model&&o.Model.hasOwnProperty("fullpath")?((0,a.uX)(),(0,a.CE)("div",pr,(0,b.v_)(o.Model.fullpath),1)):(0,a.Q3)("",!0),null!=o.Model&&o.Model.hasOwnProperty("comment")&&null!=o.Model.comment?((0,a.uX)(),(0,a.CE)("p",mr,(0,b.v_)(o.Model.comment.comment),1)):(0,a.Q3)("",!0)])]),_:1})):(0,a.Q3)("",!0),(0,a.bF)(c,{dark:"",inset:""}),(0,a.bF)(u,null,{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.Rows,e=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(k,{label:e.code,onShow:l[0]||(l[0]=e=>o.showCard()),onHide:l[1]||(l[1]=e=>o.hideCard())},{header:(0,a.k6)(()=>[(0,a.bF)(m,{avatar:""},{default:(0,a.k6)(()=>["page"==e.type?((0,a.uX)(),(0,a.CE)("div",br,[(0,a.bF)(r,{icon:"article"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{floating:"",color:"teal"},{default:(0,a.k6)(()=>[...l[2]||(l[2]=[(0,a.eW)("Page",-1)])]),_:1})]),_:1})])):"form"==e.type?((0,a.uX)(),(0,a.CE)("div",gr,[(0,a.bF)(r,{icon:"settings"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{floating:"",color:"orange"},{default:(0,a.k6)(()=>[...l[3]||(l[3]=[(0,a.eW)("Form",-1)])]),_:1})]),_:1})])):"vuln"==e.type?((0,a.uX)(),(0,a.CE)("div",vr,[(0,a.bF)(r,{icon:"gpp_bad"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{floating:"",color:"black"},{default:(0,a.k6)(()=>[...l[4]||(l[4]=[(0,a.eW)("Vuln",-1)])]),_:1})]),_:1})])):(0,a.Q3)("",!0)]),_:2},1024),(0,a.bF)(m,null,{default:(0,a.k6)(()=>["page"==e.type?((0,a.uX)(),(0,a.CE)("div",fr," GET: "+(0,b.v_)(e.query),1)):((0,a.uX)(),(0,a.CE)("div",_r,(0,b.v_)(e.method)+": "+(0,b.v_)(e.query),1))]),_:2},1024),(0,a.bF)(m,{side:""},{default:(0,a.k6)(()=>[void 0!=e.code&&null!=e.code?((0,a.uX)(),(0,a.CE)("div",kr,[e.code>=100&&e.code<200?((0,a.uX)(),(0,a.CE)("div",yr,[(0,a.bF)(p,{color:"blue"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.code),1)]),_:2},1024)])):e.code>=200&&e.code<300?((0,a.uX)(),(0,a.CE)("div",hr,[(0,a.bF)(p,{color:"green"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.code),1)]),_:2},1024)])):e.code>=300&&e.code<400?((0,a.uX)(),(0,a.CE)("div",Cr,[(0,a.bF)(p,{color:"orange"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.code),1)]),_:2},1024)])):e.code>=400&&e.code<500?((0,a.uX)(),(0,a.CE)("div",Fr,[(0,a.bF)(p,{color:"pink"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.code),1)]),_:2},1024)])):e.code>=500?((0,a.uX)(),(0,a.CE)("div",xr,[(0,a.bF)(p,{color:"red"},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(e.code),1)]),_:2},1024)])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)]),_:2},1024)]),default:(0,a.k6)(()=>[(0,a.bF)(_,{bordered:""},{default:(0,a.k6)(()=>["page"==e.type?((0,a.uX)(),(0,a.CE)("div",Ar,[(0,a.bF)(g,{model:e.id,stateLoad:o.StateShowCard,onE_delete:l=>{o.deletRow(e)}},null,8,["model","stateLoad","onE_delete"])])):"form"==e.type?((0,a.uX)(),(0,a.CE)("div",wr,[(0,a.bF)(v,{model:e.id,stateLoad:o.StateShowCard,onE_delete:l=>{o.deletRow(e)}},null,8,["model","stateLoad","onE_delete"])])):"vuln"==e.type?((0,a.uX)(),(0,a.CE)("div",Sr,[(0,a.bF)(f,{model:e.id,stateLoad:o.StateShowCard,onE_delete:l=>{o.deletRow(e)}},null,8,["model","stateLoad","onE_delete"])])):(0,a.Q3)("",!0)]),_:2},1024)]),_:2},1032,["label"])]))),256))]),_:1}),(0,a.bF)(h,{showing:o.loading},{default:(0,a.k6)(()=>[(0,a.bF)(y,{size:"50px",color:"primary"})]),_:1},8,["showing"])]),_:1})}const Qr=[],Ir={name:"InfoCard",components:{PageCard:Ni,FormCard:Ji,VulnCard:er},props:{model:{type:Object,default:null}},setup(e,{emit:l}){const t=(0,n.KR)(e.model),o=(0,n.KR)(!1),r=(0,s.Pj)(),d=(0,n.KR)([...Qr]),u=(0,n.KR)(!1);async function c(e,l,t=null){d.value=[],o.value=!0;var a=(0,m.y)("table","Web","getPathInfo"),n={workspace:r.state.current_project,site_id:e,fullpath:l,type:t},s=await(0,i.L)(a,n,null,r.state.current_user.token);if(null!=s)if(void 0!=s&&s&&0==s.hasOwnProperty("message")||Array.isArray(1==s)){if(0==s.length)d.value=[];else{let e=s.web_pages;null==e&&(e=[]);let l=s.web_forms;null==l&&(l=[]);let t=s.web_vulns;null==t&&(t=[]),d.value=[...e,...l,...t]}o.value=!1}else o.value=!1,s.hasOwnProperty("message")&&(0,Ie.e)($q,"negative","Error",s.message,"report_problem")}function p(){u.value=!0}function b(){u.value=!1}function g(e){d.value=d.value.filter(l=>l!==e)}return(0,a.nT)(()=>{t.value=e.model,null!=t.value&&t.value.hasOwnProperty("site_id")&&void 0!=t.value.fullpath&&c(t.value.site_id,t.value.fullpath,t.value.type)}),{Model:t,loading:o,Rows:d,StateShowCard:u,loadData:c,showCard:p,hideCard:b,deletRow:g,web_type_icon:Le}}},Wr=(0,_e.A)(Ir,[["render",Vr]]),Dr=Wr;we()(Ir,"components",{QCard:ye.A,QCardSection:ot.A,QAvatar:nt.A,QImg:Je.A,QIcon:Ue.A,QSeparator:ll.A,QExpansionItem:Hl.A,QItemSection:Ze.A,QBadge:Jt.A,QInnerLoading:Ki.A,QSpinnerGears:Li.A});const Rr=(0,a.pM)({name:"Web",components:{TableComponentsName:At.A,TreeSites:Oi,TableSites:Zs,TabCards:rr,InfoCard:Dr},setup(){const e=(0,s.Pj)(),l=(0,n.KR)(null);function t(e){l.value=e}return(0,a.wB)(()=>e.state.current_host,()=>{}),{splitterModel:(0,n.KR)(20),site:l,clickTree:t}}});var Or=t(8072);const Tr=(0,_e.A)(Rr,[["render",Es]]),qr=Tr;we()(Rr,"components",{QCard:ye.A,QSplitter:Or.A});const Er={class:"fit row wrap justify-end items-start content-start"},Xr={key:0,class:"fit row wrap justify-start items-start content-start"},Kr={class:"col-grow",style:{overflow:"auto"}},Lr={key:1};function zr(e,l,t,o,n,s){const i=(0,a.g2)("TableComponentsName"),r=(0,a.g2)("SelectWithFilter"),d=(0,a.g2)("q-card-section"),u=(0,a.g2)("q-card"),c=(0,a.g2)("q-expansion-item"),p=(0,a.g2)("JsonEditorVue");return(0,a.uX)(),(0,a.Wv)(u,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",Er,[(0,a.bF)(i,{name:"sessions",label:"Sessions",icon:{name:"token",color:"green"}})]),(0,a.bF)(r,{modelValue:o.Session,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Session=e),onE_model:l[1]||(l[1]=e=>o.updateModel(e))},null,8,["modelValue"]),null!=o.Description?((0,a.uX)(),(0,a.Wv)(c,{key:0,icon:"description",label:"Description"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{bordered:""},{default:(0,a.k6)(()=>["object"==typeof o.Description&&null!=o.Description.stype?((0,a.uX)(),(0,a.Wv)(d,{key:0},{default:(0,a.k6)(()=>[l[3]||(l[3]=(0,a.Lk)("b",null,"Type",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.stype),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.via_exploit?((0,a.uX)(),(0,a.Wv)(d,{key:1},{default:(0,a.k6)(()=>[l[4]||(l[4]=(0,a.Lk)("b",null,"Exploit",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.via_exploit),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.via_payload?((0,a.uX)(),(0,a.Wv)(d,{key:2},{default:(0,a.k6)(()=>[l[5]||(l[5]=(0,a.Lk)("b",null,"Payload",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.via_payload),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.desc?((0,a.uX)(),(0,a.Wv)(d,{key:3},{default:(0,a.k6)(()=>[l[6]||(l[6]=(0,a.Lk)("b",null,"Description",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.desc),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.port?((0,a.uX)(),(0,a.Wv)(d,{key:4},{default:(0,a.k6)(()=>[l[7]||(l[7]=(0,a.Lk)("b",null,"Port",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.port),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.platform?((0,a.uX)(),(0,a.Wv)(d,{key:5},{default:(0,a.k6)(()=>[l[8]||(l[8]=(0,a.Lk)("b",null,"Platform",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.platform),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.opened_at?((0,a.uX)(),(0,a.Wv)(d,{key:6},{default:(0,a.k6)(()=>[l[9]||(l[9]=(0,a.Lk)("b",null,"Open",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.opened_at),1)]),_:1})):(0,a.Q3)("",!0),"object"==typeof o.Description&&null!=o.Description.closed_at?((0,a.uX)(),(0,a.Wv)(d,{key:7},{default:(0,a.k6)(()=>[l[10]||(l[10]=(0,a.Lk)("b",null,"Close",-1)),(0,a.eW)(" - "+(0,b.v_)(o.Description.closed_at),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})]),_:1})):(0,a.Q3)("",!0),null!=o.Data?((0,a.uX)(),(0,a.Wv)(c,{key:1,icon:"settings",label:"Exploit Options"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.bF)(p,{modelValue:o.Data,"onUpdate:modelValue":l[2]||(l[2]=e=>o.Data=e),"read-only":!0,"main-menu-bar":!1,"navigation-bar":!1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):(0,a.Q3)("",!0),null!=o.Data?((0,a.uX)(),(0,a.Wv)(c,{key:2,icon:"timeline",label:"Session Events"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.Events,e=>((0,a.uX)(),(0,a.CE)("div",null,[null!=e.command?((0,a.uX)(),(0,a.CE)("div",Xr,[l[11]||(l[11]=(0,a.Lk)("div",{class:"text-red-9"},"msf> ",-1)),(0,a.Lk)("div",Kr,(0,b.v_)(e.command),1)])):((0,a.uX)(),(0,a.CE)("div",Lr,(0,b.v_)(e.output),1))]))),256))]),_:1})]),_:1})]),_:1})):(0,a.Q3)("",!0)]),_:1})}function Nr(e,l,t,o,n,s){const i=(0,a.g2)("q-icon"),r=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item-label"),u=(0,a.g2)("q-item"),c=(0,a.g2)("q-btn"),p=(0,a.g2)("q-select");return(0,a.uX)(),(0,a.Wv)(p,{filled:"","fill-input":"","input-debounce":"0",modelValue:o.Model,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Model=e),options:o.Options,label:o.Label,hint:o.Hint,"lazy-rules":"",onFilter:o.filterFn,onInputValue:o.setModel,"emit-value":""},{option:(0,a.k6)(e=>[(0,a.bF)(u,(0,b._B)((0,a.Ng)(e.itemProps)),{default:(0,a.k6)(()=>[(0,a.bF)(r,{avatar:""},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"token",style:{width:"25px",height:"25px"}})]),_:1}),(0,a.bF)(r,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)("Host - "+(0,b.v_)(e.opt.host)+", Type - "+(0,b.v_)(e.opt.stype)+", ID - "+(0,b.v_)(e.opt.value),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)("Exploit: "+(0,b.v_)(e.opt.exploit),1)]),_:2},1024),(0,a.bF)(d,{caption:""},{default:(0,a.k6)(()=>[(0,a.eW)("Payload: "+(0,b.v_)(e.opt.payload),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"text-grey"},{default:(0,a.k6)(()=>[...l[2]||(l[2]=[(0,a.eW)(" No results ",-1)])]),_:1})]),_:1})]),prepend:(0,a.k6)(()=>[(0,a.bF)(i,{name:"token",style:{width:"25px",height:"25px"}})]),append:(0,a.k6)(()=>[(0,a.bF)(c,{round:"",dense:"",flat:"",icon:"refresh",onClick:l[0]||(l[0]=e=>o.updateSelectOptions())})]),_:1},8,["modelValue","options","label","hint","onFilter","onInputValue"])}const Pr={props:{selectOptions:{type:Object,default:null},modelValue:{type:Object,default:null},label:{type:String,default:"Session"},hint:{type:String,default:""}},emits:[],setup(e,{emit:l}){const t=(0,n.KR)(e.modelValue),o=(0,n.KR)(e.selectOptions),d=(0,n.KR)(JSON.parse(JSON.stringify(o.value))),u=(0,n.KR)(e.label),c=(0,n.KR)(e.hint),p=(0,s.Pj)();async function b(e,l,t){setTimeout(()=>{l(()=>{if(""===e)d.value=o.value;else if(void 0!=e||null!=e){const l=e.toLowerCase();d.value=o.value.filter(e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1)}})},1500)}function g(e){t.value=e}async function v(){var e=(0,m.y)("table","Sessions","getSessions"),l={workspace:p.state.current_project,data:r(p.state.current_tree_node)},t=await(0,i.L)(e,l,null,p.state.current_user.token);void 0!=t&&0!=t&&(o.value=t.map(function(e){var l="";return null!=e.stype&&(l=`${e.stype}`),{label:l,stype:e.stype,value:e.id,exploit:e.via_exploit,payload:e.via_payload,host:e.host.address}}))}return(0,a.KC)(()=>{v()}),(0,a.wB)(()=>p.state.current_tree_node,()=>{null!=p.state.current_tree_node&&(o.value=[],d.value=[],t.value=null,v())}),(0,a.nT)(()=>{o.value=e.selectOptions}),(0,a.wB)(t,e=>{l("e_model",e)}),(0,a.wB)(()=>e.modelValue,e=>{t.value=e}),(0,a.wB)(()=>e.selectOptions,e=>{o.value=e}),{Model:t,SelectOptions:o,Options:d,filterFn:b,Label:u,Hint:c,setModel:g,updateSelectOptions:v}}},Mr=(0,_e.A)(Pr,[["render",Nr]]),Ur=Mr;we()(Pr,"components",{QSelect:Ce.A,QItem:Ye.A,QItemSection:Ze.A,QIcon:Ue.A,QItemLabel:el.A,QBtn:xe.A});const jr={props:{},components:{SelectWithFilter:Ur,JsonEditorVue:La.A,TableComponentsName:At.A},emits:[],setup(e){const l=(0,n.KR)(null),t=(0,s.Pj)(),o=(0,n.KR)(t.state.current_tree_node),r=(0,n.KR)(null),d=(0,n.KR)(null),u=(0,n.KR)(null);async function c(){var e=(0,m.y)("table","Sessions","getSessionData"),a={workspace:t.state.current_project,session:l.value},o=await(0,i.L)(e,a,null,t.state.current_user.token);if(void 0!=o&&0!=o&&200==o.status){let e=JSON.parse(o.data);if(null!=e)try{d.value=(0,za.Hh)(We.o4.toUint8Array(e.datastore).buffer,{hashToJS:!0})}catch(l){d.value=We.o4.decode(e.datastore)}r.value=e}}async function p(){u.value="";var e=(0,m.y)("table","Sessions","getSessionEvents"),a={workspace:t.state.current_project,session:l.value},o=await(0,i.L)(e,a,null,t.state.current_user.token);void 0!=o&&0!=o&&o.forEach(e=>{u.value=o})}async function b(e){l.value=e,c(),p()}return(0,a.wB)(()=>l,()=>{c(),p()}),{Session:l,Description:r,Data:d,Events:u,current_tree_node:o,getDataSession:c,getEventsession:p,updateModel:b}}},Br=(0,_e.A)(jr,[["render",zr]]),Jr=Br;we()(jr,"components",{QCard:ye.A,QExpansionItem:Hl.A,QCardSection:ot.A});const Hr={name:"SplitLayout",components:{TableServices:$t,TableNotes:lo,TreeHosts:nl,TableCreds:Go,TableVulns:ps,TableHosts:ya,TableLoots:Ts,Web:qr,Sessions:Jr},props:{countInformation:{type:Object,default:null}},setup(e){const l=(0,s.Pj)(),t=(0,n.KR)(e.countInformation),o=(0,n.KR)(l.state.current_tab),i=(0,n.KR)(l.state.all_tab[1]);return(0,a.nT)(()=>{t.value=e.countInformation}),(0,a.wB)(()=>l.state.current_tab,()=>{o.value=l.state.current_tab;let e=l.state.all_tab.indexOf(o.value);e!=l.state.all_tab.length-1?i.value=l.state.all_tab[e+1]:i.value=l.state.all_tab[0]}),{splitterModel1:(0,n.KR)(95),splitterModel2:(0,n.KR)(50),CountInformation:t,CurrentTab:o,Tab:i}}},$r=(0,_e.A)(Hr,[["render",il]]),Gr=$r;we()(Hr,"components",{QSplitter:Or.A,QTabPanels:nr.A,QTabPanel:sr.A,QTabs:ar.A,QTab:or.A,QIcon:Ue.A,QBadge:Jt.A});const Yr={style:{"max-height":"94vh"}};function Zr(e,l,t,o,n,s){const i=(0,a.g2)("q-icon"),r=(0,a.g2)("q-label"),d=(0,a.g2)("q-badge"),u=(0,a.g2)("q-tab"),c=(0,a.g2)("q-tabs"),p=(0,a.g2)("table-hosts"),m=(0,a.g2)("q-tab-panel"),g=(0,a.g2)("table-services"),v=(0,a.g2)("table-notes"),f=(0,a.g2)("table-creds"),_=(0,a.g2)("table-vulns"),k=(0,a.g2)("table-loots"),y=(0,a.g2)("web"),h=(0,a.g2)("sessions"),C=(0,a.g2)("q-tab-panels");return(0,a.uX)(),(0,a.CE)("div",Yr,[(0,a.bF)(c,{modelValue:o.Tab,"onUpdate:modelValue":l[0]||(l[0]=e=>o.Tab=e),style:{border:"1px solid #ccc"}},{default:(0,a.k6)(()=>[(0,a.bF)(u,{name:"hosts"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"computer",color:"black",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[2]||(l[2]=[(0,a.eW)("Hosts",-1)])]),_:1}),0!=o.CountInformation.hosts?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.hosts),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"services"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"sip",color:"orange",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[3]||(l[3]=[(0,a.eW)("Services",-1)])]),_:1}),0!=o.CountInformation.services?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.services),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"notes"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"description",color:"grey-9",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[4]||(l[4]=[(0,a.eW)("Notes",-1)])]),_:1}),0!=o.CountInformation.notes?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.notes),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"creds"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"key",color:"black",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[5]||(l[5]=[(0,a.eW)("Creds",-1)])]),_:1}),0!=o.CountInformation.creds?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.creds),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"vulns"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"gpp_bad",color:"red",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.eW)("Vulns",-1)])]),_:1}),0!=o.CountInformation.vulns?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.vulns),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"loots"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"diamond",color:"blue",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("Loots",-1)])]),_:1}),0!=o.CountInformation.loots?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.loots),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"web"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"web",color:"indigo-13",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)("Web",-1)])]),_:1}),0!=o.CountInformation.web?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.web),1)]),_:1})):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(u,{name:"sessions"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{name:"token",color:"green",size:"md"}),(0,a.bF)(r,{class:"text-bold"},{default:(0,a.k6)(()=>[...l[9]||(l[9]=[(0,a.eW)("Sessions",-1)])]),_:1}),0!=o.CountInformation.sessions?((0,a.uX)(),(0,a.Wv)(d,{key:0,color:"red",floating:""},{default:(0,a.k6)(()=>[(0,a.eW)((0,b.v_)(o.CountInformation.sessions),1)]),_:1})):(0,a.Q3)("",!0)]),_:1})]),_:1},8,["modelValue"]),(0,a.bF)(C,{modelValue:o.Tab,"onUpdate:modelValue":l[1]||(l[1]=e=>o.Tab=e),animated:""},{default:(0,a.k6)(()=>[(0,a.bF)(m,{name:"hosts",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(p)]),_:1}),(0,a.bF)(m,{name:"services",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(g)]),_:1}),(0,a.bF)(m,{name:"notes",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(v)]),_:1}),(0,a.bF)(m,{name:"creds",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(f)]),_:1}),(0,a.bF)(m,{name:"vulns",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(_)]),_:1}),(0,a.bF)(m,{name:"loots",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(k)]),_:1}),(0,a.bF)(m,{name:"web",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(y)]),_:1}),(0,a.bF)(m,{name:"sessions",style:{padding:"0px"}},{default:(0,a.k6)(()=>[(0,a.bF)(h)]),_:1})]),_:1},8,["modelValue"])])}const ed={name:"SingleLayout",components:{TableServices:$t,TableNotes:lo,TreeHosts:nl,TableCreds:Go,TableVulns:ps,TableHosts:ya,TableLoots:Ts,Web:qr,Sessions:Jr},props:{countInformation:{type:Object,default:null}},setup(e){const l=(0,s.Pj)(),t=(0,n.KR)(e.countInformation),o=(0,n.KR)(l.state.current_tab),i=(0,n.KR)(l.state.all_tab[1]);return(0,a.nT)(()=>{t.value=e.countInformation}),(0,a.wB)(()=>l.state.current_tab,()=>{o.value=l.state.current_tab;let e=l.state.all_tab.indexOf(o.value);e!=l.state.all_tab.length-1?i.value=l.state.all_tab[e+1]:i.value=l.state.all_tab[0]}),{CountInformation:t,CurrentTab:o,Tab:i}}},ld=(0,_e.A)(ed,[["render",Zr]]),td=ld;we()(ed,"components",{QTabs:ar.A,QTab:or.A,QIcon:Ue.A,QBadge:Jt.A,QTabPanels:nr.A,QTabPanel:sr.A});const ad={hosts:0,services:0,notes:0,creds:0,vulns:0,loots:0,web:0,sessions:0},od={name:"PageMain",components:{TreeHosts:nl,SplitLayout:Gr,SingleLayout:td},setup(){const e=(0,s.Pj)(),l=(0,n.KR)(ad),t=(0,n.KR)(e.state.user_settings),o=(0,n.KR)();function d(e){console.log(e)}function u(e){console.log(e)}function c(e){}async function p(){var t=(0,m.y)("json","CountInformation","getItem"),a={workspace:e.state.current_project,data:r(e.state.current_tree_node)},o=await(0,i.L)(t,a,null,e.state.current_user.token);void 0!=o&&o||Array.isArray(1==o)?l.value=o:o.hasOwnProperty("message")&&show_notify($q,"negative","Error",o.message,"report_problem")}return(0,a.nT)(()=>{t.value=e.state.user_settings}),(0,a.wB)(()=>e.state.current_tree_node,()=>{null!=e.state.type_tree&&p()}),{treehostsRef:o,CountInformation:l,UserSettings:t,Addhost:d,Edithost:c,Delhost:u,splitterModel:(0,n.KR)(8)}}},nd=(0,_e.A)(od,[["render",o]]),sd=nd;we()(od,"components",{QPage:tl.A,QSplitter:Or.A})}}]);