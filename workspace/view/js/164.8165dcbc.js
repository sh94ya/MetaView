"use strict";(globalThis["webpackChunkais"]=globalThis["webpackChunkais"]||[]).push([[164],{4164:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Ds});var a=t(9835),o=t(6970);const n=(0,a.Uk)("Закрепить"),i=(0,a.Uk)("Выход");function s(e,l,t,s,r,u){const d=(0,a.up)("tree-hosts"),c=(0,a.up)("table-hosts"),p=(0,a.up)("table-services"),m=(0,a.up)("table-notes"),_=(0,a.up)("table-creds"),g=(0,a.up)("table-vulns"),f=(0,a.up)("table-loots"),w=(0,a.up)("q-tab-panel"),v=(0,a.up)("q-tab-panels"),b=(0,a.up)("q-badge"),h=(0,a.up)("q-tab"),k=(0,a.up)("q-tabs"),y=(0,a.up)("q-icon"),W=(0,a.up)("q-item-section"),x=(0,a.up)("q-item"),C=(0,a.up)("q-separator"),q=(0,a.up)("q-list"),V=(0,a.up)("q-menu"),S=(0,a.up)("q-splitter"),z=(0,a.up)("q-page"),H=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(S,{modelValue:e.splitterModel,"onUpdate:modelValue":l[5]||(l[5]=l=>e.splitterModel=l)},{before:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(d,{ref:"treehostsRef"},null,512)])])),after:(0,a.w5)((()=>[(0,a.Wm)(S,{modelValue:e.splitterModel2,"onUpdate:modelValue":l[4]||(l[4]=l=>e.splitterModel2=l),horizontal:""},{before:(0,a.w5)((()=>["hosts"==e.current_tab?((0,a.wg)(),(0,a.j4)(c,{key:0})):(0,a.kq)("",!0),"services"==e.current_tab?((0,a.wg)(),(0,a.j4)(p,{key:1})):(0,a.kq)("",!0),"notes"==e.current_tab?((0,a.wg)(),(0,a.j4)(m,{key:2})):(0,a.kq)("",!0),"creds"==e.current_tab?((0,a.wg)(),(0,a.j4)(_,{key:3})):(0,a.kq)("",!0),"vulns"==e.current_tab?((0,a.wg)(),(0,a.j4)(g,{key:4})):(0,a.kq)("",!0),"loots"==e.current_tab?((0,a.wg)(),(0,a.j4)(f,{key:5})):(0,a.kq)("",!0)])),after:(0,a.w5)((()=>[(0,a.Wm)(S,{modelValue:e.splitterModel1,"onUpdate:modelValue":l[3]||(l[3]=l=>e.splitterModel1=l)},{before:(0,a.w5)((()=>[(0,a.Wm)(v,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=l=>e.tab=l),animated:""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"hosts",style:{padding:"0px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c)])),_:1}),(0,a.Wm)(w,{name:"services",style:{padding:"0px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p)])),_:1}),(0,a.Wm)(w,{name:"notes",style:{padding:"0px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(m)])),_:1}),(0,a.Wm)(w,{name:"creds",style:{padding:"0px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(_)])),_:1}),(0,a.Wm)(w,{name:"vulns",style:{padding:"0px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(g)])),_:1}),(0,a.Wm)(w,{name:"loots",style:{padding:"0px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(f)])),_:1})])),_:1},8,["modelValue"])])),after:(0,a.w5)((()=>[(0,a.Wm)(k,{modelValue:e.tab,"onUpdate:modelValue":l[1]||(l[1]=l=>e.tab=l),vertical:""},{default:(0,a.w5)((()=>["hosts"!=e.current_tab?((0,a.wg)(),(0,a.j4)(h,{key:0,name:"hosts",icon:"computer",label:"Hosts"},{default:(0,a.w5)((()=>[0!=e.Rows[0].hosts?((0,a.wg)(),(0,a.j4)(b,{key:0,color:"red",floating:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.Rows[0].hosts),1)])),_:1})):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"services"!=e.current_tab?((0,a.wg)(),(0,a.j4)(h,{key:1,name:"services",icon:"sip",label:"Services"},{default:(0,a.w5)((()=>[0!=e.Rows[0].services?((0,a.wg)(),(0,a.j4)(b,{key:0,color:"red",floating:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.Rows[0].services),1)])),_:1})):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"notes"!=e.current_tab?((0,a.wg)(),(0,a.j4)(h,{key:2,name:"notes",icon:"description",label:"Notes"},{default:(0,a.w5)((()=>[0!=e.Rows[0].notes?((0,a.wg)(),(0,a.j4)(b,{key:0,color:"red",floating:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.Rows[0].notes),1)])),_:1})):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"creds"!=e.current_tab?((0,a.wg)(),(0,a.j4)(h,{key:3,name:"creds",icon:"pin",label:"Creds"},{default:(0,a.w5)((()=>[0!=e.Rows[0].creds?((0,a.wg)(),(0,a.j4)(b,{key:0,color:"red",floating:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.Rows[0].creds),1)])),_:1})):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"vulns"!=e.current_tab?((0,a.wg)(),(0,a.j4)(h,{key:4,name:"vulns",icon:"gpp_bad",label:"Vulns"},{default:(0,a.w5)((()=>[0!=e.Rows[0].vulns?((0,a.wg)(),(0,a.j4)(b,{key:0,color:"red",floating:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.Rows[0].vulns),1)])),_:1})):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"loots"!=e.current_tab?((0,a.wg)(),(0,a.j4)(h,{key:5,name:"loots",icon:"article",label:"Loots"},{default:(0,a.w5)((()=>[0!=e.Rows[0].loots?((0,a.wg)(),(0,a.j4)(b,{key:0,color:"red",floating:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.Rows[0].loots),1)])),_:1})):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0)])),_:1},8,["modelValue"]),(0,a.Wm)(V,{"touch-position":"","context-menu":""},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{dense:"",style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(x,{clickable:"",onClick:l[2]||(l[2]=l=>e.fix_up(e.tab))},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{name:"push_pin",size:"25px"}),(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[n])),_:1})])),_:1})),[[H]]),(0,a.Wm)(C),(0,a.wy)(((0,a.wg)(),(0,a.j4)(x,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[i])),_:1})])),_:1})),[[H]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})}var r=t(499),u=t(1049),d=t(1569),c=t(4276);const p=(0,a.Uk)("CSV "),m=(0,a.Uk)("XLS "),_={class:"text-h4"},g=(0,a.Uk)(" Services "),f=(0,a.Uk)(" Закрепить компонент вверху "),w={key:0},v=(0,a._)("div",{align:"center"},"Visible Columns",-1),b={key:0},h={key:1},k={key:3},y={key:2,align:"right"},W={key:3};function x(e,l,t,n,i,s){const r=(0,a.up)("q-btn"),u=(0,a.up)("q-img"),d=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),x=(0,a.up)("q-list"),C=(0,a.up)("q-menu"),q=(0,a.up)("q-toggle"),V=(0,a.up)("q-tooltip"),S=(0,a.up)("q-chip"),z=(0,a.up)("q-icon"),H=(0,a.up)("q-input"),Z=(0,a.up)("q-checkbox"),U=(0,a.up)("q-th"),Q=(0,a.up)("q-tr"),T=(0,a.up)("q-popup-proxy"),D=(0,a.up)("q-td"),R=(0,a.up)("q-badge"),P=(0,a.up)("q-table"),j=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(P,{title:"Сервисы",rows:n.Rows,columns:n.columns,"row-key":"id",ref:"q_table","selected-rows-label":n.getSelectedString,selection:"multiple",dense:"",selected:n.selected,"onUpdate:selected":l[8]||(l[8]=e=>n.selected=e),onSelection:n.handleSelectRow,loading:n.loading,filter:n.filter,"visible-columns":n.visibleColumns},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(r,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:n.additem},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:n.deleteItems,disable:n.btn_disable()},null,8,["onClick","disable"]),(0,a.Wm)(r,{color:"blue","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[0]||(l[0]=e=>n.to_csv()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/csv.png"}),p])),_:1})])),_:1})),[[j]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[1]||(l[1]=e=>n.to_xls()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/excel.png"}),m])),_:1})])),_:1})),[[j]])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(q,{modelValue:n.tableSelectable,"onUpdate:modelValue":l[2]||(l[2]=e=>n.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",_,[g,(0,a.Wm)(r,{flat:"",round:"",color:n.pin_color,icon:"push_pin",onClick:l[3]||(l[3]=e=>n.set_current_tab())},{default:(0,a.w5)((()=>[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[f])),_:1})])),_:1},8,["color"])]),0!=n.drawChip(n.current_tree_node)?((0,a.wg)(),(0,a.iD)("div",w,[(0,a.Wm)(S,{modelValue:n.chiphost,"onUpdate:modelValue":l[4]||(l[4]=e=>n.chiphost=e),onRemove:l[5]||(l[5]=e=>n.removeChip()),icon:"subnets"===n.store.state.type_tree?"computer":"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(n.current_tree_node.label),1)])),_:1},8,["modelValue","icon"])])):(0,a.kq)("",!0),(0,a.Wm)(H,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[6]||(l[6]=e=>n.filter=e),placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(z,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,a.w5)((e=>[(0,a.Wm)(Q,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(U,{key:0,align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(l=>((0,a.wg)(),(0,a.j4)(U,{key:l.name,props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,a.Wm)(T,{"context-menu":""},{default:(0,a.w5)((()=>[v,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.columns,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(q,{modelValue:n.visibleColumns,"onUpdate:modelValue":l[7]||(l[7]=e=>n.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,a.w5)((e=>[0!=e.row.port?((0,a.wg)(),(0,a.j4)(Q,{key:0,props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(D,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,a.wg)(),(0,a.j4)(D,{key:l.name,align:"center"},{default:(0,a.w5)((()=>["name"==l.name?((0,a.wg)(),(0,a.iD)("div",b,[null!=n.services_name_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.services_name_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"state"==l.name?((0,a.wg)(),(0,a.iD)("div",h,["state"==l.name&&"open"==l.value?((0,a.wg)(),(0,a.j4)(R,{key:0,color:"green"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):"state"==l.name&&"filtered"==l.value?((0,a.wg)(),(0,a.j4)(R,{key:1,color:"brown"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):"state"==l.name&&"closed"==l.value?((0,a.wg)(),(0,a.j4)(R,{key:2,color:"red"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):((0,a.wg)(),(0,a.iD)("div",k,(0,o.zw)(l.value),1))])):"actions"==l.name?((0,a.wg)(),(0,a.iD)("div",y,[(0,a.Wm)(r,{color:"green","icon-right":"edit",onClick:l=>n.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",onClick:l=>n.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):((0,a.wg)(),(0,a.iD)("div",W,(0,o.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props"])):(0,a.kq)("",!0)])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}var C=t(1746),q=t(9302);const V=(0,a.Uk)("Minimize"),S=(0,a.Uk)("Maximize"),z=(0,a.Uk)("Close"),H={class:"q-pa-md"},Z=(0,a._)("div",{class:"text-h6"}," Add Service ",-1),U=(0,a.Uk)(" No results "),Q=["src"];function T(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-select"),g=(0,a.up)("q-img"),f=(0,a.up)("q-item-section"),w=(0,a.up)("q-item-label"),v=(0,a.up)("q-item"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[V])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[S])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[z])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",H,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[Z])),_:1}),(0,a.Wm)(m,{id:"ip",filled:"",modelValue:n.row[0].address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.row[0].address=e),label:"Text",hint:"IP-адрес",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].port,"onUpdate:modelValue":l[3]||(l[3]=e=>n.row[0].port=e),label:"Number",type:"number",hint:"Порт","lazy-rules":"",ref:"portRef",rules:n.portRules},null,8,["modelValue","rules"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].proto,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].proto=e),label:"Text",options:n.options,hint:"Протокол","lazy-rules":""},null,8,["modelValue","options"]),(0,a.Wm)(_,{filled:"","option-value":"value","option-label":"label","emit-value":"","map-options":"",modelValue:n.row[0].state,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].state=e),options:n.options1,label:"Text",hint:"Состояние","lazy-rules":""},null,8,["modelValue","options"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].name,"onUpdate:modelValue":l[6]||(l[6]=e=>n.row[0].name=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Text","emit-value":"",options:n.options2,onFilter:n.filterFn,onFilterAbort:n.abortFilterFn,onInputValue:n.setModel,hint:"Служба"},{option:(0,a.w5)((e=>[(0,a.Wm)(v,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(f,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"text-grey"},{default:(0,a.w5)((()=>[U])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.row[0].name)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.row[0].name),style:{width:"25px",height:"25px"}},null,8,Q)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onFilterAbort","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].info,"onUpdate:modelValue":l[7]||(l[7]=e=>n.row[0].info=e),label:"Text",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}t(1384);var D=t(4182),R=t(7701);function P(e){var l="icons/unknown.png";try{if(null!=e&&void 0!=e){var t=e.toLowerCase();if("device"==t)return"icons/purpose/device.png";if("nas"==t)return"icons/purpose/nas.png";if("wifi_router"==t)return"icons/purpose/wifi_router.png";if("router"==t)return"icons/purpose/router.png";if("switch"==t)return"icons/purpose/switch.png";if("voip_gw"==t)return"icons/purpose/voip_gw.png";if("cloud_store"==t)return"icons/purpose/cloud_store.png";if("computer"==t)return"icons/purpose/computer.png";if("laptop"==t)return"icons/purpose/laptop.png";if("server"==t)return"icons/purpose/server.png";if("printer"==t)return"icons/purpose/printer.png";if("voip_client"==t)return"icons/purpose/voip_client.png";if("firewall"==t)return"icons/purpose/firewall.png";if("mfp"==t)return"icons/purpose/mfp.png";if("smart_phone"==t)return"icons/purpose/smart_phone.png";if("tv"==t)return"icons/purpose/tv.png";if("ip_camera"==t)return"icons/purpose/ip_camera.png";if("client"==t)return"icons/purpose/pc.png";if("tiny_client"==t)return"icons/purpose/tiny_client.png";if("ups"==t)return"icons/purpose/ups.png"}}catch{}return l}function j(e){var l="icons/unknown.png";try{if(null!=e&&void 0!=e){var t=e.toLowerCase();if("windows"==t)return"icons/os/windows.png";if("linux"==t)return"icons/os/linux.png";if("freebsd"==t)return"icons/os/freebsd.png";if("android"==t)return"icons/os/android.png";if("ios"==t)return"icons/os/ios.png";if("macos"==t)return"icons/os/macos.png";if("hp"==t)return"icons/os/hp.png";if("vmware"==t)return"icons/os/vmware.png";if("cisco"==t)return"icons/os/cisco.png";if("mikrotik"==t)return"icons/os/mikrotik.png";if("huawei"==t)return"icons/os/huawei.png";if("d-link"==t)return"icons/os/dlink.png";if("tp-link"==t)return"icons/os/tplink.png";if("unix"==t)return"icons/os/unix.png"}}catch{}return l}function I(e){var l=null;try{var t=e.toLowerCase();if(-1!=t.search("ssh"))return"icons/services/ssh.png";if(-1!=t.search("telnet"))return"icons/services/telnet.png";if(-1!=t.search("ftp"))return"icons/services/ftp.png";if(-1!=t.search("pop3"))return"icons/services/pop3.png";if(-1!=t.search("imap"))return"icons/services/imap.png";if(-1!=t.search("smtp"))return"icons/services/smtp.png";if(-1!=t.search("mysql"))return"icons/services/mysql.png";if(-1!=t.search("smb")||-1!=t.search("microsoft ds")||-1!=t.search("microsoft-ds")||-1!=t.search("samba"))return"icons/services/smb.png";if(-1!=t.search("rdp")||-1!=t.search("wbt-server")||-1!=t.search("rds ")||-1!=t.search(" rds")||"rds"==t)return"icons/services/rdp.png";if(-1!=t.search("vnc"))return"icons/services/vnc.png";if(-1!=t.search("dns")||"domain"==t)return"icons/services/dns.png";if(-1!=t.search("ldap"))return"icons/services/ldap.png";if(-1!=t.search("http")||-1!=t.search("php")||-1!=t.search("openssl")||-1!=t.search("nginx")||-1!=t.search("iis"))return"icons/services/http.png";if(-1!=t.search("mysql"))return"icons/services/mysql.png";if(-1!=t.search("postgres"))return"icons/services/postgresql.png";if(-1!=t.search("microsoft sql")||-1!=t.search("ms-sql")||-1!=t.search("msql")||-1!=t.search("mssql"))return"icons/services/msql.png";if(-1!=t.search("snmp"))return"icons/services/snmp.png";if(-1!=t.search("pptp")||-1!=t.search("l2tp")||-1!=t.search("openvpn")||-1!=t.search("ipsec")||-1!=t.search("ipsec"))return"icons/services/vpn.png";if(-1!=t.search("vmware"))return"icons/os/vmware.png";if("jetdirect"==t||-1!=t.search("printer"))return"icons/purpose/printer.png";if(-1!=t.search("rtsp")||"realserver"==t)return"icons/services/rtsp.png";if(-1!=t.search("redis"))return"icons/services/redis.png";if(-1!=t.search("firebird"))return"icons/services/firebird.png";if(-1!=t.search("oracle"))return"icons/services/oracle.png";if(-1!=t.search("radmin"))return"icons/services/radmin.png";if(-1!=t.search("xmpp")||-1!=t.search("jabber"))return"icons/services/xmpp.png";if(-1!=t.search("git"))return"icons/services/git.png";if(-1!=t.search("microsoft windows")||-1!=t.search("ms-lsa")||-1!=t.search("msdtc")||-1!=t.search("msmq")||-1!=t.search("ms message queue")||-1!=t.search("rpc  windows")||-1!=t.search("microsoft rpc")||-1!=t.search("msrpc")||-1!=t.search(".exe"))return"icons/os/windows.png";if(-1!=t.search("linux kernel"))return"icons/os/linux.png";if(-1!=t.search("cisco"))return"icons/os/cisco.png";if(-1!=t.search("sip"))return"icons/purpose/voip_client.png";if(-1!=t.search("bgp"))return"icons/purpose/router.png";if(-1!=t.search("ilo"))return"icons/os/hp.png";if(-1!=t.search("bitcoin"))return"icons/services/bitcoin.png";if(-1!=t.search("dameware"))return"icons/services/dameware.png";if(-1!=t.search("zabbix"))return"icons/services/zabbix.png";if(-1!=t.search("1c ")||"1c"==t)return"icons/services/1c.png";if(-1!=t.search("adobe"))return"icons/services/adobe.png";if(-1!=t.search("nagios"))return"icons/services/nagios.png";if(-1!=t.search("modbus"))return"icons/services/modbus.png";if("time"==t)return"icons/services/time.png";if(-1!=t.search("netbios"))return"icons/services/netbios.png";if(-1!=t.search("kerberos")||-1!=t.search("kpasswd"))return"icons/services/kerberos.png";if(-1!=t.search("proxy")||-1!=t.search("socks"))return"icons/services/proxy.png"}catch{}return l}function O(e){var l=null;try{var t=e.toLowerCase();if(-1!=t.search("ios"))return"icons/os/os_name/cisco/ios.png";if(-1!=t.search("ilo"))return"icons/os/os_name/hp/ilo.png";if(-1!=t.search("junos"))return"icons/os/os_name/freebsd/junos.png";if(-1!=t.search("astra"))return"icons/os/os_name/linux/astra.png";if(-1!=t.search("debian"))return"icons/os/os_name/linux/debian.png";if(-1!=t.search("ubuntu"))return"icons/os/os_name/linux/ubuntu.png";if(-1!=t.search("gentoo"))return"icons/os/os_name/linux/gentoo.png";if(-1!=t.search("centos"))return"icons/os/os_name/linux/centos.png";if(-1!=t.search("red hat")||-1!=t.search("enterprise linux"))return"icons/os/os_name/linux/redhat.png";if(-1!=t.search("kali"))return"icons/os/os_name/linux/kali.png";if(-1!=t.search("mandriva"))return"icons/os/os_name/linux/mandriva.png";if(-1!=t.search("mint"))return"icons/os/os_name/linux/mint.png";if(-1!=t.search("fedora"))return"icons/os/os_name/linux/fedora.png";if(-1!=t.search("linux"))return"icons/os/linux.png";if(-1!=t.search("windows"))return-1!=t.search("windows 7")||-1!=t.search("2008 r2")?"icons/os/os_name/windows/7.png":-1!=t.search("windows 8")||-1!=t.search("2012")?"icons/os/os_name/windows/8.png":-1!=t.search("windows 10")||-1!=t.search("2016")||-1!=t.search("2019")?"icons/os/os_name/windows/10.png":-1!=t.search("windows xp")||-1!=t.search("2003")?"icons/os/os_name/windows/xp.png":-1!=t.search("windows vista")||-1!=t.search("2008")?"icons/os/os_name/windows/vista.png":-1!=t.search("windows 11")||-1!=t.search("2022")?"icons/os/os_name/windows/11.png":"icons/os/windows.png";if(-1!=t.search("esxi"))return"icons/os/vmware.png";if(-1!=t.search("vcenter"))return"icons/os/os_name/vmware/vcenter.png";if(-1!=t.search("solaris"))return"icons/os/os_name/unix/sun/solaris.png";if(-1!=t.search("embedded"))return"icons/os/embedded.png"}catch{}return l}function A(e){var l=null;try{var t=e.toLowerCase();if(-1!=t.search("nmap"))return"icons/notes/nmap.png";if(-1!=t.search("maxpatrol"))return"icons/notes/maxpatrol.png";if(-1!=t.search("putty"))return"icons/notes/putty.png";if(-1!=t.search("http."))return"icons/services/http.png";if(-1!=t.search("smb."))return"icons/services/smb.png";if(-1!=t.search("snmp."))return"icons/services/snmp.png";if(-1!=t.search("ssh."))return"icons/services/ssh.png";if(-1!=t.search("host."))return"icons/purpose/pc.png";if(-1!=t.search("chrome"))return"icons/notes/chrome.png";if(-1!=t.search("firefox"))return"icons/notes/firefox.png";if(-1!=t.search("edge"))return"icons/notes/edge.png";if(-1!=t.search("opera"))return"icons/notes/opera.png";if(-1!=t.search("yandex"))return"icons/notes/yandex.png";if(-1!=t.search("explorer"))return"icons/notes/ie.png";if(-1!=t.search("outlook"))return"icons/notes/outlook.png";if(-1!=t.search("thebat")||-1!=t.search("the bat"))return"icons/notes/thebat.png";if(-1!=t.search("thunderbird"))return"icons/notes/thunderbird.png";if(-1!=t.search("keepass"))return"icons/notes/keepass.png";if(-1!=t.search("windows"))return"icons/os/windows.png";if(-1!=t.search("linux")||-1!=t.search("shadow")||-1!=t.search("passwd")||-1!=t.search("ifconfig"))return"icons/os/linux.png";if(-1!=t.search("drupal"))return"icons/notes/drupal.png";if(-1!=t.search("macroscop"))return"icons/notes/macroscope.png";if(-1!=t.search("wifi"))return"icons/notes/wifi.png";if(-1!=t.search("wordpress"))return"icons/notes/wordpress.png";if(-1!=t.search("kaspersky"))return"icons/notes/kaspersky.png";if(-1!=t.search("drweb")||-1!=t.search("dr.web"))return"icons/notes/drweb.png";if(-1!=t.search("cme")||-1!=t.search("crackmap"))return"icons/notes/cme.png";if(-1!=t.search("meterpreter")||-1!=t.search("metasploit"))return"icons/notes/metasploit.png";if(-1!=t.search("teamviewer"))return"icons/notes/teamviewer.png";if(-1!=t.search("anydesk"))return"icons/notes/anydesk.png";if(-1!=t.search("kerio"))return"icons/notes/kerio.png";if(-1!=t.search("joomla"))return"icons/notes/joomla.png";if(-1!=t.search("domain.")||-1!=t.search("ad_")||-1!=t.search("ad."))return"icons/notes/ad.png";if(-1!=t.search("qemu"))return"icons/notes/qemu.png";if(-1!=t.search("eset")||-1!=t.search("nod32"))return"icons/notes/eset.png";if(-1!=t.search("virtualbox"))return"icons/notes/virtualbox.png";if(-1!=t.search("donpapi")||-1!=t.search("dploot"))return"icons/notes/donpapi.png";if(-1!=t.search("infotecs")||-1!=t.search("vipnet"))return"icons/notes/infotecs.png";if(-1!=t.search("апкш")||-1!=t.search("континент")||-1!=t.search("continent"))return"icons/notes/kodbezopasnosti.png";if(-1!=t.search("perco"))return"icons/notes/perco.png";if(-1!=t.search("sigur"))return"icons/notes/sigur.png";if(-1!=t.search("sigur"))return"icons/notes/sigur.png";if(-1!=t.search("trassir"))return"icons/notes/trassir.png";if(-1!=t.search("creds"))return"icons/notes/creds.png";l=I(t)}catch{}return l}const M=[],F={props:{current_host_prop:String,current_host_label_prop:String},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),c=(0,r.iH)(null),p=(0,r.iH)(null),m=(0,r.iH)(["tcp","udp"]),_=(0,r.iH)([{label:'<span class="text-positive text-weight-bold">open</span>',value:"open",html:!0},{label:'<span class="text-brown-8 text-weight-bold">filtered</span>',value:"filtered",html:!0},{label:'<span class="text-negative text-weight-bold">closed</span>',value:"closed",html:!0},{label:'<span class="text-weight-bold">unknown</span>',value:"unknown",html:!0}]),g=(0,r.iH)(M),f=(0,r.iH)([...M]),w=(0,r.iH)(s.state.current_tree_node),v=(0,r.iH)(null),b=(0,r.iH)(null),h=(0,r.iH)([{id:-1,address:null,port:1,proto:"tcp",state:"open",name:null,info:""}]);function k(e,l){return["http","https"]}function y(e,l,t){setTimeout((()=>{l((()=>{if(""===e)g.value=f.value;else{const l=e.toLocaleLowerCase();g.value=f.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function W(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function x(){console.log("delayed filter aborted")}function C(e){h.value[0].name=e}function V(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_service",{headers:e}).then((e=>{f.value=e.data.map((function(e){return{value:e.name,label:e.name,image:I(e.name)}}))})).catch((()=>{}))}async function S(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/add_service",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(h.value[0].id=e.data.id,o({row:h}),(0,R.$)(i,"positive","Запись добавлена","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{w.value=s.state.current_tree_node,void 0!=w&&null!=w&&("subnet"!=w.value.type&&"host"!=w.value.type||(h.value[0].address=w.value.label)),V()})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),project_name:c,description:p,row:h,options:m,options1:_,options2:g,current_tree_node:w,add_services:S,ipRef:v,portRef:b,ipRules:[e=>null!=e&&1==W(e)||"Введите валидный IP-адрес"],portRules:[e=>null!=e&&e>=0&&e<=65535&&""!=e||"Введите валидный порт"],onDialogHide:t,search:k,filterFn:y,abortFilterFn:x,setModel:C,unicServices:V,services_name_icon:I,ValidateIPaddress:W,onOKClick(){v.value.validate(),b.value.validate(),v.value.hasError||b.value.hasError||S(s.state.current_project,JSON.stringify(h.value[0]))},onCancelClick:n}}};var N=t(1639),L=t(2074),B=t(4458),E=t(4526),K=t(136),$=t(8879),J=t(6858),Y=t(3190),G=t(3119),X=t(6384),ee=t(490),le=t(1233),te=t(335),ae=t(3115),oe=t(1821),ne=t(2146),ie=t(9984),se=t.n(ie);const re=(0,N.Z)(F,[["render",T]]),ue=re;se()(F,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(F,"directives",{ClosePopup:ne.Z});const de=(0,a.Uk)("Minimize"),ce=(0,a.Uk)("Maximize"),pe=(0,a.Uk)("Close"),me={class:"q-pa-md"},_e={class:"text-h6"},ge=(0,a.Uk)(" No results "),fe=["src"];function we(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-select"),g=(0,a.up)("q-img"),f=(0,a.up)("q-item-section"),w=(0,a.up)("q-item-label"),v=(0,a.up)("q-item"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[de])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[ce])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[pe])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",me,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",_e," Edit Service "+(0,o.zw)(n.prop1.address),1)])),_:1}),(0,a.Wm)(m,{id:"ip",filled:"",modelValue:n.prop1.address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.prop1.address=e),label:"String",hint:"IP-адрес",readonly:""},null,8,["modelValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.port,"onUpdate:modelValue":l[3]||(l[3]=e=>n.prop1.port=e),label:"Int",hint:"Порт",type:"number","lazy-rules":"",ref:"portRef",rules:n.portRules},null,8,["modelValue","rules"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.proto,"onUpdate:modelValue":l[4]||(l[4]=e=>n.prop1.proto=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"String",options:n.options,hint:"Протокол"},null,8,["modelValue","options"]),(0,a.Wm)(_,{filled:"","option-value":"value","option-label":"label","emit-value":"","map-options":"",modelValue:n.prop1.state,"onUpdate:modelValue":l[5]||(l[5]=e=>n.prop1.state=e),options:n.options1,label:"Text",hint:"Состояние","lazy-rules":""},null,8,["modelValue","options"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.name,"onUpdate:modelValue":l[6]||(l[6]=e=>n.prop1.name=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"String","emit-value":"",options:n.options2,onFilter:n.filterFn,onFilterAbort:n.abortFilterFn,onInputValue:n.setModel,hint:"Служба"},{option:(0,a.w5)((e=>[(0,a.Wm)(v,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(f,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"text-grey"},{default:(0,a.w5)((()=>[ge])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.prop1.name)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.prop1.name),style:{width:"25px",height:"25px"}},null,8,fe)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onFilterAbort","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.info,"onUpdate:modelValue":l[7]||(l[7]=e=>n.prop1.info=e),label:"String",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const ve=[],be={props:{selected_items:Object},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),c=((0,r.iH)(null),(0,r.iH)(["tcp","udp"])),p=(0,r.iH)([{label:'<span class="text-positive text-weight-bold">open</span>',value:"open",html:!0},{label:'<span class="text-brown-8 text-weight-bold">filtered</span>',value:"filtered",html:!0},{label:'<span class="text-negative text-weight-bold">closed</span>',value:"closed",html:!0},{label:'<span class="text-weight-bold">unknown</span>',value:"unknown",html:!0}]),m=((0,r.iH)(null),(0,r.iH)(ve)),_=(0,r.iH)([...ve]),g=(0,r.iH)(s.state.current_tree_node),f=(0,r.iH)(!1),w=(0,r.iH)(null);var v=null;const b=(0,r.iH)(JSON.parse(JSON.stringify(e.selected_items)));function h(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_service",{headers:e}).then((e=>{_.value=e.data.map((function(e){return{value:e.name,label:e.name,image:I(e.name)}}))})).catch((()=>{}))}function k(e,l,t){setTimeout((()=>{l((()=>{if(""===e)m.value=_.value;else{const l=e.toLocaleLowerCase();m.value=_.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function y(){console.log("delayed filter aborted")}function W(e){b.value.name=e}async function x(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/edit_service",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(v=b.value,o({prop:v}),(0,R.$)(i,"positive","Запись отредактирована","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{g.value=s.state.current_tree_node,h()})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),prop1:b,prop:v,readonly:f,portRef:w,current_tree_node:g,StringOptions:_,options:c,options1:p,options2:m,portRules:[e=>null!=e&&e>=0&&e<=65535&&""!=e||"Введите валидный порт"],unicServices:h,filterFn:k,abortFilterFn:y,setModel:W,onDialogHide:t,edit_services:x,services_name_icon:I,onOKClick(){w.value.validate(),w.value.hasError||x(s.state.current_project,JSON.stringify(b.value))},onCancelClick:n}}},he=(0,N.Z)(be,[["render",we]]),ke=he;se()(be,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(be,"directives",{ClosePopup:ne.Z});var ye=t(6646),We=t(5356);function xe(e,l){(0,q.Z)();const t=[l.map((e=>Ce(e.label)))].concat(e.value.filteredSortedRows.map((e=>l.map((l=>Ce("function"===typeof l.field?l.field(e):Ve(e[void 0===l.field?l.name:l.field]),l.format))).join(",")))).join("\r\n"),a=(0,ye.Z)(e.value.title+".csv","\ufeff"+t,"text/csv");!0!==a&&console.error("Error: "+a)}function Ce(e,l){let t=void 0!==l?l(e):e;return t=void 0===t||null===t?"":String(t),t=t.split('"').join('""'),`"${t}"`}function qe(e,l){(0,q.Z)();let t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',a="<thead>";Object.keys(e.value).length;a+="<tr>";for(let n in e.value.columns)a+="<th>"+e.value.columns[n].label+"</th>";a+="</tr>",a+="</thead>",a+="<tbody>",e.value.filteredSortedRows.map((function(e,l){a+="<tr>";for(let t in e)a+="<td>"+Se(Ve(e[t]))+"</td>";a+="</tr>"})),a+="</tbody>";const o=(0,ye.Z)(e.value.title+".xls","\ufeff"+t.replace("${table}",a).replace("${worksheet}",e.value.title),"text/xls");!0!==o&&console.error("Error: "+o)}function Ve(e){try{"object"==typeof e&&(e=JSON.stringify(JSON.parse(JSON.stringify(e)),null,2))}catch{}return e}function Se(e){return"string"==typeof e?e.replace(/\n/gi,"<br/>"):null==e?"".replace(/\n/gi,"<br/>"):e}const ze=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",align:"center",label:"IP",field:"address",sortable:!0},{name:"port",align:"center",label:"Порт",field:"port",sortable:!0,sort:(e,l)=>parseInt(e,10)-parseInt(l,10)},{name:"proto",align:"center",label:"Протокол",field:"proto",sortable:!0},{name:"state",align:"center",label:"Состояние",field:"state",sortable:!0},{name:"name",align:"center",label:"Служба",field:"name",sortable:!0},{name:"info",align:"center",label:"Информация",field:"info"},{name:"actions",label:"Actions",field:"actions"}],He=[],Ze={name:"PageIndex",setup(){const e=(0,u.oR)(),l=(0,r.iH)([]),t=(0,q.Z)(),o=(0,r.iH)(!1),n=((0,r.iH)(!1),(0,r.iH)([...He])),i=(0,r.iH)([...ze]),s=((0,r.iH)(null),(0,r.iH)(e.state.current_tree_node)),p=(0,r.iH)(!0),m=(0,r.iH)(!1),_=(0,r.iH)(""),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null);function v(){t.dialog({component:ue,componentProps:{}}).onOk((e=>{n.value.push(e.row.value[0])}))}function b(){m.value=!0;const l={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:e.state.current_project,node:c.DS.encode(JSON.stringify(e.state.current_tree_node))},headers:l}).then((e=>{n.value=e.data,m.value=!1})).catch((()=>{m.value=!1,(0,R.$)(t,"negative","Ошибка","Не удалось загрузить "+g.value.title,"report_problem")}))}function h(a){setTimeout((()=>{const o={Authorization:"Bearer "+e.state.current_user.token};d.api.post("/api/del_service",{workspace:e.state.current_project,data:a},{headers:o}).then((e=>{200==e.data.rsp_k?(n.value.splice(n.value.indexOf(a),1),l.value=l.value.filter((e=>e.id!=a.id)),(0,R.$)(t,"positive","Запись удалена","","done")):(0,R.$)(t,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,R.$)(t,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function k(){for(var e=l.value.filter((e=>e.id)),t=0;t<e.length;t++)h(e[t])}function y(){xe(g,ze)}function W(){qe(g,ze)}function x(e){var l=n.value.find((l=>l.id==e.id));t.dialog({component:ke,componentProps:{selected_items:l}}).onOk((e=>{if(void 0!=e){const l=n.value.findIndex((l=>l.id==e.prop.id));l>-1&&(n.value[l]=e.prop)}}))}function C(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function V(){}function S(e){l.value=e.rows}function z(){e.commit("SET_CURRENT_TAB","services")}function H(){return!(l.value.length>0)}return(0,a.YP)((()=>e.state.current_tree_node),(()=>{null!=e.state.current_tree_node&&(s.value=e.state.current_tree_node,b())})),(0,a.YP)((()=>e.state.current_tab),(()=>{"services"==e.state.current_tab?(f.value=e.state.current_tab,w.value="red"):w.value="grey"})),(0,a.bv)((()=>{"services"==e.state.current_tab?w.value="red":w.value="grey",b()})),{selected:l,columns:ze,Rows:n,store:e,tableSelectable:o,Columns:i,services_name_icon:I,additem:v,deleteItems:k,btn_disable:H,editItem:x,drawChip:C,deleteItem:h,set_current_tab:z,pin_color:w,current_tree_node:s,chiphost:p,removeChip:V,loadData:b,loading:m,handleSelectRow:S,filter:_,q_table:g,to_csv:y,to_xls:W,visibleColumns:(0,r.iH)(["address","desc","port","proto","state","name","info","actions"]),getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${He.length}`}}}};var Ue=t(6362),Qe=t(3246),Te=t(3175),De=t(7691),Re=t(2857),Pe=t(3532),je=t(1682),Ie=t(1221),Oe=t(2765),Ae=t(7220),Me=t(990);const Fe=(0,N.Z)(Ze,[["render",x]]),Ne=Fe;se()(Ze,"components",{QTable:C.Z,QBtn:$.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QToggle:Te.Z,QTooltip:J.Z,QChip:De.Z,QInput:G.Z,QIcon:Re.Z,QTr:Pe.Z,QTh:je.Z,QCheckbox:Ie.Z,QPopupProxy:Oe.Z,QTd:Ae.Z,QBadge:Me.Z}),se()(Ze,"directives",{ClosePopup:ne.Z});const Le=(0,a.Uk)("CSV "),Be=(0,a.Uk)("XLS "),Ee=(0,a.Uk)(" Выберите узлы "),Ke={class:"text-h4"},$e=(0,a.Uk)(" Hosts "),Je=(0,a.Uk)(" Закрепить компонент вверху "),Ye={key:0},Ge=(0,a._)("div",{align:"center"},"Visible Columns",-1),Xe={key:0},ll={key:0},tl={key:1},al={key:0},ol={key:2},nl={key:3,align:"right"},il={key:4};function sl(e,l,t,n,i,s){const r=(0,a.up)("q-btn"),u=(0,a.up)("q-img"),d=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),p=(0,a.up)("q-list"),m=(0,a.up)("q-menu"),_=(0,a.up)("q-tooltip"),g=(0,a.up)("q-toggle"),f=(0,a.up)("q-chip"),w=(0,a.up)("q-icon"),v=(0,a.up)("q-input"),b=(0,a.up)("q-checkbox"),h=(0,a.up)("q-th"),k=(0,a.up)("q-tr"),y=(0,a.up)("q-popup-proxy"),W=(0,a.up)("q-td"),x=(0,a.up)("q-table"),C=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(x,{title:"Сетевые узлы",rows:n.Rows,columns:n.columns,"row-key":"id",dense:"",ref:"q_table",selection:"multiple","selected-rows-label":n.getSelectedString,selected:n.selected,"onUpdate:selected":l[7]||(l[7]=e=>n.selected=e),onSelection:n.handleSelectRow,loading:n.loading,filter:n.filter,"virtual-scroll":"","visible-columns":n.visibleColumns},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(r,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:n.additem},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:n.deleteItems,disable:n.btn_disable()},null,8,["onClick","disable"]),(0,a.Wm)(r,{color:"blue","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[0]||(l[0]=e=>n.to_csv()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/csv.png"}),Le])),_:1})])),_:1})),[[C]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[1]||(l[1]=e=>n.to_xls()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/excel.png"}),Be])),_:1})])),_:1})),[[C]])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(r,{color:"primary","icon-right":"sell",label:"Tags","no-caps":"",size:"sm",class:"button-top",onClick:n.tags_show,disable:n.btn_disable()},{default:(0,a.w5)((()=>[0==n.selected.length?((0,a.wg)(),(0,a.j4)(_,{key:0,anchor:"bottom middle",self:"top middle",offset:[10,10]},{default:(0,a.w5)((()=>[Ee])),_:1})):(0,a.kq)("",!0)])),_:1},8,["onClick","disable"]),(0,a.Wm)(g,{modelValue:n.tableSelectable,"onUpdate:modelValue":l[2]||(l[2]=e=>n.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",Ke,[$e,(0,a.Wm)(r,{flat:"",round:"",color:n.pin_color,icon:"push_pin",onClick:l[3]||(l[3]=e=>n.set_current_tab())},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[Je])),_:1})])),_:1},8,["color"])]),0!=n.drawChip(n.current_tree_node)?((0,a.wg)(),(0,a.iD)("div",Ye,[(0,a.Wm)(f,{modelValue:n.chiphost,"onUpdate:modelValue":l[4]||(l[4]=e=>n.chiphost=e),icon:"subnets"===n.store.state.type_tree?"computer":"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(n.current_tree_node.label),1)])),_:1},8,["modelValue","icon"])])):(0,a.kq)("",!0),(0,a.Wm)(v,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[5]||(l[5]=e=>n.filter=e),placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(h,{key:0,align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),(0,a.Wm)(h),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(l=>((0,a.wg)(),(0,a.j4)(h,{key:l.name,props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,a.Wm)(y,{"context-menu":""},{default:(0,a.w5)((()=>[Ge,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.columns,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(g,{modelValue:n.visibleColumns,"onUpdate:modelValue":l[6]||(l[6]=e=>n.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e,class:(0,o.C_)({host_down:"down"==e.row.state})},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(W,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),1==n.user_settings.display_icon_osfamily?((0,a.wg)(),(0,a.j4)(W,{key:1},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"img-os_family",src:n.hosts_osfamily_icon(e.row.os_family)},null,8,["src"]),null!=e.row.virtual_host&&""!=e.row.virtual_host?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"img-os_family",src:"icons/os/vmware_.png"})):(0,a.kq)("",!0)])),_:2},1024)):((0,a.wg)(),(0,a.j4)(W,{key:2})),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,a.wg)(),(0,a.j4)(W,{key:l.name,align:"center"},{default:(0,a.w5)((()=>["purpose"==l.name&&1==n.user_settings.display_icon_purpose?((0,a.wg)(),(0,a.iD)("div",Xe,[null==l.value?((0,a.wg)(),(0,a.iD)("div",ll)):(0,a.kq)("",!0),(0,a.Wm)(u,{src:n.hosts_purpose_icon(l.value),class:"node_icon"},null,8,["src"]),(0,a.Uk)(" "+(0,o.zw)(l.value),1)])):"os_name"==l.name&&1==n.user_settings.display_icon_purpose?((0,a.wg)(),(0,a.iD)("div",tl,[null==l.value?((0,a.wg)(),(0,a.iD)("div",al)):(0,a.kq)("",!0),(0,a.Wm)(u,{src:n.hosts_os_name_icon(l.value),class:"node_icon"},null,8,["src"]),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"tags"==l.name?((0,a.wg)(),(0,a.iD)("div",ol,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.value,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[null!=e.id?((0,a.wg)(),(0,a.j4)(f,{key:e.id,color:"primary","text-color":"white",size:"sm",icon:"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.name),1)])),_:2},1024)):(0,a.kq)("",!0)])))),128))])):"actions"==l.name?((0,a.wg)(),(0,a.iD)("div",nl,[(0,a.Wm)(r,{color:"green","icon-right":"edit",onClick:l=>n.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",onClick:l=>n.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):((0,a.wg)(),(0,a.iD)("div",il,(0,o.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props","class"])])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const rl=(0,a.Uk)("Minimize"),ul=(0,a.Uk)("Maximize"),dl=(0,a.Uk)("Close"),cl={class:"q-pa-md"},pl=(0,a._)("div",{class:"text-h6"}," Add Hosts ",-1),ml=(0,a.Uk)(" No results "),_l=["src"],gl=(0,a.Uk)(" No results "),fl=["src"],wl=(0,a.Uk)(" No results "),vl=["src"];function bl(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-chip"),_=(0,a.up)("q-input"),g=(0,a.up)("q-select"),f=(0,a.up)("q-img"),w=(0,a.up)("q-item-section"),v=(0,a.up)("q-item-label"),b=(0,a.up)("q-item"),h=(0,a.up)("q-card-actions"),k=(0,a.up)("q-card"),y=(0,a.up)("q-dialog"),W=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(y,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[rl])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[ul])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[dl])),_:1})])),_:1})),[[W]])])),_:1}),(0,a._)("div",cl,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[pl])),_:1}),(0,a.Wm)(d,{flat:"",color:"green",icon:"add",label:"Add Tag",onClick:n.show_tag_dialog},null,8,["onClick"]),(0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.row[0].tags,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,style:{display:"inline"}},[null!=e.id?((0,a.wg)(),(0,a.j4)(m,{removable:"",onRemove:l=>n.remove_tag(e),key:e.id,color:"primary","text-color":"white",size:"md",icon:"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["onRemove"])):(0,a.kq)("",!0)])))),128))]),(0,a.Wm)(_,{id:"ip",filled:"",modelValue:n.row[0].address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.row[0].address=e),label:"Text",hint:"IP-адрес",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].mac,"onUpdate:modelValue":l[3]||(l[3]=e=>n.row[0].mac=e),label:"Text",hint:"Mac-адрес","lazy-rules":"",mask:"NN:NN:NN:NN:NN:NN","fill-mask":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].name,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].name=e),label:"Text",hint:"Имя хоста","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(g,{filled:"",modelValue:n.row[0].state,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].state=e),label:"Text",options:n.options,hint:"Состояние","lazy-rules":""},null,8,["modelValue","options"]),(0,a.Wm)(g,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:n.row[0].os_family,"onUpdate:modelValue":l[6]||(l[6]=e=>n.row[0].os_family=e),options:n.options1,label:"Text",hint:"Семейство ОС","lazy-rules":"",onFilter:n.filterFn,onInputValue:n.setModel,"emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(b,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(w,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(v,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-grey"},{default:(0,a.w5)((()=>[ml])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[(0,a._)("img",{src:n.hosts_osfamily_icon(n.row[0].os_family),style:{width:"25px",height:"25px"}},null,8,_l)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(g,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:n.row[0].os_name,"onUpdate:modelValue":l[7]||(l[7]=e=>n.row[0].os_name=e),options:n.options2,label:"Text",hint:"Наименование ОС","lazy-rules":"","emit-value":"",onFilter:n.filterFn_nameos,onInputValue:n.setModel__nameos},{option:(0,a.w5)((e=>[(0,a.Wm)(b,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(w,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{src:e.opt.image,style:{width:"25px",height:"25px"}},null,8,["src"])])),_:2},1024),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-grey"},{default:(0,a.w5)((()=>[gl])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.hosts_os_name_icon(n.row[0].os_name)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.hosts_os_name_icon(n.row[0].os_name),style:{width:"25px",height:"25px"}},null,8,fl)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].os_flavor,"onUpdate:modelValue":l[8]||(l[8]=e=>n.row[0].os_flavor=e),label:"Text",hint:"Тип ОС","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].os_sp,"onUpdate:modelValue":l[9]||(l[9]=e=>n.row[0].os_sp=e),label:"Text",hint:"ОС SP","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].os_lang,"onUpdate:modelValue":l[10]||(l[10]=e=>n.row[0].os_lang=e),label:"Text",hint:"Язык ОС","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].arch,"onUpdate:modelValue":l[11]||(l[11]=e=>n.row[0].arch=e),label:"Text",hint:"Архитектура","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(g,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:n.row[0].purpose,"onUpdate:modelValue":l[12]||(l[12]=e=>n.row[0].purpose=e),label:"Text",options:n.options3,hint:"Тип хоста","lazy-rules":"",onFilter:n.filterFn_purpose,onInputValue:n.setModel__purpose,"emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(b,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(w,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(v,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-grey"},{default:(0,a.w5)((()=>[wl])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[(0,a._)("img",{src:n.hosts_purpose_icon(n.row[0].purpose)},null,8,vl)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].virtual_host,"onUpdate:modelValue":l[13]||(l[13]=e=>n.row[0].virtual_host=e),label:"Text",hint:"Виртульный хост","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].info,"onUpdate:modelValue":l[14]||(l[14]=e=>n.row[0].info=e),label:"Text",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.row[0].comments,"onUpdate:modelValue":l[15]||(l[15]=e=>n.row[0].comments=e),label:"Text",hint:"Комментарий","lazy-rules":"",autogrow:""},null,8,["modelValue"])]),(0,a.Wm)(h,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const hl=(0,a.Uk)("Minimize"),kl=(0,a.Uk)("Maximize"),yl=(0,a.Uk)("Close"),Wl={class:"q-pa-md"},xl=(0,a._)("div",{class:"text-h6"}," Tags ",-1),Cl={key:0,style:{"padding-bottom":"40px","padding-top":"0px"}},ql=(0,a._)("div",{align:"center",class:"text-subtitle2"}," Добавить новый Тег в БД",-1),Vl={class:"row justify-end"},Sl=(0,a.Uk)(" No results "),zl={style:{"padding-top":"20px"}};function Hl(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-separator"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item"),w=(0,a.up)("q-item-label"),v=(0,a.up)("q-select"),b=(0,a.up)("q-chip"),h=(0,a.up)("expansion-item-hosts"),k=(0,a.up)("q-card-actions"),y=(0,a.up)("q-card"),W=(0,a.up)("q-dialog"),x=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(W,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[hl])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[kl])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[yl])),_:1})])),_:1})),[[x]])])),_:1}),(0,a._)("div",Wl,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[xl])),_:1}),(0,a.Wm)(d,{dense:"",flat:"",icon:n.btn_new_tag_prop.icon,label:n.btn_new_tag_prop.label,color:n.btn_new_tag_prop.color,onClick:l[2]||(l[2]=e=>n.new_tag_flag=!n.new_tag_flag)},null,8,["icon","label","color"]),1==n.new_tag_flag?((0,a.wg)(),(0,a.iD)("div",Cl,[ql,(0,a.Wm)(m,{hint:"Наименование Тега",modelValue:n.new_tag_value.name,"onUpdate:modelValue":l[3]||(l[3]=e=>n.new_tag_value.name=e)},null,8,["modelValue"]),(0,a.Wm)(m,{hint:"Описание Тега",modelValue:n.new_tag_value.desc,"onUpdate:modelValue":l[4]||(l[4]=e=>n.new_tag_value.desc=e)},null,8,["modelValue"]),(0,a._)("div",Vl,[(0,a.Wm)(d,{label:"Add",color:"green",onClick:l[5]||(l[5]=e=>n.add_new_tag(n.new_tag_value))})]),(0,a.Wm)(_)])):(0,a.kq)("",!0),(0,a.Wm)(v,{filled:"","use-input":"","input-debounce":"0",options:n.options2,onFilter:n.filterFn,"onUpdate:modelValue":n.setModel,hint:"Теги"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Sl])),_:1})])),_:1})])),option:(0,a.w5)((e=>[(0,a.Wm)(f,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["options","onFilter","onUpdate:modelValue"]),(0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.row.tags,(e=>((0,a.wg)(),(0,a.j4)(b,{removable:"",onRemove:l=>n.remove_chip(e),modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,key:e.id,icon:"sell","text-color":"white",color:"primary"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["onRemove","modelValue","onUpdate:modelValue"])))),128))]),(0,a._)("div",zl,["Table"==n.original_call?((0,a.wg)(),(0,a.j4)(h,{key:0,selected_hosts:n.row.hosts},null,8,["selected_hosts"])):(0,a.kq)("",!0)])]),(0,a.Wm)(k,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Zl={class:"text-grey-8 q-gutter-xs"};function Ul(e,l,t,n,i,s){const r=(0,a.up)("q-img"),u=(0,a.up)("q-item-section"),d=(0,a.up)("q-chip"),c=(0,a.up)("q-btn"),p=(0,a.up)("q-item"),m=(0,a.up)("q-expansion-item"),_=(0,a.up)("q-list"),g=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.j4)(_,{bordered:"",class:"rounded-borders"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{"expand-separator":"",icon:"computer",label:"Hosts",caption:"Выбранные узлы","default-opened":""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.items,(e=>(0,a.wy)(((0,a.wg)(),(0,a.j4)(p,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"img-os_family",src:n.hosts_osfamily_icon(e.os_family)},null,8,["src"]),null!=e.virtual_host&&""!=e.virtual_host?((0,a.wg)(),(0,a.j4)(r,{key:0,class:"img-os_family",src:"icons/os/vmware_.png"})):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.address),1)])),_:2},1024),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.name),1)])),_:2},1024),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,{src:n.hosts_purpose_icon(e.purpose),class:"node_icon"},null,8,["src"])])),_:2},1024),(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.tags,(e=>((0,a.wg)(),(0,a.iD)("div",null,[null!=e.id?((0,a.wg)(),(0,a.j4)(d,{key:e.id,color:"primary","text-color":"white",size:"sm",icon:"sell",removable:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.name),1)])),_:2},1024)):(0,a.kq)("",!0)])))),256))])),_:2},1024),(0,a.Wm)(u,{top:"",side:""},{default:(0,a.w5)((()=>[(0,a._)("div",Zl,[(0,a.Wm)(c,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"close",onClick:l=>n.remove_item(e)},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)),[[g]]))),256))])),_:1})])),_:1})}const Ql={props:{selected_hosts:Array},setup(e){const l=(0,r.iH)(e.selected_hosts);function t(e){l.value.splice(l.value.filter((l=>l.id=e.id)),1)}return{hosts_osfamily_icon:j,hosts_purpose_icon:P,remove_item:t,items:l}}};var Tl=t(651),Dl=t(1136);const Rl=(0,N.Z)(Ql,[["render",Ul]]),Pl=Rl;se()(Ql,"components",{QList:Qe.Z,QExpansionItem:Tl.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QChip:De.Z,QBtn:$.Z}),se()(Ql,"directives",{Ripple:Dl.Z});const jl=[],Il={props:{selected_hosts:Array,original_call:String},emits:[...D.Z.emits],components:{ExpansionItemHosts:Pl},setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),c=(0,r.iH)([]),p=(0,r.iH)(null),m=(0,r.iH)(jl),_=(0,r.iH)([...jl]),g=(0,r.iH)(e.original_call),f=(0,r.iH)({label:"New Tag",icon:"add",color:"green"}),w=(0,r.iH)(!1),v=(0,r.iH)({id:-1,hosts:JSON.parse(JSON.stringify(e.selected_hosts)),tags:[]}),b=(0,r.iH)({id:-1,name:"",desc:""});function h(e,l,t){setTimeout((()=>{l((()=>{if(""===e)m.value=_.value;else{const l=e.toLowerCase();m.value=_.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function k(e){v.value.tags.push({id:e.id,name:e.label,desc:e.descriptions}),m.value.find((l=>l.id==e.id)).disable=!0}function y(e){var l=v.value.tags.indexOf(v.value.tags.find((l=>l.id==e.id)));v.value.tags.splice(l,1),m.value.find((l=>l.id==e.id)).disable=!1}function W(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/get_tags",{params:{},headers:e}).then((e=>{c.value=[],e.data.forEach((e=>{_.value.push({label:e.name,description:e.desc,id:e.id})})),update()})).catch((()=>{}))}async function x(e){let l=new Promise(((l,t)=>{setTimeout((()=>{l(!1);const t={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/add_new_tag",{data:e},{headers:t}).then((e=>{200==e.data.rsp_k?(b.value.id=e.data.id,m.value.push({label:b.value.name,description:b.value.desc,id:b.value.id}),(0,R.$)(i,"positive","Тег добавлен","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),l(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),l(!1)}))}),1e3)})),t=await l;return t}async function C(e){let l=new Promise(((l,t)=>{setTimeout((()=>{l(!1);const t={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/add_tags_on_hosts",{data:e},{headers:t}).then((e=>{200==e.data.rsp_k?((0,R.$)(i,"positive","Тег добавлен","","done"),o({row:v})):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),l(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),l(!1)}))}),1e3)})),t=await l;return t}return(0,a.bv)((()=>{W()})),(0,a.YP)((()=>w.value),(()=>{1==w.value?(f.value.label="Close",f.value.icon="remove",f.value.color="primary"):(f.value.label="New Tag",f.value.icon="add",f.value.color="green")})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),row:v,original_call:g,load_tags:W,btn_new_tag_prop:f,new_tag_flag:w,new_tag_value:b,StringOptions:_,onDialogHide:t,add_tags_on_hosts:C,filterFn:h,remove_chip:y,options:c,options2:m,setModel:k,add_new_tag:x,dataRef:p,onOKClick(){try{if("Table"==g.value){var e={host_id:v.value.hosts.map((e=>e.id)),tag_id:v.value.tags.map((e=>e.id))};C(e)}else o({row:v})}catch(l){}},onCancelClick:n}}};var Ol=t(926);const Al=(0,N.Z)(Il,[["render",Hl]]),Ml=Al;se()(Il,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSeparator:Ol.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QItemLabel:ae.Z,QChip:De.Z,QCardActions:oe.Z}),se()(Il,"directives",{ClosePopup:ne.Z});const Fl=[{label:"Windows",value:"Windows",description:"Microsoft",image:"icons/os/windows.png"},{label:"Linux",value:"Linux",description:"Linux Kernel OS GNUGPL",image:"icons/os/Linux.png"},{label:"Unix",value:"Unix",description:"Unix OS",image:"icons/os/unix.png"},{label:"FreeBSD",value:"FreeBSD",description:"BSD",image:"icons/os/freebsd.png"},{label:"MacOS",value:"MacOS",description:"Apple MacOS, OSX",image:"icons/os/macos.png"},{label:"VMWare",value:"VMWare",description:"VMWare ESXI, vSphere",image:"icons/os/vmware.png"},{label:"Mikrotik",value:"Mikrotik",description:"Mikrotik RouterOS",image:"icons/os/mikrotik.png"},{label:"Cisco",value:"Cisco",description:"Cisco IOS",image:"icons/os/cisco.png"},{label:"HP",value:"HP",description:"HP devices",image:"icons/os/hp.png"},{label:"Huawei",value:"Huawei",description:"Huawei devices",image:"icons/os/huawei.png"},{label:"D-Link",value:"D-link",description:"D-Link devices",image:"icons/os/dlink.png"},{label:"TP-Link",value:"TP-link",description:"TP-Link devices",image:"icons/os/tplink.png"},{label:"Android",value:"Android",description:"Android OS",image:"icons/os/android.png"},{label:"iOS",value:"iOS",description:"Apple iOS",image:"icons/os/ios.png"},{label:"Unknown",value:"Unknown",description:"Unknown OS",image:"icons/unknown.png"}],Nl=[],Ll=[{label:"device",value:"device",description:"Другие устройства",image:"icons/purpose/device.png"},{label:"client",value:"client",description:"ПК",image:"icons/purpose/pc.png"},{label:"server",value:"server",description:"Сервер",image:"icons/purpose/server.png"},{label:"router",value:"router",description:"Маршрутизатор",image:"icons/purpose/router.png"},{label:"switch",value:"switch",description:"Коммутатор",image:"icons/purpose/switch.png"},{label:"printer",value:"printer",description:"Принтер",image:"icons/purpose/printer.png"},{label:"mfp",value:"mfp",description:"МФУ",image:"icons/purpose/mfp.png"},{label:"nas",value:"nas",description:"NAS",image:"icons/purpose/nas.png"},{label:"ip_camera",value:"ip_camera",description:"IP-камера",image:"icons/purpose/ip_camera.png"},{label:"wifi_router",value:"wifi_router",description:"Wifi-маршрутизатор",image:"icons/purpose/wifi_router.png"},{label:"voip_gw",value:"voip_gw",description:"VOIP шлюз",image:"icons/purpose/voip_gw.png"},{label:"voip_client",value:"voip_client",description:"Voip клиент",image:"icons/purpose/voip_client.png"},{label:"cloud_store",value:"cloud_store",description:"Облачное хранилище",image:"icons/purpose/cloud_store.png"},{label:"laptop",value:"laptop",description:"Ноутбук",image:"icons/purpose/laptop.png"},{label:"think_client",value:"think_client",description:"Тонкий клиент",image:"icons/purpose/client.png"},{label:"smart_phone",value:"smart_phone",description:"Смартфон",image:"icons/purpose/smart_phone.png"},{label:"tv",value:"tv",description:"Телевизор",image:"icons/purpose/tv.png"},{label:"firewall",value:"firewall",description:"Межсетевой экран(Firewall)",image:"icons/purpose/firewall.png"},{label:"UPS",value:"ups",description:"Источник бесперебойного питания",image:"icons/purpose/ups.png"},{label:"unknown",value:"unknown",description:"Неизвестное устройство",image:"icons/unknown.png"}],Bl={props:{current_host_prop:String,current_host_label_prop:String},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),c=(0,r.iH)(null),p=(0,r.iH)(null),m=(0,r.iH)(["alive","down"]),_=(0,r.iH)(Fl),g=(0,r.iH)(Nl),f=(0,r.iH)(Ll),w=(0,r.iH)(s.state.current_tree_node),v=(0,r.iH)(null),b=(0,r.iH)([{id:-1,address:"",mac:"",name:"",state:"alive",os_family:Fl[0],os_name:"",os_flavor:"",os_sp:"",os_lang:"",arch:"",purpose:"device",virtual_host:"",tags:[],info:"",comments:""}]);function h(e,l,t){l((()=>{const l=e.toLocaleLowerCase();_.value=Fl.filter((e=>e.label.toLocaleLowerCase().indexOf(l)>-1))}))}function k(e,l,t){l((()=>{const l=e.toLocaleLowerCase();f.value=Ll.filter((e=>e.label.toLocaleLowerCase().indexOf(l)>-1))}))}function y(e,l,t){setTimeout((()=>{l((()=>{const l={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_name_os",{params:{os_family:b.value[0].os_family},headers:l}).then((l=>{if(Nl.value=l.data.map((function(e){return{value:e.os_name,label:e.os_name,image:O(e.os_name)}})),""===e)g.value=Nl.value;else{const l=e.toLowerCase();g.value=Nl.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem")}))}))}),1500)}function W(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function x(){console.log("delayed filter aborted")}function C(e){b.value[0].os_family=e}function V(e){b.value[0].os_name=e}function S(e){b.value[0].purpose=e}async function z(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/add_host",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(b.value[0].id=e.data.id,o({row:b}),(0,R.$)(i,"positive","Запись добавлена","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}function H(e){var l=b.value[0].tags.indexOf(b.value[0].tags.find((l=>l.id==e.id)));b.value[0].tags.splice(l,1)}function Z(){i.dialog({component:Ml,componentProps:{selected_hosts:b,original_call:"Add"}}).onOk((e=>{b.value[0].tags=e.row.value.tags}))}return(0,a.bv)((()=>{w.value=s.state.current_tree_node,void 0!=w&&null!=w&&("subnet"!=w.value.type&&"host"!=w.value.type||(b.value[0].address=w.value.label),"purpose"==w.value.type&&(b.value[0].purpose=w.value.label))})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),project_name:c,description:p,row:b,options:m,options1:_,options2:g,options3:f,current_tree_node:w,ipRef:v,ipRules:[e=>null!=e&&1==W(e)||"Введите валидный IP-адрес"],onDialogHide:t,filterFn:h,filterFn_nameos:y,filterFn_purpose:k,show_tag_dialog:Z,abortFilterFn:x,setModel:C,setModel__nameos:V,setModel__purpose:S,add_hosts:z,remove_tag:H,hosts_purpose_icon:P,hosts_osfamily_icon:j,hosts_os_name_icon:O,ValidateIPaddress:W,onOKClick(){v.value.validate(),v.value.hasError||z(s.state.current_project,JSON.stringify(b.value[0]))},onCancelClick:n}}},El=(0,N.Z)(Bl,[["render",bl]]),Kl=El;se()(Bl,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QChip:De.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(Bl,"directives",{ClosePopup:ne.Z});const $l=(0,a.Uk)("Minimize"),Jl=(0,a.Uk)("Maximize"),Yl=(0,a.Uk)("Close"),Gl={class:"q-pa-md"},Xl={class:"text-h6"},et=(0,a.Uk)(" No results "),lt=["src"],tt=(0,a.Uk)(" No results "),at=["src"],ot=(0,a.Uk)(" No results "),nt=["src"];function it(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-chip"),_=(0,a.up)("q-input"),g=(0,a.up)("q-select"),f=(0,a.up)("q-img"),w=(0,a.up)("q-item-section"),v=(0,a.up)("q-item-label"),b=(0,a.up)("q-item"),h=(0,a.up)("q-card-actions"),k=(0,a.up)("q-card"),y=(0,a.up)("q-dialog"),W=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(y,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[$l])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Jl])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Yl])),_:1})])),_:1})),[[W]])])),_:1}),(0,a._)("div",Gl,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",Xl," Edit Hosts "+(0,o.zw)(n.prop1.address),1)])),_:1}),(0,a.Wm)(d,{flat:"",color:"green",icon:"add",label:"Add Tag",onClick:n.show_tag_dialog},null,8,["onClick"]),(0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.prop1.tags,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,style:{display:"inline"}},[null!=e.id?((0,a.wg)(),(0,a.j4)(m,{removable:"",onRemove:l=>n.remove_tag(e),key:e.id,color:"primary","text-color":"white",size:"md",icon:"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["onRemove"])):(0,a.kq)("",!0)])))),128))]),(0,a.Wm)(_,{id:"ip",filled:"",modelValue:n.prop1.address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.prop1.address=e),label:"Text",hint:"IP-адрес",ref:"ipRef",rules:n.ipRules,readonly:""},null,8,["modelValue","rules"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.mac,"onUpdate:modelValue":l[3]||(l[3]=e=>n.prop1.mac=e),label:"Text",hint:"Mac-адрес","lazy-rules":"",mask:"NN:NN:NN:NN:NN:NN","fill-mask":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.name,"onUpdate:modelValue":l[4]||(l[4]=e=>n.prop1.name=e),label:"Text",hint:"Имя хоста","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(g,{filled:"",modelValue:n.prop1.state,"onUpdate:modelValue":l[5]||(l[5]=e=>n.prop1.state=e),label:"Text",options:n.options,hint:"Состояние","lazy-rules":""},null,8,["modelValue","options"]),(0,a.Wm)(g,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:n.prop1.os_family,"onUpdate:modelValue":l[6]||(l[6]=e=>n.prop1.os_family=e),options:n.options1,label:"Text",hint:"Семейство ОС","lazy-rules":"",onFilter:n.filterFn,onInputValue:n.setModel,"emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(b,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(w,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(v,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-grey"},{default:(0,a.w5)((()=>[et])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[(0,a._)("img",{src:n.hosts_osfamily_icon(n.prop1.os_family),style:{width:"25px",height:"25px"}},null,8,lt)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(g,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:n.prop1.os_name,"onUpdate:modelValue":l[7]||(l[7]=e=>n.prop1.os_name=e),options:n.options2,label:"Text",hint:"Наименование ОС","lazy-rules":"","emit-value":"",onFilter:n.filterFn_nameos,onInputValue:n.setModel__nameos},{option:(0,a.w5)((e=>[(0,a.Wm)(b,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(w,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{src:e.opt.image,style:{width:"25px",height:"25px"}},null,8,["src"])])),_:2},1024),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-grey"},{default:(0,a.w5)((()=>[tt])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.hosts_os_name_icon(n.prop1.os_name)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.hosts_os_name_icon(n.prop1.os_name),style:{width:"25px",height:"25px"}},null,8,at)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.os_flavor,"onUpdate:modelValue":l[8]||(l[8]=e=>n.prop1.os_flavor=e),label:"Text",hint:"Тип ОС","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.os_sp,"onUpdate:modelValue":l[9]||(l[9]=e=>n.prop1.os_sp=e),label:"Text",hint:"ОС SP","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.os_lang,"onUpdate:modelValue":l[10]||(l[10]=e=>n.prop1.os_lang=e),label:"Text",hint:"Язык ОС","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.arch,"onUpdate:modelValue":l[11]||(l[11]=e=>n.prop1.arch=e),label:"Text",hint:"Архитектура","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(g,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:n.prop1.purpose,"onUpdate:modelValue":l[12]||(l[12]=e=>n.prop1.purpose=e),label:"Text",options:n.options3,hint:"Тип хоста","lazy-rules":"",onFilter:n.filterFn_purpose,onInputValue:n.setModel__purpose,"emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(b,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(w,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(v,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-grey"},{default:(0,a.w5)((()=>[ot])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[(0,a._)("img",{src:n.hosts_purpose_icon(n.prop1.purpose)},null,8,nt)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.virtual_host,"onUpdate:modelValue":l[13]||(l[13]=e=>n.prop1.virtual_host=e),label:"Text",hint:"Виртульный хост","lazy-rules":""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.info,"onUpdate:modelValue":l[14]||(l[14]=e=>n.prop1.info=e),label:"Text",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(_,{filled:"",modelValue:n.prop1.comments,"onUpdate:modelValue":l[15]||(l[15]=e=>n.prop1.comments=e),label:"Text",hint:"Комментарий","lazy-rules":"",autogrow:""},null,8,["modelValue"])]),(0,a.Wm)(h,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const st=[{label:"Windows",value:"Windows",description:"Microsoft",image:"icons/os/windows.png"},{label:"Linux",value:"Linux",description:"Linux Kernel OS GNUGPL",image:"icons/os/Linux.png"},{label:"Unix",value:"Unix",description:"Unix OS",image:"icons/os/unix.png"},{label:"FreeBSD",value:"FreeBSD",description:"BSD",image:"icons/os/freebsd.png"},{label:"MacOS",value:"MacOS",description:"Apple MacOS, OSX",image:"icons/os/macos.png"},{label:"VMWare",value:"VMWare",description:"VMWare ESXI, vSphere",image:"icons/os/vmware.png"},{label:"Mikrotik",value:"Mikrotik",description:"Mikrotik RouterOS",image:"icons/os/mikrotik.png"},{label:"Cisco",value:"Cisco",description:"Cisco IOS",image:"icons/os/cisco.png"},{label:"HP",value:"HP",description:"HP devices",image:"icons/os/hp.png"},{label:"Huawei",value:"Huawei",description:"Huawei devices",image:"icons/os/huawei.png"},{label:"D-Link",value:"D-link",description:"D-Link devices",image:"icons/os/dlink.png"},{label:"TP-Link",value:"TP-link",description:"TP-Link devices",image:"icons/os/tplink.png"},{label:"Android",value:"Android",description:"Android OS",image:"icons/os/android.png"},{label:"iOS",value:"iOS",description:"Apple iOS",image:"icons/os/ios.png"},{label:"Unknown",value:"Unknown",description:"Unknown OS",image:"icons/unknown.png"}],rt=[],ut=[{label:"device",value:"device",description:"Другие устройства",image:"icons/purpose/device.png"},{label:"client",value:"client",description:"ПК",image:"icons/purpose/pc.png"},{label:"server",value:"server",description:"Сервер",image:"icons/purpose/server.png"},{label:"router",value:"router",description:"Маршрутизатор",image:"icons/purpose/router.png"},{label:"switch",value:"switch",description:"Коммутатор",image:"icons/purpose/switch.png"},{label:"printer",value:"printer",description:"Принтер",image:"icons/purpose/printer.png"},{label:"mfp",value:"mfp",description:"МФУ",image:"icons/purpose/mfp.png"},{label:"nas",value:"nas",description:"NAS",image:"icons/purpose/nas.png"},{label:"ip_camera",value:"ip_camera",description:"IP-камера",image:"icons/purpose/ip_camera.png"},{label:"wifi_router",value:"wifi_router",description:"Wifi-маршрутизатор",image:"icons/purpose/wifi_router.png"},{label:"voip_gw",value:"voip_gw",description:"VOIP шлюз",image:"icons/purpose/voip_gw.png"},{label:"voip_client",value:"voip_client",description:"Voip клиент",image:"icons/purpose/voip_client.png"},{label:"cloud_store",value:"cloud_store",description:"Облачное хранилище",image:"icons/purpose/cloud_store.png"},{label:"laptop",value:"laptop",description:"Ноутбук",image:"icons/purpose/laptop.png"},{label:"think_client",value:"think_client",description:"Тонкий клиент",image:"icons/purpose/client.png"},{label:"smart_phone",value:"smart_phone",description:"Смартфон",image:"icons/purpose/smart_phone.png"},{label:"tv",value:"tv",description:"Телевизор",image:"icons/purpose/tv.png"},{label:"firewall",value:"firewall",description:"Межсетевой экран(Firewall)",image:"icons/purpose/firewall.png"},{label:"UPS",value:"ups",description:"Источник бесперебойного питания",image:"icons/purpose/ups.png"},{label:"unknown",value:"unknown",description:"Неизвестное устройство",image:"icons/unknown.png"}],dt={props:{selected_items:Object},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),c=(0,r.iH)(null),p=(0,r.iH)(null),m=(0,r.iH)(["alive","down"]),_=(0,r.iH)(st),g=(0,r.iH)(rt),f=(0,r.iH)(ut),w=(0,r.iH)(s.state.current_tree_node),v=(0,r.iH)(null),b=(0,r.iH)(JSON.parse(JSON.stringify(e.selected_items)));function h(e,l,t){l((()=>{const l=e.toLocaleLowerCase();_.value=st.filter((e=>e.label.toLocaleLowerCase().indexOf(l)>-1))}))}function k(e,l,t){l((()=>{const l=e.toLocaleLowerCase();f.value=ut.filter((e=>e.label.toLocaleLowerCase().indexOf(l)>-1))}))}function y(e,l,t){setTimeout((()=>{l((()=>{const l={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_name_os",{params:{os_family:b.value.os_family},headers:l}).then((l=>{if(rt.value=l.data.map((function(e){return{value:e.os_name,label:e.os_name,image:O(e.os_name)}})),""===e)g.value=rt.value;else{const l=e.toLowerCase();g.value=rt.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem")}))}))}),1500)}async function W(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/edit_host",{workspace:e,data:l},{headers:a}).then((e=>{if(200==e.data.rsp_k){var l=b.value;o({prop:l}),(0,R.$)(i,"positive","Запись отредактирована","","done")}else(0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem")}))}),1e3)})),a=await t;return a}function x(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function C(){console.log("delayed filter aborted")}function V(e){b.value.os_family=e}function S(e){b.value.os_name=e}function z(e){b.value.purpose=e}function H(e){var l=b.value.tags.indexOf(b.value.tags.find((l=>l.id==e.id)));b.value.tags.splice(l,1)}function Z(){i.dialog({component:Ml,componentProps:{selected_hosts:b,original_call:"Edit"}}).onOk((e=>{b.value.tags=e.row.value.tags}))}return(0,a.bv)((()=>{w.value=s.state.current_tree_node})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),project_name:c,description:p,prop1:b,options:m,options1:_,options2:g,options3:f,current_tree_node:w,ipRef:v,ipRules:[e=>null!=e&&1==x(e)||"Введите валидный IP-адрес"],onDialogHide:t,remove_tag:H,hosts_purpose_icon:P,hosts_osfamily_icon:j,hosts_os_name_icon:O,edit_hosts:W,filterFn:h,filterFn_nameos:y,filterFn_purpose:k,abortFilterFn:C,setModel:V,setModel__nameos:S,setModel__purpose:z,show_tag_dialog:Z,ValidateIPaddress:x,onOKClick(){if(v.value.validate(),v.value.hasError);else{var e=JSON.stringify(b.value);W(s.state.current_project,e)}},onCancelClick:n}}},ct=(0,N.Z)(dt,[["render",it]]),pt=ct;se()(dt,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QChip:De.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(dt,"directives",{ClosePopup:ne.Z});var mt=t(9082),_t=t(4409);const gt=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",label:"IP",align:"center",field:"address",sortable:!0},{name:"mac",label:"MAC",align:"center",field:"mac",sortable:!0},{name:"name",label:"Имя хоста",align:"center",field:"name",sortable:!0},{name:"state",label:"Состояние",align:"center",field:"state",sortable:!0},{name:"os_family",label:"Семейство ОС",align:"center",field:"os_family",sortable:!0},{name:"os_name",label:"Наименование ОС",align:"center",field:"os_name",sortable:!0},{name:"os_flavor",label:"Тип ОС",align:"center",field:"os_flavor",sortable:!0},{name:"os_sp",label:"ОС SP",align:"center",field:"os_sp",sortable:!0},{name:"os_lang",label:"Язык ОС",align:"center",field:"os_lang",sortable:!0},{name:"arch",label:"Архитектура",align:"center",field:"arch",sortable:!0},{name:"purpose",label:"Тип хоста",align:"center",field:"purpose",sortable:!0},{name:"virtual_host",label:"Виртуализация",align:"center",field:"virtual_host",sortable:!0},{name:"tags",label:"Теги",align:"center",field:"tags",sortable:!0},{name:"info",label:"Информация",align:"center",field:"info",sortable:!0},{name:"comments",label:"Комментарий",align:"center",field:"comments",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],ft=[],wt={name:"TableHost",emits:["add_host","edit_host","del_host"],props:{},setup(e,{emit:l}){const t=(0,u.oR)(),o=(0,r.iH)([]),n=(0,r.iH)(!1),i=(0,q.Z)(),s=((0,r.iH)(!1),(0,r.iH)([...ft])),p=((0,r.iH)(null),(0,r.iH)(t.state.users),(0,r.iH)(t.state.current_tree_node)),m=(0,r.iH)(""),_=(0,r.iH)(t.state.user_settings),g=(0,r.iH)(!0),f=(0,r.iH)(!1),w=(0,r.iH)(""),v=(0,r.iH)(null),b=(0,r.iH)(null),h=(0,r.iH)(null);function k(){i.dialog({component:Kl,componentProps:{}}).onOk((e=>{s.value.push(e.row.value[0]),l("add_host",e.row.value[0])}))}function y(){var e=JSON.parse(JSON.stringify(o.value));i.dialog({component:Ml,componentProps:{selected_hosts:e,original_call:"Table"}}).onOk((e=>{}))}function W(){f.value=!0;const e={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/api/get_hosts",{params:{workspace:t.state.current_project,node:c.DS.encode(JSON.stringify(t.state.current_tree_node))},headers:e}).then((e=>{s.value=e.data,f.value=!1})).catch((()=>{f.value=!1,(0,R.$)(i,"negative","Ошибка","Не удалось загрузить "+v.value.title,"report_problem")}))}function x(e){setTimeout((()=>{const l={Authorization:"Bearer "+t.state.current_user.token};d.api.post("/api/del_host",{workspace:t.state.current_project,data:e},{headers:l}).then((l=>{if(200==l.data.rsp_k)Array.isArray(e)?e.forEach((function(e){s.value.splice(s.value.filter((l=>l.id=e)),1),o.value.splice(o.value.filter((l=>l.id=e)),1)})):(s.value.splice(s.value.indexOf(e),1),o.value=[],t.commit("SET_EVENT_HOST",{event:"del_host",data:e})),(0,R.$)(i,"positive","Запись удалена","","done");else if(210==l.data.rsp_k){if(Array.isArray(e)){var a=[];try{a=_t._.difference(e,l.data.data)}catch(n){}a.forEach((function(e){s.value.splice(s.value.filter((l=>l.id=e)),1),o.value.splice(o.value.filter((l=>l.id=e)),1)})),(0,R.$)(i,"warning","Запись удалена","","done")}}else(0,R.$)(i,"negative","Ошибка",l.data.message,"report_problem")})).catch((()=>{(0,R.$)(i,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function C(){return!(o.value.length>0)}function V(){for(var e=o.value.filter((e=>e.id)),l=[],t=0;t<e.length;t++)l.push(e[t].id);x(l)}function S(e){var l=s.value.find((l=>l.id==e.id));i.dialog({component:pt,componentProps:{selected_items:l}}).onOk((e=>{if(void 0!=e){const l=s.value.findIndex((l=>l.id==e.prop.id));l>-1&&(s.value[l]=e.prop),t.commit("SET_EVENT_HOST",{event:"edit_host",data:e.prop})}}))}function z(){xe(v,gt)}function H(){qe(v,gt)}function Z(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function U(e){o.value=e.rows}function Q(){i.dialog({component:mt.Z,componentProps:{url:"/upload",name:v.title}}).onOk((e=>{}))}function T(){t.commit("SET_CURRENT_TAB","hosts")}return(0,a.YP)((()=>t.state.user_settings),(()=>{null!=t.state.user_settings&&(_.value=t.state.user_settings)})),(0,a.YP)((()=>t.state.current_tree_node),(()=>{p.value=t.state.current_tree_node,W()})),(0,a.YP)((()=>n.value),(()=>{0==n.value&&(o.value=[])})),(0,a.YP)((()=>t.state.current_tab),(()=>{"hosts"==t.state.current_tab?(b.value=t.state.current_tab,h.value="red"):h.value="grey"})),(0,a.bv)((()=>{"hosts"==t.state.current_tab?h.value="red":h.value="grey",null==t.state.current_user.token&&t.commit("SET_CURRENT_USER",JSON.parse(localStorage["user"])),W()})),{selected:o,store:t,columns:gt,tableSelectable:n,Rows:s,user_settings:_,additem:k,editItem:S,deleteItem:x,drawChip:Z,tags_show:y,importFile:Q,to_csv:z,to_xls:H,set_current_tab:T,btn_disable:C,deleteItems:V,hosts_osfamily_icon:j,hosts_purpose_icon:P,hosts_os_name_icon:O,pin_color:h,chiphost:g,current_tree_node:p,current_service:m,loading:f,filter:w,q_table:v,handleSelectRow:U,visibleColumns:(0,r.iH)(["address","desc","name","os_family","os_name","purpose","tags","info","comments","actions"]),getSelectedString(){return 0===o.value.length?"":`${o.value.length} record${o.value.length>1?"s":""} selected of ${ft.length}`},pagination:(0,r.iH)({rowsPerPage:0})}}};var vt=t(3837);const bt=(0,N.Z)(wt,[["render",sl]]),ht=bt;se()(wt,"components",{QTable:C.Z,QBtn:$.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QTooltip:J.Z,QFile:vt.Z,QIcon:Re.Z,QToggle:Te.Z,QChip:De.Z,QInput:G.Z,QTr:Pe.Z,QTh:je.Z,QCheckbox:Ie.Z,QPopupProxy:Oe.Z,QTd:Ae.Z}),se()(wt,"directives",{ClosePopup:ne.Z});const kt=(0,a.Uk)("CSV "),yt=(0,a.Uk)("XLS "),Wt={class:"text-h4"},xt=(0,a.Uk)(" Notes "),Ct=(0,a.Uk)(" Закрепить компонент вверху "),qt={key:0},Vt=(0,a._)("div",{align:"center"},"Visible Columns",-1),St={key:0},zt={key:1},Ht={key:2,class:"truncate-text"},Zt={key:3,align:"right"},Ut={key:4};function Qt(e,l,t,n,i,s){const r=(0,a.up)("q-btn"),u=(0,a.up)("q-img"),d=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),p=(0,a.up)("q-list"),m=(0,a.up)("q-menu"),_=(0,a.up)("q-toggle"),g=(0,a.up)("q-tooltip"),f=(0,a.up)("q-chip"),w=(0,a.up)("q-icon"),v=(0,a.up)("q-input"),b=(0,a.up)("q-checkbox"),h=(0,a.up)("q-th"),k=(0,a.up)("q-tr"),y=(0,a.up)("q-popup-proxy"),W=(0,a.up)("q-td"),x=(0,a.up)("q-table"),C=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(x,{title:"Заметки",rows:n.Rows,columns:n.columns,"row-key":"id",ref:"q_table",selection:"multiple","selected-rows-label":n.getSelectedString,selected:n.selected,"onUpdate:selected":l[8]||(l[8]=e=>n.selected=e),onSelection:n.handleSelectRow,dense:"",loading:n.loading,filter:n.filter,"virtual-scroll":"","visible-columns":n.visibleColumns},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(r,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:n.additem},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:n.deleteItems,disable:n.btn_disable()},null,8,["onClick","disable"]),(0,a.Wm)(r,{color:"blue","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[0]||(l[0]=e=>n.to_csv()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/csv.png"}),kt])),_:1})])),_:1})),[[C]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[1]||(l[1]=e=>n.to_xls()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/excel.png"}),yt])),_:1})])),_:1})),[[C]])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{modelValue:n.tableSelectable,"onUpdate:modelValue":l[2]||(l[2]=e=>n.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",Wt,[xt,(0,a.Wm)(r,{flat:"",round:"",color:n.pin_color,icon:"push_pin",onClick:l[3]||(l[3]=e=>n.set_current_tab())},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[Ct])),_:1})])),_:1},8,["color"])]),0!=n.drawChip(n.current_tree_node)?((0,a.wg)(),(0,a.iD)("div",qt,[(0,a.Wm)(f,{modelValue:n.chiphost,"onUpdate:modelValue":l[4]||(l[4]=e=>n.chiphost=e),onRemove:l[5]||(l[5]=l=>e.removeChip()),icon:"subnets"===n.store.state.type_tree?"computer":"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(n.current_tree_node.label),1)])),_:1},8,["modelValue","icon"])])):(0,a.kq)("",!0),(0,a.Wm)(v,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[6]||(l[6]=e=>n.filter=e),placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(h,{key:0,align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(l=>((0,a.wg)(),(0,a.j4)(h,{key:l.name,props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,a.Wm)(y,{"context-menu":""},{default:(0,a.w5)((()=>[Vt,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.columns,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(_,{modelValue:n.visibleColumns,"onUpdate:modelValue":l[7]||(l[7]=e=>n.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(W,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,a.wg)(),(0,a.j4)(W,{key:l.name,align:"center"},{default:(0,a.w5)((()=>["name"==l.name?((0,a.wg)(),(0,a.iD)("div",St,[null!=n.services_name_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.services_name_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"ntype"==l.name?((0,a.wg)(),(0,a.iD)("div",zt,[null!=n.notes_type_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.notes_type_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,o.zw)(l.value),1)])):"data"==l.name?((0,a.wg)(),(0,a.iD)("div",Ht,(0,o.zw)(l.value),1)):"actions"==l.name?((0,a.wg)(),(0,a.iD)("div",Zt,[(0,a.Wm)(r,{color:"green","icon-right":"edit",onClick:l=>n.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",onClick:l=>n.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):((0,a.wg)(),(0,a.iD)("div",Ut,(0,o.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const Tt=(0,a.Uk)("Minimize"),Dt=(0,a.Uk)("Maximize"),Rt=(0,a.Uk)("Close"),Pt={class:"q-pa-md"},jt=(0,a._)("div",{class:"text-h6"}," Add Notes ",-1),It=(0,a.Uk)(" No results "),Ot=["src"],At=(0,a.Uk)(" No results "),Mt=["src"];function Ft(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Tt])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Dt])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Rt])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",Pt,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[jt])),_:1}),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.row[0].address=e),label:"Text",hint:"IP","lazy-rules":"",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"]),(0,a.Wm)(v,{modelValue:n.row[0].port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.row[0].port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.row[0].name,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[It])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.row[0].name)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.row[0].name),style:{width:"25px",height:"25px"}},null,8,Ot)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(v,{filled:"",modelValue:n.row[0].ntype,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].ntype=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Text","emit-value":"",options:n.options1,onFilter:n.filterFn1,onFilterAbort:n.abortFilterFn,onInputValue:n.setModel1,hint:"Тип записи"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[At])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.notes_type_icon(n.row[0].ntype)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.notes_type_icon(n.row[0].ntype),style:{width:"25px",height:"25px"}},null,8,Mt)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onFilterAbort","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].data,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].data=e),label:"Text",hint:"Данные","lazy-rules":"",autogrow:"",ref:"dataRef",rules:n.dataRules},null,8,["modelValue","rules"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Nt=[],Lt={props:{},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)(null),m=(0,r.iH)(null),_=(0,r.iH)([]),g=(0,r.iH)(Nt),f=(0,r.iH)([...Nt]),w=(0,r.iH)(null),v=(0,r.iH)(null),b=(0,r.iH)("Text"),h=(0,r.iH)(s.state.current_tree_node),k=(0,r.iH)(null),y=(0,r.iH)([{id:-1,address:"",port:"",proto:"",name:"",ntype:"",data:""}]);function W(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}function x(e,l,t){w.value.validate(),w.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:y.value[0].address}))},headers:e}).then((e=>{_.value=[],e.data.forEach((e=>{_.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function C(e,l,t){setTimeout((()=>{l((()=>{if(""===e)g.value=f.value;else{const l=e.toLocaleLowerCase();g.value=f.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function V(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_ntype",{headers:e}).then((e=>{f.value=e.data.map((function(e){return{value:e.ntype,label:e.ntype,image:A(e.ntype)}}))})).catch((()=>{}))}function S(e){null!=e?(k.value=e.service_id,y.value[0].port=e.port,y.value[0].name=e.name,y.value[0].proto=e.proto):(k.value=e,y.value[0].port=e,y.value[0].name=e,y.value[0].proto=e)}function z(e){y.value[0].ntype=e}function H(){console.log("delayed filter aborted")}function Z(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function U(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/add_note",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(y.value[0].id=e.data.id,o({row:y}),(0,R.$)(i,"positive","Запись добавлена","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{h.value=s.state.current_tree_node,void 0!=h&&null!=h&&("subnet"!=h.value.type&&"host"!=h.value.type||(y.value[0].address=h.value.label)),V()})),(0,a.YP)((()=>y.value[0].data),(()=>{b.value=W(y.value[0].data)})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),project_name:p,description:m,row:y,type_data:b,service_id:k,current_tree_node:h,ipRef:w,dataRef:v,options:_,options1:g,StringOptions:f,ipRules:[e=>null!=e&&1==Z(e)||"Введите валидный IP-адрес"],dataRules:[e=>null!=e&&""!=e||"Поле дата не должно быть пустым"],filterFn:x,filterFn1:C,abortFilterFn:H,setModel:S,setModel1:z,add_notes:U,onDialogHide:t,services_name_icon:I,notes_type_icon:A,unicNtype:V,ValidateIPaddress:Z,onOKClick(){w.value.validate(),v.value.validate(),w.value.hasError||v.value.hasError||U(s.state.current_project,JSON.stringify(y.value[0],(function(e,l){if("data"==e)try{l=c.DS.fromUint8Array((0,We.$w)(JSON.parse(l)).buffer,!0)}catch{l=c.DS.encode(l,!0)}return l})))},onCancelClick:n}}},Bt=(0,N.Z)(Lt,[["render",Ft]]),Et=Bt;se()(Lt,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(Lt,"directives",{ClosePopup:ne.Z});const Kt=(0,a.Uk)("Minimize"),$t=(0,a.Uk)("Maximize"),Jt=(0,a.Uk)("Close"),Yt={class:"q-pa-md"},Gt={class:"text-h6"},Xt=(0,a.Uk)(" No results "),ea=["src"],la=(0,a.Uk)(" No results "),ta=["src"];function aa(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Kt])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[$t])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Jt])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",Yt,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",Gt," Edit Notes "+(0,o.zw)(n.prop1.address),1)])),_:1}),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.prop1.address=e),label:"",hint:"IP","lazy-rules":"",ref:"ipRef",rules:n.ipRules,readonly:""},null,8,["modelValue","rules"]),(0,a.Wm)(v,{modelValue:n.prop1.port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.prop1.port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.prop1.name,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Xt])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.prop1.name)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.prop1.name),style:{width:"25px",height:"25px"}},null,8,ea)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(v,{filled:"",modelValue:n.prop1.ntype,"onUpdate:modelValue":l[4]||(l[4]=e=>n.prop1.ntype=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Text","emit-value":"",options:n.options1,onFilter:n.filterFn1,onInputValue:n.setModel1,hint:"Тип записи"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[la])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.notes_type_icon(n.prop1.ntype)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.notes_type_icon(n.prop1.ntype),style:{width:"25px",height:"25px"}},null,8,ta)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.data,"onUpdate:modelValue":l[5]||(l[5]=e=>n.prop1.data=e),label:n.type_data,hint:"Данные","lazy-rules":"",autogrow:"",ref:"dataRef",rules:n.dataRules},null,8,["modelValue","label","rules"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const oa=[],na={props:{selected_items:Object},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)([]),m=(0,r.iH)(oa),_=(0,r.iH)([...oa]),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null),v=(0,r.iH)("Text");var b=null;const h=(0,r.iH)(s.state.current_tree_node),k=(0,r.iH)(JSON.parse(JSON.stringify(e.selected_items)));try{"object"==typeof k.value.data&&(v.value="JSON",k.value.data=JSON.stringify(JSON.parse(JSON.stringify(k.value.data)),null,2))}catch(U){v.value="Text"}const y=(0,r.iH)(null);function W(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}function x(e,l,t){g.value.validate(),g.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:k.value.address}))},headers:e}).then((e=>{p.value=[],e.data.forEach((e=>{p.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function C(e,l,t){setTimeout((()=>{l((()=>{if(""===e)m.value=_.value;else{const l=e.toLocaleLowerCase();m.value=_.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function V(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_ntype",{headers:e}).then((e=>{_.value=e.data.map((function(e){return{value:e.ntype,label:e.ntype,image:A(e.ntype)}}))})).catch((()=>{}))}function S(e){null!=e?(y.value=e.service_id,k.value.port=e.port,k.value.name=e.name,k.value.proto=e.proto):(y.value=e,k.value.port=e,k.value.name=e,k.value.proto=e)}function z(e){k.value.ntype=e}function H(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function Z(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/edit_note",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(b=k.value,o({prop:b}),(0,R.$)(i,"positive","Запись отредактирована","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{h.value=s.state.current_tree_node,v.value=W(k.value.data),V()})),(0,a.YP)((()=>k.value.data),(()=>{v.value=W(k.value.data)})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),prop1:k,prop:b,type_data:v,current_tree_node:h,options:p,options1:m,StringOptions:_,service_id:y,ipRef:g,dataRef:w,portRef:f,ipRules:[e=>null!=e&&1==H(e)||"Введите валидный IP-адрес"],dataRules:[e=>null!=e&&""!=e||"Поле дата не должно быть пустым"],filterFn:x,filterFn1:C,setModel:S,setModel1:z,ValidateIPaddress:H,edit_notes:Z,unicNtype:V,services_name_icon:I,notes_type_icon:A,onDialogHide:t,onOKClick(){g.value.validate(),w.value.validate(),g.value.hasError||w.value.hasError||Z(s.state.current_project,JSON.stringify(k.value,(function(e,l){if("data"==e)try{l=c.DS.fromUint8Array((0,We.$w)(JSON.parse(l)).buffer,!0)}catch{l=c.DS.encode(l,!0)}return l})))},onCancelClick:n}}},ia=(0,N.Z)(na,[["render",aa]]),sa=ia;se()(na,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(na,"directives",{ClosePopup:ne.Z});const ra=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",label:"IP",align:"center",field:"address",sortable:!0},{name:"port",label:"Порт",align:"center",field:"port",sortable:!0},{name:"proto",label:"Протокол",align:"center",field:"proto",sortable:!0},{name:"name",label:"Служба",align:"center",field:"name",sortable:!0},{name:"ntype",label:"Тип",align:"center",field:"ntype",sortable:!0},{name:"data",label:"Данные",align:"center",field:"data"},{name:"actions",label:"Actions",field:"actions"}],ua=[],da={name:"PageIndex",setup(){const e=(0,u.oR)(),l=(0,r.iH)([]),t=(0,r.iH)(!1),o=(0,q.Z)(),n=((0,r.iH)(!1),(0,r.iH)([...ua])),i=((0,r.iH)(null),(0,r.iH)(e.state.users),(0,r.iH)(e.state.current_tree_node)),s=(0,r.iH)(e.state.current_service),p=(0,r.iH)(!0),m=(0,r.iH)(!1),_=(0,r.iH)(""),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null);function v(){o.dialog({component:Et,componentProps:{}}).onOk((e=>{n.value.push(e.row.value[0])}))}function b(){m.value=!0;const l={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_notes",{params:{workspace:e.state.current_project,node:c.DS.encode(JSON.stringify(e.state.current_tree_node))},headers:l}).then((e=>{n.value=e.data,n.value.forEach((e=>{new TextEncoder;try{e.data=(0,We.zD)(c.DS.toUint8Array(e.data).buffer,{hashToJS:!0})}catch(l){e.data=c.DS.decode(e.data)}})),m.value=!1})).catch((()=>{m.value=!1,(0,R.$)(o,"negative","Ошибка","Не удалось загрузить "+g.value.title,"report_problem")}))}function h(t){setTimeout((()=>{const a={Authorization:"Bearer "+e.state.current_user.token};d.api.post("/api/del_note",{workspace:e.state.current_project,data:t},{headers:a}).then((e=>{200==e.data.rsp_k?(n.value.splice(n.value.indexOf(t),1),l.value=l.value.filter((e=>e.id!=t.id)),(0,R.$)(o,"positive","Запись удалена","","done")):(0,R.$)(o,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,R.$)(o,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function k(){for(var e=l.value.filter((e=>e.id)),t=0;t<e.length;t++)h(e[t])}function y(e){var l=n.value.find((l=>l.id==e.id));o.dialog({component:sa,componentProps:{selected_items:l}}).onOk((e=>{if(void 0!=e){const l=n.value.findIndex((l=>l.id==e.prop.id));l>-1&&(n.value[l]=e.prop)}}))}function W(){xe(g,ra)}function x(){qe(g,ra)}function C(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function V(e){l.value=e.rows}function S(){e.commit("SET_CURRENT_TAB","notes")}function z(){return!(l.value.length>0)}return(0,a.YP)((()=>e.state.current_tree_node),(()=>{null!=e.state.current_tree_node&&(i.value=e.state.current_tree_node,b())})),(0,a.YP)((()=>e.state.current_tab),(()=>{"notes"==e.state.current_tab?(f.value=e.state.current_tab,w.value="red"):w.value="grey"})),(0,a.bv)((()=>{"notes"==e.state.current_tab?w.value="red":w.value="grey",b()})),{selected:l,columns:ra,Rows:n,additem:v,editItem:y,deleteItem:h,drawChip:C,deleteItems:k,set_current_tab:S,btn_disable:z,services_name_icon:I,notes_type_icon:A,pin_color:w,store:e,chiphost:p,current_service:s,current_tree_node:i,loading:m,filter:_,q_table:g,handleSelectRow:V,tableSelectable:t,to_csv:W,to_xls:x,visibleColumns:(0,r.iH)(["address","port","name","ntype","data","actions"]),getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${ua.length}`},pagination:(0,r.iH)({rowsPerPage:0})}}},ca=(0,N.Z)(da,[["render",Qt]]),pa=ca;se()(da,"components",{QTable:C.Z,QBtn:$.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QToggle:Te.Z,QTooltip:J.Z,QChip:De.Z,QInput:G.Z,QIcon:Re.Z,QTr:Pe.Z,QTh:je.Z,QCheckbox:Ie.Z,QPopupProxy:Oe.Z,QTd:Ae.Z}),se()(da,"directives",{ClosePopup:ne.Z});const ma={class:"tree_margin"},_a={key:1,class:"",style:{display:"inline-block"}},ga={key:0},fa={key:1},wa={key:2},va=(0,a._)("br",null,null,-1),ba=(0,a._)("br",null,null,-1),ha=(0,a._)("br",null,null,-1),ka={key:3},ya=(0,a._)("br",null,null,-1),Wa={key:4},xa=(0,a._)("br",null,null,-1),Ca=(0,a._)("br",null,null,-1),qa=(0,a._)("br",null,null,-1),Va=(0,a._)("br",null,null,-1),Sa=(0,a._)("br",null,null,-1),za=(0,a._)("br",null,null,-1),Ha={key:2},Za={key:3,style:{color:"red"}},Ua={key:4,style:{color:"black"}},Qa=(0,a.Uk)("Обновить"),Ta=(0,a.Uk)("Nmap"),Da=(0,a.Uk)("Выделить узлы"),Ra=(0,a.Uk)("Маска сети"),Pa=(0,a.Uk)("Выход");function ja(e,l,t,n,i,s){const r=(0,a.up)("q-icon"),u=(0,a.up)("q-input"),d=(0,a.up)("q-checkbox"),c=(0,a.up)("q-img"),p=(0,a.up)("q-tooltip"),m=(0,a.up)("q-item-section"),_=(0,a.up)("q-item"),g=(0,a.up)("q-separator"),f=(0,a.up)("q-list"),w=(0,a.up)("q-menu"),v=(0,a.up)("q-tree"),b=(0,a.up)("q-scroll-area"),h=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(b,{style:{height:"919px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[0]||(l[0]=e=>n.filter=e),ref:"filterRef",placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"search"})])),_:1},8,["modelValue"]),(0,a._)("div",ma,[(0,a.Wm)(v,{nodes:n.Items,"no-transition":"",ref:"treeRef","node-key":"id",filter:n.filter,"default-expand-all":"","filter-method":n.myFilterMethod,"selected-color":"primary",selected:n.selected,"onUpdate:selected":[l[1]||(l[1]=e=>n.selected=e),l[3]||(l[3]=e=>n.handleSelectItem(n.selected))],expanded:n.expanded,"onUpdate:expanded":l[2]||(l[2]=e=>n.expanded=e),onLazyLoad:n.onLazyLoad,dense:""},{"default-header":(0,a.w5)((({node:e})=>[1==n.f_ticked?((0,a.wg)(),(0,a.j4)(d,{key:0,modelValue:e.ticked,"onUpdate:modelValue":l=>e.ticked=l,onClick:l=>n.sel_ticked(e),size:"xs"},null,8,["modelValue","onUpdate:modelValue","onClick"])):(0,a.kq)("",!0),1==n.user_settings.display_icon_tree_hosts?((0,a.wg)(),(0,a.iD)("div",_a,["root"==e.type?((0,a.wg)(),(0,a.iD)("div",ga,[(0,a.Wm)(c,{src:"icons/directory.png",class:"node_icon"})])):"subnet"==e.type?((0,a.wg)(),(0,a.iD)("div",fa,[(0,a.Wm)(c,{src:"icons/network.png",class:"node_icon"})])):"tag"==e.type?((0,a.wg)(),(0,a.iD)("div",wa,[(0,a.Wm)(c,{src:"icons/tag.png",class:"node_icon"}),(0,a.Wm)(p,{offset:[0,10],"max-width":"250px"},{default:(0,a.w5)((()=>[(0,a.Uk)(" TagID - "+(0,o.zw)(e.tag_id)+" ",1),va,(0,a.Uk)(" Tag - "+(0,o.zw)(e.label)+" ",1),ba,(0,a.Uk)(" TagDescription - "+(0,o.zw)(e.description)+" ",1),ha])),_:2},1024)])):"purpose"==e.type?((0,a.wg)(),(0,a.iD)("div",ka,[(0,a.Wm)(c,{src:n.hosts_purpose_icon(e.label),class:"node_icon"},null,8,["src"]),(0,a.Wm)(p,{offset:[0,10],"max-width":"250px"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Purpose - "+(0,o.zw)(e.label)+" ",1),ya])),_:2},1024)])):((0,a.wg)(),(0,a.iD)("div",Wa,[null!=e.virtual_host&&""!=e.virtual_host?((0,a.wg)(),(0,a.j4)(c,{key:0,src:"icons/os/vmware_.png",class:"node_icon"})):(0,a.kq)("",!0),(0,a.Wm)(c,{src:n.hosts_purpose_icon(e.purpose),class:"node_icon"},null,8,["src"]),e.id>=0?((0,a.wg)(),(0,a.j4)(p,{key:1,offset:[0,10],"max-width":"250px"},{default:(0,a.w5)((()=>[(0,a.Uk)(" HostID - "+(0,o.zw)(e.host_id)+" ",1),xa,(0,a.Uk)(" IP - "+(0,o.zw)(e.label)+" ",1),Ca,(0,a.Uk)(" OS - "+(0,o.zw)(e.os_family)+" ",1),qa,(0,a.Uk)(" OS_Name - "+(0,o.zw)(e.os_name)+" ",1),Va,(0,a.Uk)(" Type - "+(0,o.zw)(e.purpose)+" ",1),Sa,(0,a.Uk)(" Creds - "+(0,o.zw)(e.creds)+" ",1),za,(0,a.Uk)(" Vulns - "+(0,o.zw)(e.vulns),1)])),_:2},1024)):(0,a.kq)("",!0)]))])):(0,a.kq)("",!0),"root"==e.type?((0,a.wg)(),(0,a.iD)("span",Ha,[(0,a._)("b",null,(0,o.zw)(e.label),1)])):null!=e.vulns&&e.vulns>0?((0,a.wg)(),(0,a.iD)("span",Za,(0,o.zw)(e.label),1)):((0,a.wg)(),(0,a.iD)("span",Ua,(0,o.zw)(e.label),1)),e.creds>0&&1==n.user_settings.display_icon_tree_creds?((0,a.wg)(),(0,a.j4)(r,{key:5,color:"green",name:"check"})):(0,a.kq)("",!0),(0,a.Wm)(w,{"touch-position":"","context-menu":""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{dense:"",style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{clickable:"",onClick:l=>n.context_refresh(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Qa])),_:1})])),_:2},1032,["onClick"])),[[h]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{disable:"",clickable:"",onClick:l=>n.context_refresh(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Ta])),_:1})])),_:2},1032,["onClick"])),[[h]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{clickable:"",onClick:l=>n.ticked_tree(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Da])),_:1})])),_:2},1032,["onClick"])),[[h]]),0==e.id?(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{key:0,clickable:"",onClick:l=>n.mask_dialog(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Ra])),_:1})])),_:2},1032,["onClick"])),[[h]]):(0,a.kq)("",!0),(0,a.Wm)(g),(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Pa])),_:1})])),_:1})),[[h]])])),_:2},1024)])),_:2},1024)])),_:1},8,["nodes","filter","filter-method","selected","expanded","onLazyLoad"])])])),_:1})}const Ia={class:"q-pa-md",style:{"max-width":"400px"}},Oa=(0,a._)("div",{class:"text-h6"}," Маска подсети ",-1);function Aa(e,l,t,o,n,i){const s=(0,a.up)("q-select"),r=(0,a.up)("q-form"),u=(0,a.up)("q-btn"),d=(0,a.up)("q-card-actions"),c=(0,a.up)("q-card"),p=(0,a.up)("q-dialog");return(0,a.wg)(),(0,a.j4)(p,{ref:"dialogRef",onHide:e.onDialogHide},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{class:"q-dialog-plugin"},{default:(0,a.w5)((()=>[(0,a._)("div",Ia,[(0,a.Wm)(r,{onSubmit:e.onSubmit,onReset:e.onReset,class:"q-gutter-md"},{default:(0,a.w5)((()=>[Oa,(0,a.Wm)(s,{filled:"",modelValue:o.mask,"onUpdate:modelValue":l[0]||(l[0]=e=>o.mask=e),options:o.options,"option-value":"value","emit-value":"",label:"Mask","options-selected-class":"text-deep-orange"},null,8,["modelValue","options"])])),_:1},8,["onSubmit","onReset"])]),(0,a.Wm)(d,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{color:"primary",label:"OK",onClick:o.onOKClick},null,8,["onClick"]),(0,a.Wm)(u,{color:"primary",label:"Cancel",onClick:o.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const Ma=[{label:"0 - 0.0.0.0",value:0},{label:"1 - 128.0.0.0",value:1},{label:"2 - 192.0.0.0",value:2},{label:"3 - 224.0.0.0",value:3},{label:"4 - 240.0.0.0",value:4},{label:"5 - 248.0.0.0",value:5},{label:"6 - 252.0.0.0",value:6},{label:"7 - 254.0.0.0",value:7},{label:"8 - 255.0.0.0",value:8},{label:"9 - 255.128.0.0",value:9},{label:"10 - 255.192.0.0",value:10},{label:"11 - 255.224.0.0",value:11},{label:"12 - 255.240.0.0",value:12},{label:"13 - 255.248.0.0",value:13},{label:"14 - 255.252.0.0",value:14},{label:"15 - 255.254.0.0",value:15},{label:"16 - 255.255.0.0",value:16},{label:"17 - 255.255.128.0",value:17},{label:"18 - 255.255.192.0",value:18},{label:"19 - 255.255.224.0",value:19},{label:"20 - 255.255.240.0",value:20},{label:"21 - 255.255.248.0",value:21},{label:"22 - 255.255.252.0",value:22},{label:"23 - 255.255.254.0",value:23},{label:"24 - 255.255.255.0",value:24},{label:"25 - 255.255.255.128",value:25},{label:"26 - 255.255.255.192",value:26},{label:"27 - 255.255.255.224",value:27},{label:"28 - 255.255.255.240",value:28},{label:"29 - 255.255.255.248",value:29},{label:"30 - 255.255.255.252",value:30},{label:"31 - 255.255.255.254",value:31},{label:"32 - 255.255.255.255",value:32}],Fa={props:{items:String},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:a,onDialogCancel:o}=(0,D.Z)(),n=((0,q.Z)(),(0,u.oR)()),i=(0,r.iH)(n.state.mask),s=(0,r.iH)(Ma);return{dialogRef:l,options:s,mask:i,onOKClick(){n.commit("SET_MASK",i.value),a()},onCancelClick:o}}};var Na=t(8326);const La=(0,N.Z)(Fa,[["render",Aa]]),Ba=La;se()(Fa,"components",{QDialog:L.Z,QCard:B.Z,QForm:Na.Z,QSelect:X.Z,QCardActions:oe.Z,QBtn:$.Z});const Ea=[{label:"#Hosts",id:0,type:"root",purpose:"directory",mask:24,ticked:!1,lazy:!0,children:[]},{label:"#Tags",id:1,type:"root",purpose:"directory",ticked:!1,lazy:!0,children:[]},{label:"#Type",id:2,type:"root",purpose:"directory",ticked:!1,lazy:!0,children:[]}],Ka={name:"PageIndex",props:{item:Array},setup(){const e=(0,u.oR)(),l=(0,q.Z)(),t=((0,r.iH)(!1),(0,r.iH)([...Ea])),o=[],n=((0,r.iH)(null),(0,r.iH)(e.state.users),(0,r.iH)("Hosts")),i=(0,r.iH)([]),s=(0,r.iH)([]),p=(0,r.iH)(""),m=(0,r.iH)(null),_=(0,r.iH)(null),g=(0,r.iH)(e.state.event_host),f=(0,r.iH)(e.state.user_settings),w=(0,r.iH)(!1),v=(0,r.iH)(2);function b(){}function h(e,l){const t=l.toLowerCase();return e.label&&(e.label.toLowerCase().indexOf(t)>-1||e.purpose.toLowerCase().indexOf(t)>-1)}function k(){p.value="",m.value.focus()}async function y(t){let a=new Promise(((a,o)=>{setTimeout((()=>{const o={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_tree",{params:{workspace:e.state.current_project,node:t},headers:o}).then((e=>{e.data.forEach((e=>{e.id=v.value+1,v.value++})),a(e.data)})).catch((()=>{(0,R.$)(l,"negative","Ошибка","Не удалось загрузить данные","report_problem"),a([])}))}),1e3)})),o=await a;return o}async function W({node:e,key:l,done:t,fail:a}){var o=[];let n=e;delete n.children,o=await y(c.DS.encode(JSON.stringify(e))),t(o)}function x(e,l){let t=null;function a(e){return e.id===l?(t=e,!0):Array.isArray(e.children)&&e.children.some(a)}return e.some(a),t}function C(e,l){let t=null;function a(e){return e.id_host===l?(t=e,!0):Array.isArray(e.children)&&e.children.some(a)}return e.some(a),t}function V(e,l){let t=null;var a=null;function o(e){if(Array.isArray(e.children))a=e;else if(e.id==l)return a.children.splice(a.children.indexOf(e),1),!0;return Array.isArray(e.children)&&e.children.some(o)}return e.some(o),t}function S(l){if(null==l)e.commit("SET_CURRENT_TREE_NODE",e.state.current_tree_node);else{var a=JSON.parse(JSON.stringify(x(t.value,l)));delete a.children,e.commit("SET_CURRENT_TREE_NODE",a)}}async function z(e){var l=[];l=await y(c.DS.encode(JSON.stringify(e))),l.length>0&&("host"!=e.type?e.children=l:e=l[0])}function H(e){1==w.value?w.value=!1:w.value=!0}function Z(e){const l=e.ticked;function t(e){return e.ticked=l,Array.isArray(e.children)&&e.children.some(t)}t(e)}function U(t){let a=e.state.mask;l.dialog({component:Ba,componentProps:{}}).onOk((()=>{i.value.length>0&&a!=e.state.mask&&z(t)}))}function Q(l){e.commit("SET_TYPE_TREE",l)}return(0,a.bv)((()=>{b()})),(0,a.Ah)((()=>{})),(0,a.YP)((()=>e.state.event_host),(()=>{if(null!=e.state.event_host){let l=e.state.event_host.event;l="edit_host",l="add_host",l="del_host",e.commit("SET_EVENT_HOST",null)}})),(0,a.YP)((()=>e.state.user_settings),(()=>{null!=e.state.user_settings&&(f.value=e.state.user_settings)})),(0,a.YP)((()=>e.state.mask),(()=>{t.value[0].mask=e.state.mask})),{context_refresh:z,sel_ticked:Z,mask_dialog:U,myFilterMethod:h,resetFilter:k,handleSelectItem:S,findById:x,findByhostId:C,delByhostId:V,onLazyLoad:W,ticked_tree:H,loadData:y,change_type_tree:Q,hosts_osfamily_icon:j,hosts_purpose_icon:P,filter:p,lazy:(0,r.iH)(t),filterRef:m,user_settings:f,selected:n,ticked:s,f_ticked:w,Items:t,event_host:g,last_index:v,Data_load:o,expanded:i,treeRef:_}}};var $a=t(6663),Ja=t(4749),Ya=t(9885);const Ga=(0,N.Z)(Ka,[["render",ja]]),Xa=Ga;se()(Ka,"components",{QScrollArea:$a.Z,QInput:G.Z,QIcon:Re.Z,QTree:Ja.Z,QCheckbox:Ie.Z,QImg:te.Z,QTooltip:J.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QSeparator:Ol.Z,QPage:Ya.Z}),se()(Ka,"directives",{ClosePopup:ne.Z});const eo=(0,a.Uk)("CSV "),lo=(0,a.Uk)("XLS "),to={class:"text-h4"},ao=(0,a.Uk)(" Creds "),oo=(0,a.Uk)(" Закрепить компонент вверху "),no={key:0},io=(0,a._)("div",{align:"center"},"Visible Columns",-1),so={key:0},ro={key:1},uo={key:3},co={key:2,align:"right"},po={key:3,class:"truncate-text"},mo={key:4};function _o(e,l,t,n,i,s){const r=(0,a.up)("q-btn"),u=(0,a.up)("q-img"),d=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),p=(0,a.up)("q-list"),m=(0,a.up)("q-menu"),_=(0,a.up)("q-toggle"),g=(0,a.up)("q-tooltip"),f=(0,a.up)("q-chip"),w=(0,a.up)("q-icon"),v=(0,a.up)("q-input"),b=(0,a.up)("q-checkbox"),h=(0,a.up)("q-th"),k=(0,a.up)("q-tr"),y=(0,a.up)("q-popup-proxy"),W=(0,a.up)("q-td"),x=(0,a.up)("q-badge"),C=(0,a.up)("q-table"),q=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(C,{title:"Учетные данные",rows:n.Rows,columns:n.columns,"row-key":"id",ref:"q_table",selection:"multiple","selected-rows-label":n.getSelectedString,selected:n.selected,"onUpdate:selected":l[8]||(l[8]=e=>n.selected=e),onSelection:n.handleSelectRow,dense:"",loading:n.loading,filter:n.filter,"virtual-scroll":"","visible-columns":n.visibleColumns},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(r,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:n.additem},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:n.deleteItems,disable:n.btn_disable()},null,8,["onClick","disable"]),(0,a.Wm)(r,{color:"blue","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[0]||(l[0]=e=>n.to_csv()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/csv.png"}),eo])),_:1})])),_:1})),[[q]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[1]||(l[1]=e=>n.to_xls()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/excel.png"}),lo])),_:1})])),_:1})),[[q]])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{modelValue:n.tableSelectable,"onUpdate:modelValue":l[2]||(l[2]=e=>n.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",to,[ao,(0,a.Wm)(r,{flat:"",round:"",color:n.pin_color,icon:"push_pin",onClick:l[3]||(l[3]=e=>n.set_current_tab())},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[oo])),_:1})])),_:1},8,["color"])]),0!=n.drawChip(n.current_tree_node)?((0,a.wg)(),(0,a.iD)("div",no,[(0,a.Wm)(f,{modelValue:n.chiphost,"onUpdate:modelValue":l[4]||(l[4]=e=>n.chiphost=e),onRemove:l[5]||(l[5]=e=>n.removeChip()),icon:"subnets"===n.store.state.type_tree?"computer":"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(n.current_tree_node.label),1)])),_:1},8,["modelValue","icon"])])):(0,a.kq)("",!0),(0,a.Wm)(v,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[6]||(l[6]=e=>n.filter=e),placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(h,{key:0,align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(l=>((0,a.wg)(),(0,a.j4)(h,{key:l.name,props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,a.Wm)(y,{"context-menu":""},{default:(0,a.w5)((()=>[io,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.columns,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(_,{modelValue:n.visibleColumns,"onUpdate:modelValue":l[7]||(l[7]=e=>n.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(W,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,a.wg)(),(0,a.j4)(W,{key:l.name,align:"center"},{default:(0,a.w5)((()=>["service"==l.name?((0,a.wg)(),(0,a.iD)("div",so,[null!=n.services_name_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.services_name_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"access_level"==l.name?((0,a.wg)(),(0,a.iD)("div",ro,["access_level"!=l.name||"Administrator"!=l.value&&"Admin"!=l.value?"access_level"==l.name&&"User"==l.value?((0,a.wg)(),(0,a.j4)(x,{key:1,color:"blue"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):"access_level"==l.name&&""!=l.value&&null!=l.value?((0,a.wg)(),(0,a.j4)(x,{key:2,color:"grey"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):((0,a.wg)(),(0,a.iD)("div",uo,(0,o.zw)(l.value),1)):((0,a.wg)(),(0,a.j4)(x,{key:0,color:"green"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024))])):"actions"==l.name?((0,a.wg)(),(0,a.iD)("div",co,[(0,a.Wm)(r,{color:"green","icon-right":"edit",onClick:l=>n.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",onClick:l=>n.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):"passwords"==l.name?((0,a.wg)(),(0,a.iD)("div",po,(0,o.zw)(l.value),1)):((0,a.wg)(),(0,a.iD)("div",mo,(0,o.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const go=(0,a.Uk)("Minimize"),fo=(0,a.Uk)("Maximize"),wo=(0,a.Uk)("Close"),vo={class:"q-pa-md"},bo=(0,a._)("div",{class:"text-h6"}," Add Creds ",-1),ho=(0,a.Uk)(" No results "),ko=["src"],yo={class:"row"},Wo={class:"col"},xo={key:0,class:"col"},Co=(0,a.Uk)(" No results ");function qo(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-file"),h=(0,a.up)("q-card-actions"),k=(0,a.up)("q-card"),y=(0,a.up)("q-dialog"),W=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(y,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[go])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[fo])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[wo])),_:1})])),_:1})),[[W]])])),_:1}),(0,a._)("div",vo,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[bo])),_:1}),1==n.visible_item.address?((0,a.wg)(),(0,a.j4)(m,{key:0,filled:"",modelValue:n.row[0].address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.row[0].address=e),label:"",hint:"IP-адрес","lazy-rules":"",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"])):(0,a.kq)("",!0),1==n.visible_item.service?((0,a.wg)(),(0,a.j4)(v,{key:1,modelValue:n.row[0].port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.row[0].port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.row[0].service,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":"",ref:"portRef",rules:n.portRules},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[ho])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.row[0].service)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.row[0].service),style:{width:"25px",height:"25px"}},null,8,ko)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue","rules"])):(0,a.kq)("",!0),1==n.visible_item.username?((0,a.wg)(),(0,a.j4)(m,{key:2,filled:"",modelValue:n.row[0].username,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].username=e),label:"Text",hint:"Логин","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.kq)("",!0),(0,a._)("div",yo,[(0,a._)("div",Wo,[1==n.visible_item.password?((0,a.wg)(),(0,a.j4)(m,{key:0,filled:"",modelValue:n.row[0].passwords,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].passwords=e),label:"Text",hint:"Пароль","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.kq)("",!0)]),1==n.visible_item.filepicker?((0,a.wg)(),(0,a.iD)("div",xo,[(0,a.Wm)(d,{onClick:s.tclick,color:"primary",icon:"folder_open"},null,8,["onClick"]),1==n.flag_visible?((0,a.wg)(),(0,a.j4)(b,{key:0,ref:"file",clearable:"",filled:"",modelValue:n.model_filepicker,"onUpdate:modelValue":l[6]||(l[6]=e=>n.model_filepicker=e),label:"Label"},null,8,["modelValue"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)]),1==n.visible_item.domain?((0,a.wg)(),(0,a.j4)(m,{key:3,filled:"",modelValue:n.row[0].domain,"onUpdate:modelValue":l[7]||(l[7]=e=>n.row[0].domain=e),label:"Text",hint:"Домен","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.kq)("",!0),""!=n.row[0].domain?((0,a.wg)(),(0,a.j4)(v,{key:4,filled:"",modelValue:n.row[0].realm_type,"onUpdate:modelValue":[l[8]||(l[8]=e=>n.row[0].realm_type=e),n.setModel_3],options:n.options5,label:"",hint:"Domain/Realm Type"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(f,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onUpdate:modelValue"])):(0,a.kq)("",!0),1==n.visible_item.access_level&&null!=n.row[0].port?((0,a.wg)(),(0,a.j4)(v,{key:5,filled:"",modelValue:n.row[0].access_level,"onUpdate:modelValue":[l[9]||(l[9]=e=>n.row[0].access_level=e),n.setModel_1],"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:n.options2,hint:"Уровень доступа"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Co])),_:1})])),_:1})])),option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(f,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onUpdate:modelValue"])):(0,a.kq)("",!0),1==n.visible_item.type?((0,a.wg)(),(0,a.j4)(v,{key:6,filled:"",modelValue:n.row[0].type,"onUpdate:modelValue":[l[10]||(l[10]=e=>n.row[0].type=e),n.setModel_2],options:n.options3,label:"",hint:"Тип","lazy-rules":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(f,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onUpdate:modelValue"])):(0,a.kq)("",!0),1==n.visible_item.jtr_format?((0,a.wg)(),(0,a.j4)(v,{key:7,filled:"","use-input":"","fill-input":"",modelValue:n.row[0].jtr_format,"onUpdate:modelValue":l[11]||(l[11]=e=>n.row[0].jtr_format=e),options:n.options4,readonly:n.ntlm_hash,onFilter:n.filterFn_jth_format,label:"",multiple:"",hint:"John the Ripper format"},null,8,["modelValue","options","readonly","onFilter"])):(0,a.kq)("",!0)]),(0,a.Wm)(h,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Vo=[{label:"",value:null,description:"Not Grants"},{label:"Administrator",value:"Administrator",description:"Administrator Grants"},{label:"User",value:"User",description:"User Grants"},{label:"Read/Write",value:"Read/Write",description:"Read/Write Grants"},{label:"Read-only",value:"Read-only",description:"Read-only Grants"},{label:"Interactive",value:"interactive",description:"interactive Grants"}],So=[{label:"Password",value:"Metasploit::Credential::Password",description:"Пароль"},{label:"NTLM",value:"Metasploit::Credential::NTLMHash",description:"NTLM-хэш"},{label:"Other Hash type",value:"Metasploit::Credential::NonreplayableHash",description:"Другие виды хэширования"},{label:"SSH key",value:"Metasploit::Credential::SSHKey",description:"Private ключ SSH"}],zo=[{label:"Active Directory Domain",value:"Active Directory Domain",description:"Домен Active Directory"},{label:"PostgreSQL Database",value:"PostgreSQL Database",description:"PostgreSQL БД"},{label:"Oracle System Identifier",value:"Oracle System Identifier",description:"Oracle (SID)"},{label:"DB2 Database",value:"DB2 Database",description:"DB2 БД"},{label:"",value:null,description:"No Domain/Realm"}],Ho=["7z","adxcrypt","AFS","agilekeychain","aix-ssha1","aix-ssha256","andOTP","AndroidBackup","ansible","argon2","as400-des","as400-ssha1","asa-md5","AzureAD","bcrypt","BestCrypt","BestCryptVE4","bfegg","Bitcoin","BitLocker","Bitwarden","BKS","Blackberry-ES10","Blockchain","bsdicrypt","chap","Citrix_NS10","cloudkeychain","cq","CRC32","crypt","cryptoSafe","dahua","dashlane","diskcryptor","Django","dmd5","dmg","dominosec","dominosec8","DPAPImk","dragonfly3-32","dragonfly4-32","dragonfly4-64","Drupal7","dynamic_n","eCryptfs","eigrp","EncFS","enpass","EPI","EPiServer","ethereum","fde","FormSpring","Fortigate256","FVDE","geli","gost","gpg","has-160","HAVAL-128-4","HAVAL-256-3","hdaa","HMAC-SHA1","HMAC-SHA224","HMAC-SHA256","HMAC-SHA384","HMAC-SHA512","hsrp","IKE","ipb2","itunes-backup","iwork","KeePass","keychain","keystore","known_hosts","krb4","krb5","krb5-18","krb5-3","krb5asrep","krb5pa-md5","krb5pa-sha1","krb5tgs","kwallet","LastPass","leet","lm","lotus5","lotus85","lp","lpcli","LUKS","md5crypt","md5crypt-long","md5ns","mdc2","MediaWiki","monero","money","MongoDB","Mozilla","mscash","MSCHAPv2","mschapv2-naive","mssql","mssql05","mssql12","mysql","mysqlna","mysql-sha1","net-ah","nethalflm","netlm","netlmv2","netntlm","netntlm-naive","netntlmv2","net-sha1","nk","notes","nt","o10glogon","o3logon","o5logon","ODF","Office","oldoffice","openssl-enc","OpenVMS","oracle","oracle11","Oracle12C","osc","ospf","Palshop","Panama","PBKDF2-HMAC-MD4","PBKDF2-HMAC-MD5","PBKDF2-HMAC-SHA1","PBKDF2-HMAC-SHA512","PDF","PEM","pfx","pgpdisk","pgpsda","phpass","PHPS","PHPS2","pix-md5","PKZIP","plaintext","po","postgres","PST","PuTTY","qnx","RACF","RACF-KDFAES","radius","RAdmin","RAKP","rar","RAR5","Raw-Keccak","Raw-Keccak-256","Raw-MD4","Raw-MD5","Raw-MD5u","Raw-SHA1","Raw-SHA1-Linkedin","Raw-SHA224","Raw-SHA256","Raw-SHA3","Raw-SHA512","restic","ripemd-128","ripemd-160","rsvp","RVARY","sapb","sapg","saph","sappse","scram","scrypt","securezip","sha1crypt","sha512crypt","Siemens-S7","Signal","SIP","skein-512","skey","SL3","Snefru-128","Snefru-256","SNMP","SSH","SSHA512","sspr","Stribog-256","Stribog-512","STRIP","SunMD5","SybaseASE","tacacs-plus","tc_aes_xts","tc_ripemd160boot","tc_sha512","tc_whirlpool","tcp-md5","telegram","tezos","Tiger","vdi","vmx","vtp","wbb3","whirlpool","whirlpool0","whirlpool1","WoWSRP","wpapsk","wpapsk-pmk","xsha","xsha512","zed","ZIP","ZipMonster","aix-ssha512","AxCrypt","bitshares","Clipperz","descrypt","django-scrypt","dragonfly3-64","dummy","electrum","Fortigate","HMAC-MD5","hMailServer","keyring","krb5-17","MD2","mscash2","multibit","net-md5","nsec3","OpenBSD-SoftRAID","Padlock","PBKDF2-HMAC-SHA256","pgpwde","pwsafe","Raw-Blake2","Raw-SHA1-AxCrypt","Raw-SHA384","Salted-SHA1","sha256crypt","skein-256","solarwinds","Sybase-PROP","tc_ripemd160","tripcode","VNC","xmpp-scram"],Zo={props:{},emits:[...D.Z.emits],methods:{tclick(){this.$refs.file.pickFiles()}},setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)(null),m=(0,r.iH)(Vo),_=(0,r.iH)(So),g=(0,r.iH)(Ho),f=(0,r.iH)(zo),w=(0,r.iH)([]),v=(0,r.iH)([]),b=(0,r.iH)(!1),h=(0,r.iH)(!1),k=(0,r.iH)(null),y=(0,r.iH)(null),W=((0,r.iH)(null),(0,r.iH)(null)),x=(0,r.iH)(null),C=(0,r.iH)(s.state.current_tree_node),V=(0,r.iH)(null),S=(0,r.iH)([{id:-1,address:"",port:null,proto:"",origin_type:"Metasploit::Credential::Manual",origin_address:"",origin_id:null,service:"",username:"",passwords:"",domain:"",realm_type:"Active Directory Domain",access_level:"User",type:"Metasploit::Credential::Password",jtr_format:null}]),z=(0,r.iH)({address:!0,service:!0,username:!0,password:!0,domain:!0,access_level:!0,type:!0,jtr_format:!1,filepicker:!1});function H(e,l,t){k.value.validate(),k.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:S.value[0].address}))},headers:e}).then((e=>{p.value=[],e.data.forEach((e=>{p.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function Z(e,l,t){l((()=>{const l=e.toLowerCase();m.value=Vo.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}))}function U(e){null!=e?(V.value=e.service_id,S.value[0].port=e.port,S.value[0].service=e.name,S.value[0].proto=e.proto):(V.value=e,S.value[0].port=e,S.value[0].service=e,S.value[0].proto=e)}function Q(e,l,t){l((()=>{const l=e.toLocaleLowerCase();g.value=Ho.filter((e=>e.toLocaleLowerCase().indexOf(l)>-1))}))}function T(e){S.value[0].access_level=e.value}function P(e){S.value[0].type=e.value,"Metasploit::Credential::NonreplayableHash"==e.value?(z.value.jtr_format=!0,z.value.domain=!0,h.value=!1,S.value[0].jtr_format=["netntlmv2"]):"Metasploit::Credential::NTLMHash"==e.value?(z.value.jtr_format=!0,z.value.domain=!0,h.value=!0,S.value[0].jtr_format=["nt","lm"]):"Metasploit::Credential::SSHKey"==e.value?(z.value.jtr_format=!1,z.value.domain=!1,z.value.filepicker=!1,h.value=!0,w.value=null):(w.value=null,h.value=!1,z.value.domain=!0,S.value[0].jtr_format=null,z.value.jtr_format=!1)}function j(e){null==e.value?(S.value[0].domain="",S.value[0].realm_type=f.value[0].value):S.value[0].realm_type=e.value}function O(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function A(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/add_cred",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(S.value[0].id=e.data.id,S.value[0].origin_address=e.data.origin_address,S.value[0].origin_type=e.data.origin_type,S.value[0].origin_id=e.data.origin_id,null!=S.value[0].jtr_format&&(S.value[0].jtr_format=S.value[0].jtr_format.join(",")),o({row:S}),(0,R.$)(i,"positive","Запись добавлена","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{C.value=s.state.current_tree_node,void 0!=C&&null!=C&&("subnet"!=C.value.type&&"host"!=C.value.type||(S.value[0].address=C.value.label))})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),model_filepicker:null,project_name:W,description:x,row:S,flag_visible:!0,options:p,options2:m,options:p,options3:_,options4:g,options5:f,flag_hash_type:b,service_id:V,visible_item:z,hash_type:w,ntlm_hash:h,ipRef:k,portRef:y,current_tree_node:C,filterFn:H,domain_realm_type:v,add_creds:A,filterFn_2:Z,services_name_icon:I,filterFn_jth_format:Q,setModel:U,setModel_1:T,setModel_2:P,setModel_3:j,ipRules:[e=>null==e||""==e||1==O(e)||"Введите валидный IP-адрес или оставтье поле пустым"],portRules:[],onDialogHide:t,onOKClick(){if(k.value.validate(),k.value.hasError);else if(""==S.value[0].address&&""!=S.value[0].port&&null!=S.value[0].port){let e="";""==S.value[0].address&&""!=S.value[0].port&&null!=S.value[0].port&&(e="Поле `IP-адрес` не должно быть пустым, если поле `Служба` содержит значение"),i.notify({position:"bottom",message:"Warning",caption:e,color:"warning",icon:"report_problem"})}else if("Metasploit::Credential::Password"!=S.value[0].type&""==S.value[0].passwords){let e='Поле `Пароль` не должно быть пустым, если поле `Tип` содержит значение "NTLM" или "Other hash type"';i.notify({position:"bottom",message:"Warning",caption:e,color:"warning",icon:"report_problem"})}else{var e=JSON.parse(JSON.stringify(S.value[0]));null!=S.value[0].port&&""!=S.value[0].port||(e.port=0,e.proto="tcp",e.service=null),A(s.state.current_project,JSON.stringify(e))}},onCancelClick:n}}},Uo=(0,N.Z)(Zo,[["render",qo]]),Qo=Uo;se()(Zo,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QFile:vt.Z,QCardActions:oe.Z}),se()(Zo,"directives",{ClosePopup:ne.Z});const To=(0,a.Uk)("Minimize"),Do=(0,a.Uk)("Maximize"),Ro=(0,a.Uk)("Close"),Po={class:"q-pa-md"},jo=(0,a._)("div",{class:"text-h6"}," Edit Creds ",-1),Io=(0,a.Uk)(" No results "),Oo=["src"],Ao={class:"row"},Mo={class:"col"},Fo={key:0,class:"col"},No=(0,a.Uk)(" No results ");function Lo(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-file"),h=(0,a.up)("q-card-actions"),k=(0,a.up)("q-card"),y=(0,a.up)("q-dialog"),W=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(y,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[To])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Do])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Ro])),_:1})])),_:1})),[[W]])])),_:1}),(0,a._)("div",Po,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[jo])),_:1}),1==n.visible_item.address?((0,a.wg)(),(0,a.j4)(m,{key:0,filled:"",modelValue:n.prop1.address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.prop1.address=e),label:"",hint:"IP-адрес","lazy-rules":"",readonly:"",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"])):(0,a.kq)("",!0),1==n.visible_item.service?((0,a.wg)(),(0,a.j4)(v,{key:1,modelValue:n.prop1.port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.prop1.port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.prop1.service,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":"",ref:"portRef",rules:n.portRules},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Io])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.prop1.service)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.prop1.service),style:{width:"25px",height:"25px"}},null,8,Oo)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue","rules"])):(0,a.kq)("",!0),1==n.visible_item.username?((0,a.wg)(),(0,a.j4)(m,{key:2,filled:"",modelValue:n.prop1.username,"onUpdate:modelValue":l[4]||(l[4]=e=>n.prop1.username=e),label:"Text",hint:"Логин","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.kq)("",!0),(0,a._)("div",Ao,[(0,a._)("div",Mo,[1==n.visible_item.password?((0,a.wg)(),(0,a.j4)(m,{key:0,filled:"",modelValue:n.prop1.passwords,"onUpdate:modelValue":l[5]||(l[5]=e=>n.prop1.passwords=e),label:"Text",hint:"Пароль","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.kq)("",!0)]),1==n.visible_item.filepicker?((0,a.wg)(),(0,a.iD)("div",Fo,[(0,a.Wm)(d,{onClick:s.tclick,color:"primary",icon:"folder_open"},null,8,["onClick"]),1==n.flag_visible?((0,a.wg)(),(0,a.j4)(b,{key:0,ref:"file",clearable:"",filled:"",modelValue:n.model_filepicker,"onUpdate:modelValue":l[6]||(l[6]=e=>n.model_filepicker=e),label:"Label"},null,8,["modelValue"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)]),1==n.visible_item.domain?((0,a.wg)(),(0,a.j4)(m,{key:3,filled:"",modelValue:n.prop1.domain,"onUpdate:modelValue":l[7]||(l[7]=e=>n.prop1.domain=e),label:"Text",hint:"Домен","lazy-rules":"",autogrow:""},null,8,["modelValue"])):(0,a.kq)("",!0),null!=n.prop1.domain&&""!=n.prop1.domain?((0,a.wg)(),(0,a.j4)(v,{key:4,filled:"",modelValue:n.prop1.realm_type,"onUpdate:modelValue":[l[8]||(l[8]=e=>n.prop1.realm_type=e),n.setModel_3],options:n.options5,label:"",hint:"Domain/Realm Type"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(f,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onUpdate:modelValue"])):(0,a.kq)("",!0),1==n.visible_item.access_level&&null!=n.prop1.port?((0,a.wg)(),(0,a.j4)(v,{key:5,filled:"",modelValue:n.prop1.access_level,"onUpdate:modelValue":[l[9]||(l[9]=e=>n.prop1.access_level=e),n.setModel_1],"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:n.options2,hint:"Уровень доступа"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[No])),_:1})])),_:1})])),option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(f,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onUpdate:modelValue"])):(0,a.kq)("",!0),1==n.visible_item.type?((0,a.wg)(),(0,a.j4)(v,{key:6,filled:"",modelValue:n.prop1.type,"onUpdate:modelValue":[l[10]||(l[10]=e=>n.prop1.type=e),n.setModel_2],options:n.options3,label:"",hint:"Тип","lazy-rules":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(f,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onUpdate:modelValue"])):(0,a.kq)("",!0),1==n.visible_item.jtr_format?((0,a.wg)(),(0,a.j4)(v,{key:7,filled:"","use-input":"","fill-input":"",modelValue:n.prop1.jtr_format,"onUpdate:modelValue":l[11]||(l[11]=e=>n.prop1.jtr_format=e),options:n.options4,readonly:n.ntlm_hash,onFilter:n.filterFn_jth_format,label:"",multiple:"",hint:"John the Ripper format"},null,8,["modelValue","options","readonly","onFilter"])):(0,a.kq)("",!0)]),(0,a.Wm)(h,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Bo=[{label:"",value:null,description:"Not Grants"},{label:"Administrator",value:"Administrator",description:"Administrator Grants"},{label:"User",value:"User",description:"User Grants"},{label:"Read/Write",value:"Read/Write",description:"Read/Write Grants"},{label:"Read-only",value:"Read-only",description:"Read-only Grants"},{label:"Interactive",value:"interactive",description:"interactive Grants"}],Eo=[{label:"Password",value:"Metasploit::Credential::Password",description:"Пароль"},{label:"NTLM",value:"Metasploit::Credential::NTLMHash",description:"NTLM-хэш"},{label:"Other Hash type",value:"Metasploit::Credential::NonreplayableHash",description:"Другие виды хэширования"},{label:"SSH key",value:"Metasploit::Credential::SSHKey",description:"Private ключ SSH"}],Ko=[{label:"Active Directory Domain",value:"Active Directory Domain",description:"Домен Active Directory"},{label:"PostgreSQL Database",value:"PostgreSQL Database",description:"PostgreSQL БД"},{label:"Oracle System Identifier",value:"Oracle System Identifier",description:"Oracle (SID)"},{label:"DB2 Database",value:"DB2 Database",description:"DB2 БД"},{label:"",value:null,description:"No Domain/Realm"}],$o=["7z","adxcrypt","AFS","agilekeychain","aix-ssha1","aix-ssha256","andOTP","AndroidBackup","ansible","argon2","as400-des","as400-ssha1","asa-md5","AzureAD","bcrypt","BestCrypt","BestCryptVE4","bfegg","Bitcoin","BitLocker","Bitwarden","BKS","Blackberry-ES10","Blockchain","bsdicrypt","chap","Citrix_NS10","cloudkeychain","cq","CRC32","crypt","cryptoSafe","dahua","dashlane","diskcryptor","Django","dmd5","dmg","dominosec","dominosec8","DPAPImk","dragonfly3-32","dragonfly4-32","dragonfly4-64","Drupal7","dynamic_n","eCryptfs","eigrp","EncFS","enpass","EPI","EPiServer","ethereum","fde","FormSpring","Fortigate256","FVDE","geli","gost","gpg","has-160","HAVAL-128-4","HAVAL-256-3","hdaa","HMAC-SHA1","HMAC-SHA224","HMAC-SHA256","HMAC-SHA384","HMAC-SHA512","hsrp","IKE","ipb2","itunes-backup","iwork","KeePass","keychain","keystore","known_hosts","krb4","krb5","krb5-18","krb5-3","krb5asrep","krb5pa-md5","krb5pa-sha1","krb5tgs","kwallet","LastPass","leet","lm","lotus5","lotus85","lp","lpcli","LUKS","md5crypt","md5crypt-long","md5ns","mdc2","MediaWiki","monero","money","MongoDB","Mozilla","mscash","MSCHAPv2","mschapv2-naive","mssql","mssql05","mssql12","mysql","mysqlna","mysql-sha1","net-ah","nethalflm","netlm","netlmv2","netntlm","netntlm-naive","netntlmv2","net-sha1","nk","notes","nt","o10glogon","o3logon","o5logon","ODF","Office","oldoffice","openssl-enc","OpenVMS","oracle","oracle11","Oracle12C","osc","ospf","Palshop","Panama","PBKDF2-HMAC-MD4","PBKDF2-HMAC-MD5","PBKDF2-HMAC-SHA1","PBKDF2-HMAC-SHA512","PDF","PEM","pfx","pgpdisk","pgpsda","phpass","PHPS","PHPS2","pix-md5","PKZIP","plaintext","po","postgres","PST","PuTTY","qnx","RACF","RACF-KDFAES","radius","RAdmin","RAKP","rar","RAR5","Raw-Keccak","Raw-Keccak-256","Raw-MD4","Raw-MD5","Raw-MD5u","Raw-SHA1","Raw-SHA1-Linkedin","Raw-SHA224","Raw-SHA256","Raw-SHA3","Raw-SHA512","restic","ripemd-128","ripemd-160","rsvp","RVARY","sapb","sapg","saph","sappse","scram","scrypt","securezip","sha1crypt","sha512crypt","Siemens-S7","Signal","SIP","skein-512","skey","SL3","Snefru-128","Snefru-256","SNMP","SSH","SSHA512","sspr","Stribog-256","Stribog-512","STRIP","SunMD5","SybaseASE","tacacs-plus","tc_aes_xts","tc_ripemd160boot","tc_sha512","tc_whirlpool","tcp-md5","telegram","tezos","Tiger","vdi","vmx","vtp","wbb3","whirlpool","whirlpool0","whirlpool1","WoWSRP","wpapsk","wpapsk-pmk","xsha","xsha512","zed","ZIP","ZipMonster","aix-ssha512","AxCrypt","bitshares","Clipperz","descrypt","django-scrypt","dragonfly3-64","dummy","electrum","Fortigate","HMAC-MD5","hMailServer","keyring","krb5-17","MD2","mscash2","multibit","net-md5","nsec3","OpenBSD-SoftRAID","Padlock","PBKDF2-HMAC-SHA256","pgpwde","pwsafe","Raw-Blake2","Raw-SHA1-AxCrypt","Raw-SHA384","Salted-SHA1","sha256crypt","skein-256","solarwinds","Sybase-PROP","tc_ripemd160","tripcode","VNC","xmpp-scram"],Jo={props:{selected_items:Object},emits:[...D.Z.emits],methods:{tclick(){this.$refs.file.pickFiles()}},setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)(null),m=(0,r.iH)(Bo),_=(0,r.iH)(Eo),g=(0,r.iH)($o),f=(0,r.iH)(Ko),w=(0,r.iH)([]),v=(0,r.iH)([]),b=(0,r.iH)(!1),h=(0,r.iH)(!1),k=(0,r.iH)(null),y=(0,r.iH)(null),W=((0,r.iH)(null),(0,r.iH)(null)),x=(0,r.iH)(null),C=(0,r.iH)(s.state.current_tree_node),V=(0,r.iH)(null);var S=null;const z=(0,r.iH)(JSON.parse(JSON.stringify(e.selected_items))),H=(0,r.iH)([{id:-1,address:"",port:null,proto:"",origin_type:"Metasploit::Credential::Manual",origin_address:"",service:"",username:"",passwords:"",domain:"",realm_type:"Active Directory Domain",access_level:"User",type:"Metasploit::Credential::Password",jtr_format:null}]),Z=(0,r.iH)({address:!0,service:!0,username:!0,password:!0,domain:!0,access_level:!0,type:!0,jtr_format:!1,filepicker:!1});function U(e,l,t){k.value.validate(),k.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:z.value.address}))},headers:e}).then((e=>{p.value=[],e.data.forEach((e=>{p.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function Q(e,l,t){l((()=>{const l=e.toLowerCase();m.value=Bo.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}))}function T(e){null!=e?(V.value=e.service_id,z.value.port=e.port,z.value.service=e.name,z.value.proto=e.proto):(V.value=e,z.value.port=e,z.value.service=e,z.value.proto=e)}function P(e,l,t){l((()=>{const l=e.toLocaleLowerCase();g.value=$o.filter((e=>e.toLocaleLowerCase().indexOf(l)>-1))}))}function j(e){z.value.access_level=e.value}function O(e){z.value.type=e.value,"Metasploit::Credential::NonreplayableHash"==e.value?(Z.value.jtr_format=!0,Z.value.domain=!0,h.value=!1,w.value=["netntlmv2"]):"Metasploit::Credential::NTLMHash"==e.value?(Z.value.jtr_format=!0,Z.value.domain=!0,h.value=!0,w.value=["nt","lm"]):"Metasploit::Credential::SSHKey"==e.value?(Z.value.jtr_format=!1,Z.value.domain=!1,Z.value.filepicker=!1,h.value=!0,w.value=null):(w.value=null,h.value=!1,Z.value.domain=!0,Z.value.jtr_format=!1)}function A(e){null==e.value?(z.value.domain="",z.value.realm_type=f.value[0].value):z.value.realm_type=e.value}function M(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function F(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/edit_cred",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(z.value.id=e.data.id,z.value.origin_address=e.data.origin_address,z.value.origin_type=e.data.origin_type,z.value.origin_id=e.data.origin_id,null!=z.value.jtr_format&&(z.value.jtr_format=z.value.jtr_format.join(",")),o({prop1:z}),(0,R.$)(i,"positive","Запись отредактирована","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{"Metasploit::Credential::NTLMHash"!=z.value.type&&"Metasploit::Credential::NonreplayableHash"!=z.value.type||(Z.value.jtr_format=!0),"Metasploit::Credential::NTLMHash"==z.value.type&&(h.value=!0)})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),model_filepicker:null,project_name:W,description:x,row:H,flag_visible:!0,options:p,options2:m,options:p,options3:_,options4:g,options5:f,flag_hash_type:b,service_id:V,visible_item:Z,hash_type:w,ntlm_hash:h,ipRef:k,prop1:z,prop:S,current_tree_node:C,portRef:y,filterFn:U,domain_realm_type:v,edit_creds:F,services_name_icon:I,filterFn_2:Q,filterFn_jth_format:P,setModel:T,setModel_1:j,setModel_2:O,setModel_3:A,ipRules:[e=>null==e||""==e||1==M(e)||"Введите валидный IP-адрес или оставтье поле пустым"],portRules:[],onDialogHide:t,onOKClick(){if(k.value.validate(),k.value.hasError);else if(""==z.value.address&&""!=z.value.port&&null!=z.value.port){let e="";""==z.value.address&&""!=z.value.port&&null!=z.value.port&&(e="Поле `IP-адрес` не должно быть пустым, если поле `Служба` содержит значение"),i.notify({position:"bottom",message:"Warning",caption:e,color:"warning",icon:"report_problem"})}else if("Metasploit::Credential::Password"!=z.value.type&""==z.value.passwords){let e='Поле `Пароль` не должно быть пустым, если поле `Tип` содержит значение "NTLM" или "Other hash type"';i.notify({position:"bottom",message:"Warning",caption:e,color:"warning",icon:"report_problem"})}else{var e=JSON.parse(JSON.stringify(z.value));null!=z.value.port&&""!=z.value.port||(e.port=0,e.proto="tcp",e.service=null),F(s.state.current_project,JSON.stringify(e))}},onCancelClick:n}}},Yo=(0,N.Z)(Jo,[["render",Lo]]),Go=Yo;se()(Jo,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QFile:vt.Z,QCardActions:oe.Z}),se()(Jo,"directives",{ClosePopup:ne.Z});const Xo=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",label:"IP-host",align:"center",field:"address",sortable:!0},{name:"origin_address",label:"IP-origin",align:"center",field:"origin_address",sortable:!0},{name:"origin_type",label:"Origin type",align:"center",field:"origin_type",sortable:!0},{name:"origin_id",label:"Origin ID",align:"center",field:"origin_id",sortable:!0},{name:"port",label:"Порт",align:"center",field:"port",sortable:!0},{name:"proto",label:"Протокол",align:"center",field:"proto",sortable:!0},{name:"service",label:"Служба",align:"center",field:"service",sortable:!0},{name:"username",label:"Логин",align:"center",field:"username",sortable:!0},{name:"passwords",label:"Пароль",align:"center",field:"passwords",sortable:!0},{name:"domain",label:"Домен",align:"center",field:"domain",sortable:!0},{name:"realm_type",label:"Domain/Realm Type",align:"center",field:"realm_type",sortable:!0},{name:"access_level",label:"Уровень доступа",align:"center",field:"access_level",sortable:!0},{name:"type",label:"Тип пароля",align:"center",field:"type",sortable:!0},{name:"jtr_format",label:"JTR Формат",align:"center",field:"jtr_format",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],en=[],ln={name:"PageIndex",setup(){const e=(0,u.oR)(),l=(0,r.iH)([]),t=(0,q.Z)(),o=((0,r.iH)(!1),(0,r.iH)(!1)),n=(0,r.iH)([...en]),i=((0,r.iH)(null),(0,r.iH)(e.state.users),(0,r.iH)(e.state.current_tree_node)),s=(0,r.iH)(e.state.current_service),p=(0,r.iH)(!0),m=(0,r.iH)(!1),_=(0,r.iH)(""),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null);function v(){t.dialog({component:Qo,componentProps:{}}).onOk((e=>{n.value.push(e.row.value[0])}))}function b(){m.value=!0;const l={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_creds",{params:{workspace:e.state.current_project,node:c.DS.encode(JSON.stringify(e.state.current_tree_node))},headers:l}).then((e=>{n.value=e.data,m.value=!1})).catch((()=>{m.value=!1,(0,R.$)(t,"negative","Ошибка","Не удалось загрузить "+g.value.title,"report_problem")}))}function h(a){setTimeout((()=>{const o={Authorization:"Bearer "+e.state.current_user.token};d.api.post("/del_cred",{workspace:e.state.current_project,data:a},{headers:o}).then((e=>{200==e.data.rsp_k?(n.value.splice(n.value.indexOf(a),1),l.value=l.value.filter((e=>e.id!=a.id)),(0,R.$)(t,"positive","Запись удалена","","done")):(0,R.$)(t,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,R.$)(t,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function k(){for(var e=l.value.filter((e=>e.id)),t=0;t<e.length;t++)h(e[t])}function y(e){var l=n.value.find((l=>l.id==e.id)),a=n.value.indexOf(l);t.dialog({component:Go,componentProps:{selected_items:l}}).onOk((e=>{if(void 0!=e){n.value[a];a>-1&&(n.value[a]=e.prop1.value)}}))}function W(){xe(g,Xo)}function x(){qe(g,Xo)}function C(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function V(e){l.value=e.rows}function S(){e.commit("SET_CURRENT_TAB","creds")}function z(){return!(l.value.length>0)}function H(){}return(0,a.YP)((()=>e.state.current_tree_node),(()=>{null!=e.state.current_tree_node&&(i.value=e.state.current_tree_node,b())})),(0,a.YP)((()=>e.state.current_tab),(()=>{"creds"==e.state.current_tab?(f.value=e.state.current_tab,w.value="red"):w.value="grey"})),(0,a.bv)((()=>{"creds"==e.state.current_tab?w.value="red":w.value="grey",b()})),{selected:l,columns:Xo,Rows:n,tableSelectable:o,store:e,visibleColumns:(0,r.iH)(["address","origin_address","port","service","username","passwords","domain","access_level","actions"]),getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${en.length}`},handleSelectRow:V,additem:v,editItem:y,deleteItem:h,deleteItems:k,to_csv:W,to_xls:x,set_current_tab:S,btn_disable:z,services_name_icon:I,removeChip:H,pin_color:w,chiphost:p,drawChip:C,current_service:s,current_tree_node:i,q_table:g,loading:m,filter:_}}},tn=(0,N.Z)(ln,[["render",_o]]),an=tn;se()(ln,"components",{QTable:C.Z,QBtn:$.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QToggle:Te.Z,QTooltip:J.Z,QChip:De.Z,QInput:G.Z,QIcon:Re.Z,QTr:Pe.Z,QTh:je.Z,QCheckbox:Ie.Z,QPopupProxy:Oe.Z,QTd:Ae.Z,QBadge:Me.Z}),se()(ln,"directives",{ClosePopup:ne.Z});const on=(0,a.Uk)("CSV "),nn=(0,a.Uk)("XLS "),sn={class:"text-h4"},rn=(0,a.Uk)(" Vulns "),un=(0,a.Uk)(" Закрепить компонент вверху "),dn={key:0},cn=(0,a._)("div",{align:"center"},"Visible Columns",-1),pn={key:0},mn=(0,a.Uk)(" Exploited! "),_n={key:0},gn={key:1,align:"right"},fn={key:2},wn={key:3},vn={key:4},bn={key:5,class:"truncate-text"},hn={key:6};function kn(e,l,t,n,i,s){const r=(0,a.up)("q-btn"),u=(0,a.up)("q-img"),d=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),p=(0,a.up)("q-list"),m=(0,a.up)("q-menu"),_=(0,a.up)("q-toggle"),g=(0,a.up)("q-tooltip"),f=(0,a.up)("q-chip"),w=(0,a.up)("q-icon"),v=(0,a.up)("q-input"),b=(0,a.up)("q-checkbox"),h=(0,a.up)("q-th"),k=(0,a.up)("q-tr"),y=(0,a.up)("q-popup-proxy"),W=(0,a.up)("q-td"),x=(0,a.up)("q-badge"),C=(0,a.up)("q-card"),q=(0,a.up)("q-expansion-item"),V=(0,a.up)("q-table"),S=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(V,{title:"Уязвимости",rows:n.Rows,columns:n.columns,"row-key":"id",ref:"q_table",selection:"multiple","selected-rows-label":n.getSelectedString,selected:n.selected,"onUpdate:selected":l[8]||(l[8]=e=>n.selected=e),onSelection:n.handleSelectRow,dense:"",loading:n.loading,filter:n.filter,"virtual-scroll":"","visible-columns":n.visibleColumns},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(r,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:n.additem},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:n.deleteItems,disable:n.btn_disable()},null,8,["onClick","disable"]),(0,a.Wm)(r,{color:"blue","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[0]||(l[0]=e=>n.to_csv()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/csv.png"}),on])),_:1})])),_:1})),[[S]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[1]||(l[1]=e=>n.to_xls()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/excel.png"}),nn])),_:1})])),_:1})),[[S]])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{modelValue:n.tableSelectable,"onUpdate:modelValue":l[2]||(l[2]=e=>n.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",sn,[rn,(0,a.Wm)(r,{flat:"",round:"",color:n.pin_color,icon:"push_pin",onClick:l[3]||(l[3]=e=>n.set_current_tab())},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[un])),_:1})])),_:1},8,["color"])]),0!=n.drawChip(n.current_tree_node)?((0,a.wg)(),(0,a.iD)("div",dn,[(0,a.Wm)(f,{modelValue:n.chiphost,"onUpdate:modelValue":l[4]||(l[4]=e=>n.chiphost=e),onRemove:l[5]||(l[5]=l=>e.removeChip()),icon:"subnets"===n.store.state.type_tree?"computer":"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(n.current_tree_node.label),1)])),_:1},8,["modelValue","icon"])])):(0,a.kq)("",!0),(0,a.Wm)(v,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[6]||(l[6]=e=>n.filter=e),placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(h,{key:0,align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),(0,a.Wm)(h),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(l=>((0,a.wg)(),(0,a.j4)(h,{key:l.name,props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,a.Wm)(y,{"context-menu":""},{default:(0,a.w5)((()=>[cn,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.columns,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(_,{modelValue:n.visibleColumns,"onUpdate:modelValue":l[7]||(l[7]=e=>n.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(W,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[1==n.showExploited(e.row.attempts)?((0,a.wg)(),(0,a.iD)("div",pn,[(0,a.Wm)(u,{class:"img-os_family",src:"icons/exploited.png"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[mn])),_:1})])),_:1})])):(0,a.kq)("",!0)])),_:2},1024),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,a.wg)(),(0,a.j4)(W,{key:l.name,align:"center"},{default:(0,a.w5)((()=>["service"==l.name?((0,a.wg)(),(0,a.iD)("div",_n,[null!=n.services_name_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.services_name_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"actions"==l.name?((0,a.wg)(),(0,a.iD)("div",gn,[(0,a.Wm)(r,{color:"green","icon-right":"edit",onClick:l=>n.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",onClick:l=>n.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):"cvss"==l.name?((0,a.wg)(),(0,a.iD)("div",fn,[l.value>=9?((0,a.wg)(),(0,a.j4)(x,{key:0,color:"black"},{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,o.zw)(l.value),1)])),_:2},1024)):l.value>=7&&l.value<9?((0,a.wg)(),(0,a.j4)(x,{key:1,color:"red"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):l.value>=4&&l.value<7?((0,a.wg)(),(0,a.j4)(x,{key:2,color:"orange"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):l.value<4&&null!=l.value?((0,a.wg)(),(0,a.j4)(x,{key:3,color:"green"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.value),1)])),_:2},1024)):(0,a.kq)("",!0)])):"refs"==l.name?((0,a.wg)(),(0,a.iD)("div",wn,[null!=l.value&&0!=l.value.length?((0,a.wg)(),(0,a.j4)(p,{key:0,bordered:"",class:"rounded-borders"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{"expand-separator":"",icon:"link",label:"Refs",size:"sm",caption:"Кол-во: "+l.value.length},{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.value,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[null!=e.id?((0,a.wg)(),(0,a.j4)(f,{key:e.id,color:"grey","text-color":"black",size:"sm",icon:"link"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.label),1)])),_:2},1024)):(0,a.kq)("",!0)])))),128))])),_:2},1024)])),_:2},1032,["caption"])])),_:2},1024)):(0,a.kq)("",!0)])):"details"==l.name?((0,a.wg)(),(0,a.iD)("div",vn,[(0,a.Wm)(r,{icon:"visibility",label:"Просмотр",size:"sm",onClick:e=>n.showDetails(l.value)},null,8,["onClick"])])):"info"==l.name?((0,a.wg)(),(0,a.iD)("div",bn,(0,o.zw)(l.value),1)):((0,a.wg)(),(0,a.iD)("div",hn,(0,o.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const yn=(0,a.Uk)("Minimize"),Wn=(0,a.Uk)("Maximize"),xn=(0,a.Uk)("Close"),Cn={class:"q-pa-md"},qn=(0,a._)("div",{class:"text-h6"}," Add Vulns ",-1),Vn=(0,a.Uk)(" No results "),Sn=["src"],zn=(0,a.Uk)(" No results "),Hn=(0,a.Uk)(" No results ");function Zn(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[yn])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Wn])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[xn])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",Cn,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[qn])),_:1}),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.row[0].address=e),label:"",hint:"IP-адрес","lazy-rules":"",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"]),(0,a.Wm)(v,{modelValue:n.row[0].port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.row[0].port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.row[0].service,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Vn])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.row[0].service)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.row[0].service),style:{width:"25px",height:"25px"}},null,8,Sn)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(v,{filled:"",modelValue:n.row[0].name,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].name=e),ref:"nameRef",rules:n.nameRules,"use-input":"","hide-selected":"","fill-input":"","options-selected-class":"text-deep-orange","input-debounce":"0",options:n.options2,onFilter:n.filterFn1,onFilterAbort:e.abortFilterFn,onInputValue:n.setModel1,hint:"Наименование уязвимости"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[zn])),_:1})])),_:1})])),_:1},8,["modelValue","rules","options","onFilter","onFilterAbort","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].info,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].info=e),label:"Text",hint:"Краткое описание","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(v,{filled:"",multiple:"",modelValue:n.row[0].refs,"onUpdate:modelValue":l[6]||(l[6]=e=>n.row[0].refs=e),"options-selected-class":"text-deep-orange","fill-input":"","input-debounce":"0",options:n.options3,onFilter:n.filterFn2,onFilterAbort:e.abortFilterFn,onInputValue:n.setModel2,hint:"Ссылки",label:"Object"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Hn])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onFilterAbort","onInputValue"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Un={props:{},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)(null),m=(0,r.iH)(null),_=(0,r.iH)(null),g=(0,r.iH)(null),f=(0,r.iH)([]),w=(0,r.iH)([]),v=(0,r.iH)([]),b=(0,r.iH)([]),h=(0,r.iH)([]),k=(0,r.iH)(s.state.current_tree_node),y=(0,r.iH)(null),W=(0,r.iH)([{id:-1,address:"",port:"",proto:"",service:"",name:"",info:"",description:"",solution:"",cvss:null,refs:[]}]),x=(0,r.iH)([]);function C(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_vulns",{headers:e}).then((e=>{b.value=e.data.map((e=>e.name))})).catch((()=>{}))}function V(e,l,t){_.value.validate(),_.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:W.value[0].address}))},headers:e}).then((e=>{f.value=[],e.data.forEach((e=>{f.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function S(e,l,t){setTimeout((()=>{l((()=>{if(""===e)w.value=b.value;else{const l=e.toLowerCase();w.value=b.value.filter((e=>e.toLowerCase().indexOf(l)>-1))}}))}),10)}function z(e,l,t){0==v.value.length?setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_refs",{headers:e}).then((e=>{v.value=[],e.data.forEach((e=>{v.value.push({label:e.name,ref_name:e.name,id:e.id})})),l()})).catch((()=>{}))}),1500):l()}function H(e){null!=e?(y.value=e.service_id,W.value[0].port=e.port,W.value[0].proto=e.proto,W.value[0].service=e.name):(y.value=e,W.value[0].port=e,W.value[0].proto=e,W.value[0].service=e)}function Z(e){W.value[0].name=e}function U(e){x=e}function Q(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function T(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/add_vuln",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(W.value[0].id=e.data.id,o({row:W}),(0,R.$)(i,"positive","Запись добавлена","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}function P(e,l){e.filter((e=>el.id))}return(0,a.bv)((()=>{k.value=s.state.current_tree_node,void 0!=k&&null!=k&&("subnet"!=k.value.type&&"host"!=k.value.type||(W.value[0].address=k.value.label)),C()})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),project_name:p,description:m,row:W,references:x,options:f,options2:w,options3:v,service_id:y,current_tree_node:k,StringOptions:b,StringOptions1:h,ipRef:_,nameRef:g,ipRules:[e=>null!=e&&1==Q(e)||"Введите валидный IP-адрес"],nameRules:[e=>null!=e||""!=e||"Поле не должно быть пустым"],onDialogHide:t,Ref_add_to_row:P,ValidateIPaddress:Q,unicVulns:C,filterFn:V,filterFn1:S,filterFn2:z,setModel:H,setModel1:Z,setModel2:U,Add_item:T,services_name_icon:I,onOKClick(){if(_.value.validate(),g.value.validate(),_.value.hasError||g.value.hasError);else{var e=JSON.parse(JSON.stringify(W.value[0]));e.refs=e.refs.map((e=>e.id)),T(s.state.current_project,JSON.stringify(e))}},onCancelClick:n}}},Qn=(0,N.Z)(Un,[["render",Zn]]),Tn=Qn;se()(Un,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QList:Qe.Z,QExpansionItem:Tl.Z,QCardActions:oe.Z}),se()(Un,"directives",{ClosePopup:ne.Z});const Dn=(0,a.Uk)("Minimize"),Rn=(0,a.Uk)("Maximize"),Pn=(0,a.Uk)("Close"),jn={class:"q-pa-md"},In={class:"text-h6"},On=(0,a.Uk)(" No results "),An=["src"],Mn=(0,a.Uk)(" No results "),Fn=(0,a.Uk)(" No results ");function Nn(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Dn])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Rn])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Pn])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",jn,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",In," Edit Vulns "+(0,o.zw)(n.prop1.address),1)])),_:1}),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.prop1.address=e),label:"",hint:"IP-адрес","lazy-rules":"",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"]),(0,a.Wm)(v,{modelValue:n.prop1.port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.prop1.port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.prop1.service,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[On])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.prop1.service)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.prop1.service),style:{width:"25px",height:"25px"}},null,8,An)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(v,{filled:"",modelValue:n.prop1.name,"onUpdate:modelValue":l[4]||(l[4]=e=>n.prop1.name=e),"use-input":"","hide-selected":"","fill-input":"","options-selected-class":"text-deep-orange","input-debounce":"0",options:n.options2,onFilter:n.filterFn1,onInputValue:n.setModel1,hint:"Наименование уязвимости"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Mn])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.info,"onUpdate:modelValue":l[5]||(l[5]=e=>n.prop1.info=e),label:"",hint:"Краткое описание","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(v,{filled:"",multiple:"",modelValue:n.prop1.refs,"onUpdate:modelValue":l[6]||(l[6]=e=>n.prop1.refs=e),"options-selected-class":"text-deep-orange","fill-input":"","input-debounce":"0",options:n.options3,onInputValue:n.setModel2,hint:"Ссылки","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Fn])),_:1})])),_:1})])),_:1},8,["modelValue","options","onInputValue"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Ln={props:{selected_items:Object},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)(null),m=(0,r.iH)(null),_=(0,r.iH)(null),g=(0,r.iH)([]),f=(0,r.iH)([]),w=(0,r.iH)([]),v=(0,r.iH)([]),b=(0,r.iH)([]),h=(0,r.iH)([]),k=(0,r.iH)(s.state.current_tree_node),y=(0,r.iH)(null);var W=null;const x=(0,r.iH)(JSON.parse(JSON.stringify(e.selected_items))),C=(0,r.iH)([{id:-1,address:"",port:"",proto:"",service:"",name:"",info:"",solution:"",cvss:null,references:[]}]),V=(0,r.iH)([]);function S(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_vulns",{headers:e}).then((e=>{v.value=e.data.map((e=>e.name))})).catch((()=>{}))}function z(){setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_refs",{headers:e}).then((e=>{w.value=[],e.data.forEach((e=>{w.value.push({label:e.name,value:e.name,id:e.id})})),h.value=e.data.map((e=>e.name)),update()})).catch((()=>{}))}),1500)}function H(e){setTimeout((()=>{const l={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/get_id_refs",{params:{vuln_id:e},headers:l}).then((e=>{let l=[];e.data.forEach((e=>{l.push(w.value.find((l=>l.id==e.ref_id))),console.log(w.value.find((l=>l.id==e.ref_id)),e.ref_id)})),V.value=l,update()})).catch((()=>{}))}),1500)}function Z(e,l,t){_.value.validate(),_.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:x.value.address}))},headers:e}).then((e=>{g.value=[],e.data.forEach((e=>{g.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function U(e,l,t){setTimeout((()=>{l((()=>{if(""===e)f.value=v.value;else{const l=e.toLowerCase();f.value=v.value.filter((e=>e.toLowerCase().indexOf(l)>-1))}}))}),10)}function Q(e,l,t){setTimeout((()=>{l((()=>{if(""===e)w.value=h.value;else{const l=e.toLowerCase();w.value=h.value.filter((e=>e.toLowerCase().indexOf(l)>-1))}}))}),10)}function T(e){null!=e?(y.value=e.service_id,x.value[0].port=e.port,x.value[0].service=e.name):(y.value=e,x.value[0].port=e,x.value[0].service=e)}function P(e){x.value.name=e}function j(e){x.value.refs=e,V.value=e}function O(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function A(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/edit_vuln",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(0==x.value.refs.length&&(x.value.refs=null),W=x.value,o({prop:W}),(0,R.$)(i,"positive","Запись отредактирована","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{k.value=s.state.current_tree_node,S(),z()})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),project_name:p,description:m,current_tree_node:k,row:C,prop:W,prop1:x,references:V,options:g,options2:f,options3:w,service_id:y,StringOptions:v,StringOptions1:b,StringOptions2:h,ipRef:_,ipRules:[e=>null!=e&&1==O(e)||"Введите валидный IP-адрес"],onDialogHide:t,ValidateIPaddress:O,unicVulns:S,services_name_icon:I,loaddata_refs:z,load_id_refs:H,filterFn:Z,filterFn1:U,filterFn2:Q,setModel:T,setModel1:P,setModel2:j,edit_item:A,onOKClick(){if(_.value.validate(),_.value.hasError);else{for(var e=JSON.parse(JSON.stringify(x.value)),l=[],t=0;t<x.value.refs.length;t++)try{l.push(w.value.find((e=>e.value==x.value.refs[t])).id)}catch(a){console.log(a),l.push(null)}e.refs=l,A(s.state.current_project,JSON.stringify(e))}},onCancelClick:n}}},Bn=(0,N.Z)(Ln,[["render",Nn]]),En=Bn;se()(Ln,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QList:Qe.Z,QExpansionItem:Tl.Z,QCardActions:oe.Z}),se()(Ln,"directives",{ClosePopup:ne.Z});const Kn=(0,a.Uk)("Minimize"),$n=(0,a.Uk)("Maximize"),Jn=(0,a.Uk)("Close"),Yn={class:"q-pa-md"},Gn=(0,a._)("div",{class:"text-h6"}," Details ",-1),Xn=(0,a.Uk)("CVSS"),ei={class:"text-caption"},li=(0,a._)("b",null,"Описание:",-1),ti={class:"text-caption"},ai=(0,a._)("b",null,"Как исправить:",-1);function oi(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-item-label"),_=(0,a.up)("q-badge"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-separator"),w=(0,a.up)("q-card"),v=(0,a.up)("q-card-actions"),b=(0,a.up)("q-dialog"),h=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(b,{ref:"dialogRef",maximized:e.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=l=>e.maximizedToggle=!1),disable:!e.maximizedToggle},{default:(0,a.w5)((()=>[e.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Kn])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=l=>e.maximizedToggle=!0),disable:e.maximizedToggle},{default:(0,a.w5)((()=>[e.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[$n])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Jn])),_:1})])),_:1})),[[h]])])),_:1}),(0,a._)("div",Yn,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[Gn])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.details,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a.Wm)(w,{style:{width:"100%"},flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[Xn])),_:1}),e.cvss>=9?((0,a.wg)(),(0,a.j4)(_,{key:0,color:"black"},{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,o.zw)(e.cvss),1)])),_:2},1024)):e.cvss>=7&&e.cvss<9?((0,a.wg)(),(0,a.j4)(_,{key:1,color:"red"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.cvss),1)])),_:2},1024)):e.cvss>=4&&e.cvss<7?((0,a.wg)(),(0,a.j4)(_,{key:2,color:"orange"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.cvss),1)])),_:2},1024)):e.cvss<4&&null!=e.cvss?((0,a.wg)(),(0,a.j4)(_,{key:3,color:"green"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.cvss),1)])),_:2},1024)):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(f),(0,a.Wm)(p,{horizontal:""},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",ei,[li,(0,a.Uk)(" "+(0,o.zw)(e.description),1)])])),_:2},1024),(0,a.Wm)(f,{vertical:""}),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",ti,[ai,(0,a.Uk)(" "+(0,o.zw)(e.solution),1)])])),_:2},1024)])),_:2},1024)])),_:2},1024)])))),128))]),(0,a.Wm)(v,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const ni={props:{details:Object},setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:a,onDialogCancel:o}=(0,D.Z)(),n=e.details;return{details:n,dialogRef:l,onDialogHide:t,onOKClick:o,onCancelClick:o}}},ii=(0,N.Z)(ni,[["render",oi]]),si=ii;se()(ni,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QItemSection:le.Z,QItemLabel:ae.Z,QBadge:Me.Z,QSeparator:Ol.Z,QCardActions:oe.Z}),se()(ni,"directives",{ClosePopup:ne.Z});const ri=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",label:"IP",align:"center",field:"address",sortable:!0},{name:"port",label:"Порт",align:"center",field:"port",sortable:!0},{name:"proto",label:"Протокол",align:"center",field:"proto",sortable:!0},{name:"service",label:"Служба",align:"center",field:"service",sortable:!0},{name:"name",label:"Наименование",align:"center",field:"name",sortable:!0},{name:"info",label:"Краткое описание",align:"center",field:"info",sortable:!0},{name:"cvss",label:"CVSS",align:"center",field:"cvss",sortable:!0},{name:"details",label:"Детали",align:"center",field:"details",sortable:!0},{name:"attempts",label:"Попытки эксплуатации",align:"center",field:"attempts",sortable:!0},{name:"refs",label:"Ссылка",align:"center",field:"refs",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],ui=[],di={name:"PageIndex",setup(){const e=(0,u.oR)(),l=(0,r.iH)([]),t=(0,q.Z)(),o=((0,r.iH)(!1),(0,r.iH)([...ui])),n=(0,r.iH)(!1),i=((0,r.iH)(null),(0,r.iH)(e.state.users),(0,r.iH)(e.state.current_tree_node)),s=(0,r.iH)(e.state.current_service),p=(0,r.iH)(!0),m=(0,r.iH)(!1),_=(0,r.iH)(""),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null);function v(){t.dialog({component:Tn,componentProps:{}}).onOk((e=>{o.value.push(e.row.value[0])}))}function b(){m.value=!0;const l={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_vulns",{params:{workspace:e.state.current_project,node:c.DS.encode(JSON.stringify(e.state.current_tree_node))},headers:l}).then((e=>{o.value=e.data,o.value.forEach((e=>{try{1==Array.isArray(e.refs)&&1==e.refs.length&&null==e.refs[0]&&(e.refs=null)}catch(l){console.log(l)}})),m.value=!1})).catch((()=>{m.value=!1,(0,R.$)(t,"negative","Ошибка","Не удалось загрузить "+g.value.title,"report_problem")}))}function h(a){setTimeout((()=>{const n={Authorization:"Bearer "+e.state.current_user.token};d.api.post("/del_vuln",{workspace:e.state.current_project,data:a},{headers:n}).then((e=>{200==e.data.rsp_k?(o.value.splice(o.value.indexOf(a),1),l.value=l.value.filter((e=>e.id!=a.id)),(0,R.$)(t,"positive","Запись удалена","","done")):(0,R.$)(t,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,R.$)(t,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function k(){for(var e=l.value.filter((e=>e.id)),t=0;t<e.length;t++)h(e[t])}function y(e){var l=o.value.find((l=>l.id==e.id));t.dialog({component:En,componentProps:{selected_items:l}}).onOk((e=>{if(void 0!=e){const l=o.value.findIndex((l=>l.id==e.prop.id));l>-1&&(o.value[l]=e.prop)}}))}function W(e){var l=!1;return e.forEach((e=>{try{1==e.exploited&&(l=!0)}catch(t){}})),l}function x(e){t.dialog({component:si,componentProps:{details:e}}).onOk()}function C(){xe(g,ri)}function V(){qe(g,ri)}function S(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function z(e){l.value=e.rows}function H(){e.commit("SET_CURRENT_TAB","vulns")}function Z(){return!(l.value.length>0)}return(0,a.YP)((()=>e.state.current_tree_node),(()=>{null!=e.state.current_tree_node&&(i.value=e.state.current_tree_node,b())})),(0,a.YP)((()=>e.state.current_tab),(()=>{"vulns"==e.state.current_tab?(f.value=e.state.current_tab,w.value="red"):w.value="grey"})),(0,a.bv)((()=>{"vulns"==e.state.current_tab?w.value="red":w.value="grey",b()})),{selected:l,columns:ri,Rows:o,store:e,additem:v,editItem:y,deleteItem:h,deleteItems:k,set_current_tab:H,to_csv:C,to_xls:V,btn_disable:Z,showExploited:W,showDetails:x,services_name_icon:I,pin_color:w,chiphost:p,tableSelectable:n,current_tree_node:i,q_table:g,drawChip:S,visibleColumns:(0,r.iH)(["exploited","address","port","service","name","info","cvss","details","refs","actions"]),getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${ui.length}`},current_service:s,loadData:b,handleSelectRow:z,loading:m,filter:_}}},ci=(0,N.Z)(di,[["render",kn]]),pi=ci;se()(di,"components",{QTable:C.Z,QBtn:$.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QToggle:Te.Z,QTooltip:J.Z,QChip:De.Z,QInput:G.Z,QIcon:Re.Z,QTr:Pe.Z,QTh:je.Z,QCheckbox:Ie.Z,QPopupProxy:Oe.Z,QTd:Ae.Z,QBadge:Me.Z,QExpansionItem:Tl.Z,QCard:B.Z}),se()(di,"directives",{ClosePopup:ne.Z});const mi=(0,a.Uk)("CSV "),_i=(0,a.Uk)("XLS "),gi={class:"text-h4"},fi=(0,a.Uk)(" Loots "),wi=(0,a.Uk)(" Закрепить компонент вверху "),vi={key:0},bi=(0,a._)("div",{align:"center"},"Visible Columns",-1),hi={key:0},ki={key:1},yi={key:2,align:"right"},Wi={key:3,class:"truncate-text"},xi={key:4};function Ci(e,l,t,n,i,s){const r=(0,a.up)("q-btn"),u=(0,a.up)("q-img"),d=(0,a.up)("q-item-section"),c=(0,a.up)("q-item"),p=(0,a.up)("q-list"),m=(0,a.up)("q-menu"),_=(0,a.up)("q-toggle"),g=(0,a.up)("q-tooltip"),f=(0,a.up)("q-chip"),w=(0,a.up)("q-icon"),v=(0,a.up)("q-input"),b=(0,a.up)("q-checkbox"),h=(0,a.up)("q-th"),k=(0,a.up)("q-tr"),y=(0,a.up)("q-popup-proxy"),W=(0,a.up)("q-td"),x=(0,a.up)("q-table"),C=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(x,{title:"Найденное",rows:n.Rows,columns:n.columns,"row-key":"id",ref:"q_table",selection:"multiple","selected-rows-label":n.getSelectedString,selected:n.selected,"onUpdate:selected":l[8]||(l[8]=e=>n.selected=e),onSelection:n.handleSelectRow,dense:"",loading:n.loading,filter:n.filter,"virtual-scroll":"","visible-columns":n.visibleColumns},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(r,{color:"green","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:n.additem},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:n.deleteItems,disable:n.btn_disable()},null,8,["onClick","disable"]),(0,a.Wm)(r,{color:"blue","icon-right":"file_download",label:"Download","no-caps":"",size:"sm",class:"button-top"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[0]||(l[0]=e=>n.to_csv()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/csv.png"}),mi])),_:1})])),_:1})),[[C]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{onClick:l[1]||(l[1]=e=>n.to_xls()),clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"node_icon",src:"icons/excel.png"}),_i])),_:1})])),_:1})),[[C]])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(_,{modelValue:n.tableSelectable,"onUpdate:modelValue":l[2]||(l[2]=e=>n.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",gi,[fi,(0,a.Wm)(r,{flat:"",round:"",color:n.pin_color,icon:"push_pin",onClick:l[3]||(l[3]=e=>n.set_current_tab())},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[wi])),_:1})])),_:1},8,["color"])]),0!=n.drawChip(n.current_tree_node)?((0,a.wg)(),(0,a.iD)("div",vi,[(0,a.Wm)(f,{modelValue:n.chiphost,"onUpdate:modelValue":l[4]||(l[4]=e=>n.chiphost=e),onRemove:l[5]||(l[5]=l=>e.removeChip()),icon:"subnets"===n.store.state.type_tree?"computer":"sell"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(n.current_tree_node.label),1)])),_:1},8,["modelValue","icon"])])):(0,a.kq)("",!0),(0,a.Wm)(v,{borderless:"",dense:"",debounce:"300",modelValue:n.filter,"onUpdate:modelValue":l[6]||(l[6]=e=>n.filter=e),placeholder:"Поиск"},{append:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(h,{key:0,align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(l=>((0,a.wg)(),(0,a.j4)(h,{key:l.name,props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,a.Wm)(y,{"context-menu":""},{default:(0,a.w5)((()=>[bi,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.columns,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(_,{modelValue:n.visibleColumns,"onUpdate:modelValue":l[7]||(l[7]=e=>n.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,a.w5)((e=>[(0,a.Wm)(k,{props:e},{default:(0,a.w5)((()=>[1==n.tableSelectable?((0,a.wg)(),(0,a.j4)(W,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,a.wg)(),(0,a.j4)(W,{key:l.name,align:"center"},{default:(0,a.w5)((()=>["service"==l.name?((0,a.wg)(),(0,a.iD)("div",hi,[null!=n.services_name_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.services_name_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"ltype"==l.name?((0,a.wg)(),(0,a.iD)("div",ki,[null!=n.notes_type_icon(l.value)?((0,a.wg)(),(0,a.j4)(u,{key:0,src:n.notes_type_icon(l.value),class:"node_icon"},null,8,["src"])):(0,a.kq)("",!0),(0,a._)("b",null,(0,o.zw)(l.value),1)])):"actions"==l.name?((0,a.wg)(),(0,a.iD)("div",yi,[(0,a.Wm)(r,{color:"green","icon-right":"edit",onClick:l=>n.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,a.Wm)(r,{color:"red","icon-right":"delete",onClick:l=>n.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):"data"==l.name?((0,a.wg)(),(0,a.iD)("div",Wi,(0,o.zw)(l.value),1)):((0,a.wg)(),(0,a.iD)("div",xi,(0,o.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}const qi=(0,a.Uk)("Minimize"),Vi=(0,a.Uk)("Maximize"),Si=(0,a.Uk)("Close"),zi={class:"q-pa-md"},Hi=(0,a._)("div",{class:"text-h6"}," Add Loots ",-1),Zi=(0,a.Uk)(" No results "),Ui=["src"],Qi=(0,a.Uk)(" No results "),Ti=["src"];function Di(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[qi])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Vi])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Si])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",zi,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[Hi])),_:1}),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.row[0].address=e),label:"Text",hint:"IP","lazy-rules":"",ref:"ipRef",rules:n.ipRules},null,8,["modelValue","rules"]),(0,a.Wm)(v,{modelValue:n.row[0].port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.row[0].port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.row[0].service,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Zi])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.row[0].service)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.row[0].service),style:{width:"25px",height:"25px"}},null,8,Ui)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(v,{filled:"",modelValue:n.row[0].ltype,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].ltype=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Text","emit-value":"",options:n.options1,onFilter:n.filterFn1,onInputValue:n.setModel1,hint:"Тип записи"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Qi])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.notes_type_icon(n.row[0].ltype)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.notes_type_icon(n.row[0].ltype),style:{width:"25px",height:"25px"}},null,8,Ti)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].name,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].name=e),label:"Text",hint:"Имя","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].info,"onUpdate:modelValue":l[6]||(l[6]=e=>n.row[0].info=e),label:"Text",hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.row[0].data,"onUpdate:modelValue":l[7]||(l[7]=e=>n.row[0].data=e),label:n.type_data,hint:"Данные","lazy-rules":"",autogrow:"",ref:"dataRef",rules:n.dataRules},null,8,["modelValue","label","rules"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Ri=[],Pi={props:{selected_items:Array},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)([]),m=(0,r.iH)(Ri),_=(0,r.iH)([...Ri]),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null),v=(0,r.iH)("Text");const b=(0,r.iH)(s.state.current_tree_node),h=(0,r.iH)([{id:-1,address:"",port:"",proto:"",service:"",ltype:"",name:"",info:"",data:""}]),k=(0,r.iH)(null);function y(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}function W(e,l,t){g.value.validate(),g.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:h.value[0].address}))},headers:e}).then((e=>{p.value=[],e.data.forEach((e=>{p.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function x(e,l,t){setTimeout((()=>{l((()=>{if(""===e)m.value=_.value;else{const l=e.toLocaleLowerCase();m.value=_.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function C(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_ltype",{headers:e}).then((e=>{_.value=e.data.map((function(e){return{value:e.ltype,label:e.ltype,image:A(e.ltype)}}))})).catch((()=>{}))}function V(e){null!=e?(k.value=e.service_id,h.value[0].port=e.port,h.value[0].service=e.name,h.value[0].proto=e.proto):(k.value=e,h.value[0].port=e,h.value[0].service=e,h.value[0].proto=e)}function S(e){h.value[0].ltype=e}function z(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function H(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/add_loots",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(h.value[0].id=e.data.id,o({row:h}),(0,R.$)(i,"positive","Запись отредактирована","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{b.value=s.state.current_tree_node,void 0!=b&&null!=b&&("subnet"!=b.value.type&&"host"!=b.value.type||(h.value[0].address=b.value.label)),C()})),(0,a.YP)((()=>h.value[0].data),(()=>{v.value=y(h.value[0].data)})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),row:h,type_data:v,current_tree_node:b,options:p,options1:m,StringOptions:_,service_id:k,ipRef:g,dataRef:w,portRef:f,ipRules:[e=>null!=e&&1==z(e)||"Введите валидный IP-адрес"],dataRules:[e=>null!=e&&""!=e||"Поле дата не должно быть пустым"],filterFn:W,filterFn1:x,ValidateIPaddress:z,setModel:V,setModel1:S,services_name_icon:I,notes_type_icon:A,add_loots:H,unicLtype:C,onDialogHide:t,onOKClick(){g.value.validate(),w.value.validate(),g.value.hasError||w.value.hasError||H(s.state.current_project,JSON.stringify(h.value[0],(function(e,l){if("data"==e)try{l=c.DS.fromUint8Array((0,We.$w)(JSON.parse(l)).buffer,!0)}catch{l=c.DS.encode(l,!0)}return l})))},onCancelClick:n}}},ji=(0,N.Z)(Pi,[["render",Di]]),Ii=ji;se()(Pi,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(Pi,"directives",{ClosePopup:ne.Z});const Oi=(0,a.Uk)("Minimize"),Ai=(0,a.Uk)("Maximize"),Mi=(0,a.Uk)("Close"),Fi={class:"q-pa-md"},Ni={class:"text-h6"},Li=(0,a.Uk)(" No results "),Bi=["src"],Ei=(0,a.Uk)(" No results "),Ki=["src"];function $i(e,l,t,n,i,s){const r=(0,a.up)("q-space"),u=(0,a.up)("q-tooltip"),d=(0,a.up)("q-btn"),c=(0,a.up)("q-bar"),p=(0,a.up)("q-card-section"),m=(0,a.up)("q-input"),_=(0,a.up)("q-img"),g=(0,a.up)("q-item-section"),f=(0,a.up)("q-item-label"),w=(0,a.up)("q-item"),v=(0,a.up)("q-select"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),y=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(k,{ref:"dialogRef",maximized:n.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"q-dialog-plugin",style:{"min-width":"700px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r),(0,a.Wm)(d,{dense:"",flat:"",icon:"minimize",onClick:l[0]||(l[0]=e=>n.maximizedToggle=!1),disable:!n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Oi])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"]),(0,a.Wm)(d,{dense:"",flat:"",icon:"crop_square",onClick:l[1]||(l[1]=e=>n.maximizedToggle=!0),disable:n.maximizedToggle},{default:(0,a.w5)((()=>[n.maximizedToggle?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Ai])),_:1}))])),_:1},8,["disable"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(d,{dense:"",flat:"",icon:"close"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"bg-white text-primary"},{default:(0,a.w5)((()=>[Mi])),_:1})])),_:1})),[[y]])])),_:1}),(0,a._)("div",Fi,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",Ni," Edit Loots "+(0,o.zw)(n.prop1.address),1)])),_:1}),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.address,"onUpdate:modelValue":l[2]||(l[2]=e=>n.prop1.address=e),label:"",hint:"IP","lazy-rules":"",ref:"ipRef",rules:n.ipRules,readonly:""},null,8,["modelValue","rules"]),(0,a.Wm)(v,{modelValue:n.prop1.port,"onUpdate:modelValue":[l[3]||(l[3]=e=>n.prop1.port=e),n.setModel],filled:"",clearable:"","input-debounce":"0",label:n.prop1.service,options:n.options,onFilter:n.filterFn,hint:"Сервис","emit-value":""},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Li])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.services_name_icon(n.prop1.service)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.services_name_icon(n.prop1.service),style:{width:"25px",height:"25px"}},null,8,Bi)):(0,a.kq)("",!0)])),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(v,{filled:"",modelValue:n.prop1.ltype,"onUpdate:modelValue":l[4]||(l[4]=e=>n.prop1.ltype=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",label:"Text","emit-value":"",options:n.options1,onFilter:n.filterFn1,onInputValue:n.setModel1,hint:"Тип записи"},{option:(0,a.w5)((e=>[(0,a.Wm)(w,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(g,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{src:e.opt.image},null,8,["src"])])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),"no-option":(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-grey"},{default:(0,a.w5)((()=>[Ei])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[null!=n.notes_type_icon(n.prop1.ltype)?((0,a.wg)(),(0,a.iD)("img",{key:0,src:n.notes_type_icon(n.prop1.ltype),style:{width:"25px",height:"25px"}},null,8,Ki)):(0,a.kq)("",!0)])),_:1},8,["modelValue","options","onFilter","onInputValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.name,"onUpdate:modelValue":l[5]||(l[5]=e=>n.prop1.name=e),hint:"Имя","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.info,"onUpdate:modelValue":l[6]||(l[6]=e=>n.prop1.info=e),hint:"Информация","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,a.Wm)(m,{filled:"",modelValue:n.prop1.data,"onUpdate:modelValue":l[7]||(l[7]=e=>n.prop1.data=e),label:n.type_data,hint:"Данные","lazy-rules":"",autogrow:"",ref:"dataRef",rules:n.dataRules},null,8,["modelValue","label","rules"])]),(0,a.Wm)(b,{align:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,a.Wm)(d,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["maximized"])}const Ji=[],Yi={props:{selected_items:Object},emits:[...D.Z.emits],setup(e){const{dialogRef:l,onDialogHide:t,onDialogOK:o,onDialogCancel:n}=(0,D.Z)(),i=(0,q.Z)(),s=(0,u.oR)(),p=(0,r.iH)([]),m=(0,r.iH)(Ji),_=(0,r.iH)([...Ji]),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null),v=(0,r.iH)("Text");var b=null;const h=(0,r.iH)(s.state.current_tree_node),k=(0,r.iH)(JSON.parse(JSON.stringify(e.selected_items)));try{"object"==typeof k.value.data&&(v.value="JSON",k.value.data=JSON.stringify(JSON.parse(JSON.stringify(k.value.data)),null,2))}catch(U){v.value="Text"}const y=(0,r.iH)(null);function W(e){try{return JSON.parse(e),"JSON"}catch{return"Text"}}function x(e,l,t){g.value.validate(),g.value.hasError||setTimeout((()=>{const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_services",{params:{workspace:s.state.current_project,node:c.DS.encode(JSON.stringify({type:"host",label:k.value.address}))},headers:e}).then((e=>{p.value=[],e.data.forEach((e=>{p.value.push({label:e.port+"/"+e.proto+" ("+e.name+")",port:e.port,name:e.name,service_id:e.id,proto:e.proto,image:I(e.name)})})),l()})).catch((()=>{}))}),1500)}function C(e,l,t){setTimeout((()=>{l((()=>{if(""===e)m.value=_.value;else{const l=e.toLocaleLowerCase();m.value=_.value.filter((e=>null!=e.label&&e.label.toLowerCase().indexOf(l)>-1))}}))}),10)}function V(){const e={Authorization:"Bearer "+s.state.current_user.token};d.api.get("/api/get_unic_ltype",{headers:e}).then((e=>{_.value=e.data.map((function(e){return{value:e.ltype,label:e.ltype,image:A(e.ltype)}}))})).catch((()=>{}))}function S(e){null!=e?(y.value=e.service_id,k.value.port=e.port,k.value.service=e.name,k.value.proto=e.proto):(y.value=e,k.value.port=e,k.value.service=e,k.value.proto=e)}function z(e){k.value.ltype=e}function H(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}async function Z(e,l){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+s.state.current_user.token};d.api.post("/api/edit_loots",{workspace:e,data:l},{headers:a}).then((e=>{200==e.data.rsp_k?(b=k.value,o({prop:b}),(0,R.$)(i,"positive","Запись отредактирована","","done")):((0,R.$)(i,"negative","Ошибка",e.data.message,"report_problem"),t(!1))})).catch((()=>{(0,R.$)(i,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),a=await t;return a}return(0,a.bv)((()=>{h.value=s.state.current_tree_node,v.value=W(k.value.data),V()})),(0,a.YP)((()=>k.value.data),(()=>{v.value=W(k.value.data)})),{dialogRef:l,maximizedToggle:(0,r.iH)(!1),prop1:k,prop:b,type_data:v,current_tree_node:h,options:p,options1:m,StringOptions:_,service_id:y,ipRef:g,dataRef:w,portRef:f,ipRules:[e=>null!=e&&1==H(e)||"Введите валидный IP-адрес"],dataRules:[e=>null!=e&&""!=e||"Поле дата не должно быть пустым"],filterFn:x,filterFn1:C,setModel:S,setModel1:z,services_name_icon:I,notes_type_icon:A,ValidateIPaddress:H,edit_loots:Z,unicLtype:V,onDialogHide:t,onOKClick(){g.value.validate(),w.value.validate(),g.value.hasError||w.value.hasError||Z(s.state.current_project,JSON.stringify(k.value,(function(e,l){if("data"==e)try{l=c.DS.fromUint8Array((0,We.$w)(JSON.parse(l)).buffer,!0)}catch{l=c.DS.encode(l,!0)}return l})))},onCancelClick:n}}},Gi=(0,N.Z)(Yi,[["render",$i]]),Xi=Gi;se()(Yi,"components",{QDialog:L.Z,QCard:B.Z,QBar:E.Z,QSpace:K.Z,QBtn:$.Z,QTooltip:J.Z,QCardSection:Y.Z,QInput:G.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QItemLabel:ae.Z,QCardActions:oe.Z}),se()(Yi,"directives",{ClosePopup:ne.Z});const es=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"address",label:"IP",align:"center",field:"address",sortable:!0},{name:"port",label:"Порт",align:"center",field:"port",sortable:!0},{name:"proto",label:"Протокол",align:"center",field:"proto",sortable:!0},{name:"service",label:"Служба",align:"center",field:"service",sortable:!0},{name:"ltype",label:"Тип",align:"center",field:"ltype",sortable:!0},{name:"name",label:"Имя",align:"center",field:"name",sortable:!0},{name:"info",label:"Информация",align:"center",field:"info",sortable:!0},{name:"path",label:"Путь",align:"center",field:"path",sortable:!0},{name:"data",label:"Данные",align:"center",field:"data",sortable:!0},{name:"content_type",label:"Тип данных",align:"center",field:"content_type",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],ls=[],ts={name:"PageIndex",setup(){const e=(0,u.oR)(),l=(0,r.iH)([]),t=(0,r.iH)(!1),o=(0,q.Z)(),n=((0,r.iH)(!1),(0,r.iH)([...ls])),i=((0,r.iH)(null),(0,r.iH)(e.state.users),(0,r.iH)(e.state.current_tree_node)),s=(0,r.iH)(e.state.current_service),p=(0,r.iH)(!0),m=(0,r.iH)(!1),_=(0,r.iH)(""),g=(0,r.iH)(null),f=(0,r.iH)(null),w=(0,r.iH)(null);function v(){o.dialog({component:Ii,componentProps:{}}).onOk((e=>{n.value.push(e.row.value[0])}))}function b(){m.value=!0;const l={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_loots",{params:{workspace:e.state.current_project,node:c.DS.encode(JSON.stringify(e.state.current_tree_node))},headers:l}).then((e=>{n.value=e.data,n.value.forEach((e=>{try{e.data=(0,We.zD)(c.DS.toUint8Array(e.data).buffer,{hashToJS:!0})}catch(l){e.data=c.DS.decode(e.data)}})),m.value=!1})).catch((()=>{m.value=!1,(0,R.$)(o,"negative","Ошибка","Не удалось загрузить "+g.value.title,"report_problem")}))}function h(t){setTimeout((()=>{const a={Authorization:"Bearer "+e.state.current_user.token};d.api.post("/api/del_loots",{workspace:e.state.current_project,data:t},{headers:a}).then((e=>{200==e.data.rsp_k?(n.value.splice(n.value.indexOf(t),1),l.value=l.value.filter((e=>e.id!=t.id)),(0,R.$)(o,"positive","Запись удалена","","done")):(0,R.$)(o,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,R.$)(o,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function k(){for(var e=l.value.filter((e=>e.id)),t=0;t<e.length;t++)h(e[t])}function y(e){var l=n.value.find((l=>l.id==e.id));o.dialog({component:Xi,componentProps:{selected_items:l}}).onOk((e=>{if(void 0!=e){const l=n.value.findIndex((l=>l.id==e.prop.id));l>-1&&(n.value[l]=e.prop)}}))}function W(){xe(g,es)}function x(){qe(g,es)}function C(e){var l=!0;return null!=e&&""!=e&&void 0!=e||(l=!1),l}function V(e){l.value=e.rows}function S(){e.commit("SET_CURRENT_TAB","loots")}function z(){return!(l.value.length>0)}return(0,a.YP)((()=>e.state.current_tree_node),(()=>{null!=e.state.current_tree_node&&(i.value=e.state.current_tree_node,b())})),(0,a.YP)((()=>e.state.current_tab),(()=>{"loots"==e.state.current_tab?(f.value=e.state.current_tab,w.value="red"):w.value="grey"})),(0,a.bv)((()=>{"loots"==e.state.current_tab?w.value="red":w.value="grey",b()})),{selected:l,columns:es,Rows:n,store:e,pin_color:w,chiphost:p,current_tree_node:i,current_service:s,loading:m,filter:_,q_table:g,tableSelectable:t,visibleColumns:(0,r.iH)(["address","port","service","ltype","data","name","info","actions"]),handleSelectRow:V,additem:v,editItem:y,deleteItem:h,drawChip:C,deleteItems:k,set_current_tab:S,btn_disable:z,services_name_icon:I,notes_type_icon:A,to_csv:W,to_xls:x,getSelectedString(){return 0===l.value.length?"":`${l.value.length} record${l.value.length>1?"s":""} selected of ${ls.length}`},pagination:(0,r.iH)({rowsPerPage:0})}}},as=(0,N.Z)(ts,[["render",Ci]]),os=as;function ns(e,l,t,a,o,n){return null}se()(ts,"components",{QTable:C.Z,QBtn:$.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QImg:te.Z,QToggle:Te.Z,QTooltip:J.Z,QChip:De.Z,QInput:G.Z,QIcon:Re.Z,QTr:Pe.Z,QTh:je.Z,QCheckbox:Ie.Z,QPopupProxy:Oe.Z,QTd:Ae.Z}),se()(ts,"directives",{ClosePopup:ne.Z});const is=(0,a.aZ)({name:"PageIndex",components:{},setup(){const e=(0,u.oR)(),l=(0,r.iH)(e.state.current_host),t=(0,r.iH)("sites"),o=(0,r.iH)("sites"),n=(0,r.iH)(e.state.current_service),i=(0,r.iH)(e.state.current_host_label);async function s(){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/get_count_info",{params:{workspace:e.state.current_project,label:i.value,host:l.value},headers:a}).then((e=>{Rows.value[0].hosts=e.data.hosts,Rows.value[0].services=e.data.services,Rows.value[0].creds=e.data.creds,Rows.value[0].vulns=e.data.vulns,Rows.value[0].notes=e.data.notes,Rows.value[0].loots=e.data.loots})).catch((()=>{t(!1)}))}),1e3)})),a=await t;return a}return(0,a.YP)((()=>e.state.current_host),(()=>{null!=e.state.current_host&&(l.value=e.state.current_host,i.value=e.state.current_host_label,s())})),(0,a.YP)((()=>e.state.current_tab),(()=>{t.value=e.state.current_tab;let l=e.state.all_tab.indexOf(t.value);l!=e.state.all_tab.length-1?o.value=e.state.all_tab[l+1]:o.value=e.state.all_tab[0]})),{current_host:l,current_tab:t,current_service:n,current_host_label:i,tab:o}}}),ss=(0,N.Z)(is,[["render",ns]]),rs=ss,us={class:"cursor-pointer non-selectable"},ds=(0,a.Uk)(" File "),cs=(0,a.Uk)("Import"),ps=(0,a.Uk)("Export"),ms=(0,a.Uk)("Preferences"),_s=(0,a.Uk)("Submenu Label"),gs=(0,a.Uk)("3rd level Label"),fs=(0,a.Uk)("Quit"),ws={class:"q-ml-md cursor-pointer non-selectable"},vs=(0,a.Uk)(" Edit "),bs=(0,a.Uk)("Cut"),hs=(0,a.Uk)("Copy"),ks=(0,a.Uk)("Paste"),ys=(0,a.Uk)("Select All");function Ws(e,l){const t=(0,a.up)("q-item-section"),o=(0,a.up)("q-item"),n=(0,a.up)("q-separator"),i=(0,a.up)("q-icon"),s=(0,a.up)("q-list"),r=(0,a.up)("q-menu"),u=(0,a.up)("q-bar"),d=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",us,[ds,(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s,{dense:"",style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[cs])),_:1})])),_:1})),[[d]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[ps])),_:1})])),_:1})),[[d]]),(0,a.Wm)(n),(0,a.Wm)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[ms])),_:1}),(0,a.Wm)(t,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"keyboard_arrow_right"})])),_:1}),(0,a.Wm)(r,{anchor:"top end",self:"top start"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(3,(e=>(0,a.Wm)(o,{key:e,dense:"",clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[_s])),_:1}),(0,a.Wm)(t,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"keyboard_arrow_right"})])),_:1}),(0,a.Wm)(r,{"auto-close":"",anchor:"top end",self:"top start"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(3,(e=>(0,a.Wm)(o,{key:e,dense:"",clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[gs])),_:1})])),_:2},1024))),64))])),_:2},1024)])),_:2},1024)])),_:2},1024))),64))])),_:1})])),_:1})])),_:1}),(0,a.Wm)(n),(0,a.wy)(((0,a.wg)(),(0,a.j4)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[fs])),_:1})])),_:1})),[[d]])])),_:1})])),_:1})]),(0,a._)("div",ws,[vs,(0,a.Wm)(r,{"auto-close":""},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{dense:"",style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[bs])),_:1})])),_:1}),(0,a.Wm)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[hs])),_:1})])),_:1}),(0,a.Wm)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[ks])),_:1})])),_:1}),(0,a.Wm)(n),(0,a.Wm)(o,{clickable:""},{default:(0,a.w5)((()=>[(0,a.Wm)(t,null,{default:(0,a.w5)((()=>[ys])),_:1})])),_:1})])),_:1})])),_:1})])])),_:1})}const xs={},Cs=(0,N.Z)(xs,[["render",Ws]]),qs=Cs;se()(xs,"components",{QBar:E.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QItemSection:le.Z,QSeparator:Ol.Z,QIcon:Re.Z}),se()(xs,"directives",{ClosePopup:ne.Z});const Vs=[{hosts:0,services:0,notes:0,creds:0,vulns:0,loots:0,web:0}],Ss=(0,a.aZ)({name:"PageIndex",components:{TableServices:Ne,TableNotes:pa,TreeHosts:Xa,TableCreds:an,TableVulns:pi,TableHosts:ht,TableLoots:os,TreeBar:qs,Web:rs},setup(){const e=(0,u.oR)(),l=(0,r.iH)([...Vs]),t=(0,r.iH)(e.state.current_host),o=((0,r.iH)(e.state.current_service),(0,r.iH)(e.state.current_host_label)),n=(0,r.iH)(),i=(0,r.iH)("services"),s=(0,r.iH)(e.state.current_tab),p=(0,r.iH)(e.state.all_tab[1]);function m(e){console.log(e)}function _(e){console.log(e)}function g(e){}function f(e){i.value="services",console.log(e)}async function w(){let t=new Promise(((t,a)=>{setTimeout((()=>{t(!1);const a={Authorization:"Bearer "+e.state.current_user.token};d.api.get("/api/get_count_info",{params:{workspace:e.state.current_project,node:c.DS.encode(JSON.stringify(e.state.current_tree_node))},headers:a}).then((e=>{l.value[0].hosts=e.data.hosts,l.value[0].services=e.data.services,l.value[0].creds=e.data.creds,l.value[0].vulns=e.data.vulns,l.value[0].notes=e.data.notes,l.value[0].loots=e.data.loots})).catch((()=>{t(!1)}))}),1e3)})),a=await t;return a}return(0,a.YP)((()=>e.state.current_tree_node),(()=>{null!=e.state.type_tree&&w()})),(0,a.YP)((()=>e.state.current_tab),(()=>{s.value=e.state.current_tab;let l=e.state.all_tab.indexOf(s.value);l!=e.state.all_tab.length-1?p.value=e.state.all_tab[l+1]:p.value=e.state.all_tab[0]})),{current_host:t,treehostsRef:n,Rows:l,main_tab:i,current_tab:s,Addhost:m,Edithost:g,Delhost:_,fix_up:f,current_host_label:o,splitterModel:(0,r.iH)(8),splitterModel1:(0,r.iH)(95),splitterModel2:(0,r.iH)(45),tab:p}}});var zs=t(7498),Hs=t(9800),Zs=t(4106),Us=t(7817),Qs=t(900);const Ts=(0,N.Z)(Ss,[["render",s]]),Ds=Ts;se()(Ss,"components",{QPage:Ya.Z,QSplitter:zs.Z,QTabPanels:Hs.Z,QTabPanel:Zs.Z,QTabs:Us.Z,QTab:Qs.Z,QBadge:Me.Z,QMenu:Ue.Z,QList:Qe.Z,QItem:ee.Z,QIcon:Re.Z,QItemSection:le.Z,QSeparator:Ol.Z}),se()(Ss,"directives",{ClosePopup:ne.Z})}}]);