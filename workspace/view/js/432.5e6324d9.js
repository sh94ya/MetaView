"use strict";(globalThis["webpackChunkMetaView"]=globalThis["webpackChunkMetaView"]||[]).push([[432],{8051:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Rt});var o=a(1758);const r={class:"row",style:{"padding-bottom":"10px"}},s={class:"col",style:{"padding-right":"10px"}},n={class:"col"},l={class:"row"},c={class:"col",style:{"padding-right":"10px"}},u={class:"col"};function i(t,e,a,i,d,p){const _=(0,o.g2)("chart-donut"),v=(0,o.g2)("chart-column"),b=(0,o.g2)("top-services"),k=(0,o.g2)("top-creds");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",r,[(0,o.Lk)("div",s,[(0,o.bF)(_)]),(0,o.Lk)("div",n,[(0,o.bF)(v)])]),(0,o.Lk)("div",l,[(0,o.Lk)("div",c,[(0,o.bF)(b)]),(0,o.Lk)("div",u,[(0,o.bF)(k)])])])}var d=a(660),p=a(8790);const _={class:"row items-center no-wrap"},v={class:"col-auto"},b={class:"text-caption text-grey"};function k(t,e,a,r,s,n){const l=(0,o.g2)("q-btn"),c=(0,o.g2)("q-card-actions"),u=(0,o.g2)("q-item-section"),i=(0,o.g2)("q-item"),d=(0,o.g2)("q-list"),k=(0,o.g2)("q-card-section"),m=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.Wv)(m,{class:"my-card",flat:"",bordered:""},{default:(0,o.k6)(()=>[(0,o.bF)(k,{horizontal:""},{default:(0,o.k6)(()=>[(0,o.bF)(k,{class:"q-pt-xs"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",_,[e[0]||(e[0]=(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("div",{class:"text-h6"},"Top 5 Services")],-1)),(0,o.Lk)("div",v,[(0,o.bF)(c,{align:"around"},{default:(0,o.k6)(()=>[(0,o.bF)(l,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])]),_:1})])]),(0,o.Lk)("div",b,[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.Rows,(t,e)=>((0,o.uX)(),(0,o.Wv)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"col-auto text-black text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(e+1)+")",1)]),_:2},1024),(0,o.bF)(u,{class:"col-auto text-black text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(t.port)+"/"+(0,p.v_)(t.proto)+"("+(0,p.v_)(t.name)+")",1)]),_:2},1024),(0,o.bF)(u,{class:"col-auto text-green text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(t.count),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})])]),_:1})]),_:1})]),_:1})}a(2500),a(9583);var m=a(8734),g=a(4907),h=a(6980),f=a(5745),A=[];const C=(0,o.pM)({name:"TopServices",setup(){const t=(0,h.Pj)(),e=(0,m.KR)([...A]),a=(0,m.KR)(t.state.current_project),r=(0,m.KR)(t.state.current_project_label),s=(0,g.A)();async function n(){let a=new Promise((a,o)=>{setTimeout(()=>{a(!1);const o={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/get_top_service",{params:{workspace:t.state.current_project},headers:o}).then(t=>{e.value=t.data}).catch(()=>{(0,f.e)(s,"negative","Ошибка","","report_problem"),a(!1)})},1e3)}),o=await a;return o}return(0,o.sV)(()=>{n()}),{Rows:e,current_project:a,current_project_label:r,GetData:n}}});var w=a(2807),x=a(3316),F=a(4189),R=a(2669),q=a(6384),L=a(3999),Q=a(124),j=a(5173),K=a(8582),S=a.n(K);const y=(0,w.A)(C,[["render",k]]),V=y;S()(C,"components",{QCard:x.A,QCardSection:F.A,QCardActions:R.A,QBtn:q.A,QList:L.A,QItem:Q.A,QItemSection:j.A});const T={class:"row items-center"},W={class:"col"},O={class:"col-auto"},D={class:""};function M(t,e,a,r,s,n){const l=(0,o.g2)("q-select"),c=(0,o.g2)("q-btn"),u=(0,o.g2)("q-card-actions"),i=(0,o.g2)("VueApexCharts"),d=(0,o.g2)("q-card-section"),p=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.Wv)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,{class:""},{default:(0,o.k6)(()=>[(0,o.Lk)("div",T,[(0,o.Lk)("div",W,[(0,o.bF)(l,{modelValue:t.model,"onUpdate:modelValue":[e[0]||(e[0]=e=>t.model=e),t.SetModel],options:t.Options},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,o.Lk)("div",O,[(0,o.bF)(u,{align:"around"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])]),_:1})])]),(0,o.Lk)("div",D,[(0,o.bF)(i,{type:"bar",ref:"ChartColumn",width:"100%",height:"500",options:t.ChartOptions,series:t.Series},null,8,["options","series"])])]),_:1})]),_:1})}a(3150),a(4823);var X=a(3868),z=a.n(X),B=[];const P=[{name:"Count",data:[]}],G={chart:{type:"bar"},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",endingShape:"rounded"}},dataLabels:{enabled:!0},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:[]},yaxis:{title:{text:""}},fill:{opacity:1},tooltip:{y:{formatter:function(t){return t+" "}}}},I=["Top Vulns","Access Rights"],E=(0,o.pM)({name:"TopVulns",components:{VueApexCharts:z()},setup(){const t=(0,h.Pj)(),e=(0,m.KR)([...B]),a=(0,m.KR)(t.state.current_project),r=(0,m.KR)(t.state.current_project_label),s=(0,g.A)(),n=(0,m.KR)(P),l=(0,m.KR)(G),c=(0,m.KR)("/get_top_vuln"),u=(0,m.KR)(I),i=(0,m.KR)(null);async function p(){let e=new Promise((e,a)=>{setTimeout(()=>{e(!1);const a={Authorization:"Bearer "+t.state.current_user.token};d.api.get(c.value,{params:{workspace:t.state.current_project},headers:a}).then(t=>{var e=[],a=[];t.data.forEach(function(t,o,r){e.push(t.count),null==t.value?a.push("<Blank>"):a.push(t.value)}),n.value[0].data=e,i.value.updateOptions({xaxis:{categories:a}})}).catch(()=>{(0,f.e)(s,"negative","Ошибка","","report_problem"),e(!1)})},1e3)}),a=await e;return a}function _(t){t==I[0]?c.value="/get_top_vuln":t==I[1]&&(c.value="/get_distinct_creds_type"),p(c)}return(0,o.sV)(()=>{p()}),{Rows:e,current_project:a,current_project_label:r,uri:c,GetData:p,SetModel:_,Series:n,ChartOptions:l,ChartColumn:i,model:(0,m.KR)(I[0]),Options:u}}});var U=a(5848);const H=(0,w.A)(E,[["render",M]]),N=H;S()(E,"components",{QCard:x.A,QCardSection:F.A,QSelect:U.A,QCardActions:R.A,QBtn:q.A});const Y={class:"row items-center no-wrap"},J={class:"col-auto"},Z={class:"text-caption text-grey"};function $(t,e,a,r,s,n){const l=(0,o.g2)("q-btn"),c=(0,o.g2)("q-card-actions"),u=(0,o.g2)("q-item-section"),i=(0,o.g2)("q-item"),d=(0,o.g2)("q-list"),_=(0,o.g2)("q-card-section"),v=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.Wv)(v,{class:"my-card",flat:"",bordered:""},{default:(0,o.k6)(()=>[(0,o.bF)(_,{horizontal:""},{default:(0,o.k6)(()=>[(0,o.bF)(_,{class:"q-pt-xs"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",Y,[e[0]||(e[0]=(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("div",{class:"text-h6"},"Top 5 OS Name")],-1)),(0,o.Lk)("div",J,[(0,o.bF)(c,{align:"around"},{default:(0,o.k6)(()=>[(0,o.bF)(l,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])]),_:1})])]),(0,o.Lk)("div",Z,[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.Rows,(t,e)=>((0,o.uX)(),(0,o.Wv)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"col-auto text-black text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(e+1)+")",1)]),_:2},1024),(0,o.bF)(u,{class:"col-auto text-black text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(t.value),1)]),_:2},1024),(0,o.bF)(u,{class:"col-auto text-green text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(t.count),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})])]),_:1})]),_:1})]),_:1})}var tt=[];const et=(0,o.pM)({name:"TopServices",setup(){const t=(0,h.Pj)(),e=(0,m.KR)([...tt]),a=(0,m.KR)(t.state.current_project),r=(0,m.KR)(t.state.current_project_label),s=(0,g.A)();async function n(){let a=new Promise((a,o)=>{setTimeout(()=>{a(!1);const o={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/get_top_os_name",{params:{workspace:t.state.current_project},headers:o}).then(t=>{e.value=t.data}).catch(()=>{(0,f.e)(s,"negative","Ошибка","","report_problem"),a(!1)})},1e3)}),o=await a;return o}return(0,o.sV)(()=>{n()}),{Rows:e,current_project:a,current_project_label:r,GetData:n}}}),at=(0,w.A)(et,[["render",$]]),ot=at;S()(et,"components",{QCard:x.A,QCardSection:F.A,QCardActions:R.A,QBtn:q.A,QList:L.A,QItem:Q.A,QItemSection:j.A});const rt={class:"row items-center no-wrap"},st={class:"col-auto"},nt={class:"text-caption text-grey"};function lt(t,e,a,r,s,n){const l=(0,o.g2)("q-btn"),c=(0,o.g2)("q-card-actions"),u=(0,o.g2)("q-item-section"),i=(0,o.g2)("q-item"),d=(0,o.g2)("q-list"),_=(0,o.g2)("q-card-section"),v=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.Wv)(v,{class:"my-card",flat:"",bordered:""},{default:(0,o.k6)(()=>[(0,o.bF)(_,{horizontal:""},{default:(0,o.k6)(()=>[(0,o.bF)(_,{class:"q-pt-xs"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",rt,[e[0]||(e[0]=(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("div",{class:"text-h6"},"Top 5 Password")],-1)),(0,o.Lk)("div",st,[(0,o.bF)(c,{align:"around"},{default:(0,o.k6)(()=>[(0,o.bF)(l,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])]),_:1})])]),(0,o.Lk)("div",nt,[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.Rows,(t,e)=>((0,o.uX)(),(0,o.Wv)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"col-auto text-black text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(e+1)+")",1)]),_:2},1024),(0,o.bF)(u,{class:"col-auto text-black text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(t.passwords),1)]),_:2},1024),(0,o.bF)(u,{class:"col-auto text-green text-bold"},{default:(0,o.k6)(()=>[(0,o.eW)((0,p.v_)(t.count),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})])]),_:1})]),_:1})]),_:1})}var ct=[];const ut=(0,o.pM)({name:"TopServices",setup(){const t=(0,h.Pj)(),e=(0,m.KR)([...ct]),a=(0,m.KR)(t.state.current_project),r=(0,m.KR)(t.state.current_project_label),s=(0,g.A)();async function n(){let a=new Promise((a,o)=>{setTimeout(()=>{a(!1);const o={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/get_top_creds",{params:{workspace:t.state.current_project},headers:o}).then(t=>{e.value=t.data}).catch(()=>{(0,f.e)(s,"negative","Ошибка","","report_problem"),a(!1)})},1e3)}),o=await a;return o}return(0,o.sV)(()=>{n()}),{Rows:e,current_project:a,current_project_label:r,GetData:n}}}),it=(0,w.A)(ut,[["render",lt]]),dt=it;S()(ut,"components",{QCard:x.A,QCardSection:F.A,QCardActions:R.A,QBtn:q.A,QList:L.A,QItem:Q.A,QItemSection:j.A});const pt={class:"row items-center"},_t={class:"col"},vt={class:"col-auto"},bt={class:""};function kt(t,e,a,r,s,n){const l=(0,o.g2)("q-select"),c=(0,o.g2)("q-btn"),u=(0,o.g2)("q-card-actions"),i=(0,o.g2)("VueApexCharts"),d=(0,o.g2)("q-card-section"),p=(0,o.g2)("q-card");return(0,o.uX)(),(0,o.Wv)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,{class:""},{default:(0,o.k6)(()=>[(0,o.Lk)("div",pt,[(0,o.Lk)("div",_t,[(0,o.bF)(l,{modelValue:t.model,"onUpdate:modelValue":[e[0]||(e[0]=e=>t.model=e),t.SetModel],options:t.Options},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,o.Lk)("div",vt,[(0,o.bF)(u,{align:"around"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])]),_:1})])]),(0,o.Lk)("div",bt,[(0,o.bF)(i,{type:"donut",ref:"ChartDonut",width:"100%",height:"515",options:t.ChartOptions,series:t.Series},null,8,["options","series"])])]),_:1})]),_:1})}a(3434);var mt=[];const gt=[],ht={labels:[],plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!0,fontSize:"22px",fontFamily:"Rubik",color:"#dfsda",offsetY:-10},value:{show:!0,fontSize:"16px",fontFamily:"Helvetica, Arial, sans-serif",color:void 0,offsetY:16,formatter:function(t){return t}},total:{show:!0,label:"Total",color:"#373d3f",formatter:function(t){return t.globals.seriesTotals.reduce((t,e)=>t+e,0)}}}}}},responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},ft=["Hosts type","Operating systems","Vulnarability hosts"],At=(0,o.pM)({name:"TopVulns",components:{VueApexCharts:z()},setup(){const t=(0,h.Pj)(),e=(0,m.KR)([...mt]),a=(0,m.KR)(t.state.current_project),r=(0,m.KR)(t.state.current_project_label),s=(0,g.A)(),n=(0,m.KR)(gt),l=(0,m.KR)(ht),c=(0,m.KR)("/get_distinct_purpose"),u=(0,m.KR)(ft),i=(0,m.KR)(null);async function p(){let e=new Promise((e,a)=>{setTimeout(()=>{e(!1);const a={Authorization:"Bearer "+t.state.current_user.token};d.api.get(c.value,{params:{workspace:t.state.current_project},headers:a}).then(t=>{var e=[],a=[];t.data.forEach(function(t,o,r){e.push(t.count),null==t.value?a.push(""):a.push(t.value)}),n.value=e,i.value.updateOptions({labels:a})}).catch(()=>{(0,f.e)(s,"negative","Ошибка","","report_problem"),e(!1)})},1e3)}),a=await e;return a}function _(t){t==ft[0]?c.value="/get_distinct_purpose":t==ft[1]?c.value="/get_distinct_os_name":t==ft[2]?c.value="/get_vulns_hosts":t==ft[3]?c.value="/get_distinct_vulns_hosts":t==ft[4]&&(c.value="/get_vulns_hosts"),p(c)}return(0,o.sV)(()=>{p()}),{Rows:e,current_project:a,current_project_label:r,uri:c,GetData:p,SetModel:_,Series:n,ChartOptions:l,ChartDonut:i,model:(0,m.KR)(ft[0]),Options:u}}}),Ct=(0,w.A)(At,[["render",kt]]),wt=Ct;S()(At,"components",{QCard:x.A,QCardSection:F.A,QSelect:U.A,QCardActions:R.A,QBtn:q.A});const xt=(0,o.pM)({name:"Dashboard",components:{TopServices:V,ChartColumn:N,TopOSName:ot,TopCreds:dt,ChartDonut:wt},setup(){return{}}}),Ft=(0,w.A)(xt,[["render",i]]),Rt=Ft}}]);