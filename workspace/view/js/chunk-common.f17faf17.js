"use strict";(globalThis["webpackChunkais"]=globalThis["webpackChunkais"]||[]).push([[64],{7701:(e,l,a)=>{a.d(l,{$:()=>t});var o=a(4328);function t(e,l,a,t,n){o.Z.create({color:l,position:"bottom",message:a,caption:t,icon:n})}},9082:(e,l,a)=>{a.d(l,{Z:()=>g});var o=a(9835);function t(e,l,a,t,n,r){const i=(0,o.up)("q-uploader"),s=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(s,{ref:"dialogRef"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{url:t.url,label:"Upload","no-thumbnails":"",style:{"max-width":"800px"},headers:t.headers,multiple:"",accept:".xml, .xls, .csv"},null,8,["url","headers"])])),_:1},512)}var n=a(499),r=a(1049);const i={props:{url:String,name:String},setup(e){const l=(0,r.oR)(),a=l.state.current_project,o=(0,n.iH)(e.url),t=(0,n.iH)(e.name),i=[{name:"Authorization",value:`Bearer ${l.state.current_user.token}`},{name:"workspace",value:l.state.current_project}];return{url:o,name:t,workspace_id:a,headers:i}}};var s=a(1639),u=a(2074),d=a(196),m=a(9984),p=a.n(m);const c=(0,s.Z)(i,[["render",t]]),g=c;p()(i,"components",{QDialog:u.Z,QUploader:d.Z})},1184:(e,l,a)=>{a.d(l,{Z:()=>$});var o=a(9835),t=a(6970);const n=e=>((0,o.dD)("data-v-3f7d99ee"),e=e(),(0,o.Cn)(),e),r={class:"q-pa-md"},i=n((()=>(0,o._)("div",{class:"text-h6"}," Новая задача ",-1))),s={class:"row items-center justify-end"},u={class:"row items-center justify-end"},d=(0,o.Uk)("Завершено"),m=(0,o.Uk)("Выполняется");function p(e,l,a,n,p,c){const g=(0,o.up)("q-input"),_=(0,o.up)("q-item-label"),w=(0,o.up)("q-item-section"),f=(0,o.up)("q-item"),v=(0,o.up)("q-select"),b=(0,o.up)("q-btn"),h=(0,o.up)("q-date"),V=(0,o.up)("q-popup-proxy"),y=(0,o.up)("q-icon"),k=(0,o.up)("q-time"),C=(0,o.up)("q-label"),W=(0,o.up)("q-toggle"),Z=(0,o.up)("q-form"),q=(0,o.up)("q-card-actions"),H=(0,o.up)("q-card"),Q=(0,o.up)("q-dialog"),U=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(Q,{ref:"dialogRef"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{class:"my-parent-card",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o._)("div",r,[(0,o.Wm)(Z,{class:"q-gutter-md"},{default:(0,o.w5)((()=>[i,(0,o.Wm)(g,{filled:"",modelValue:n.row[0].name,"onUpdate:modelValue":l[0]||(l[0]=e=>n.row[0].name=e),label:"Задача",hint:"Наименование задачи","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,o.Wm)(g,{filled:"",modelValue:n.row[0].description,"onUpdate:modelValue":l[1]||(l[1]=e=>n.row[0].description=e),label:"Описание",hint:"Описание задачи",type:"textarea","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,o.Wm)(v,{modelValue:n.performers,"onUpdate:modelValue":l[2]||(l[2]=e=>n.performers=e),multiple:"",options:n.options,label:"Исполнитель",onInputValue:n.setModel,"options-selected-class":"text-deep-orange"},{option:(0,o.w5)((e=>[(0,o.Wm)(f,(0,t.vs)((0,o.F4)(e.itemProps)),{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.opt.username),1)])),_:2},1024),(0,o.Wm)(_,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e.opt.fullname),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","onInputValue"]),(0,o.Wm)(g,{filled:"",modelValue:n.row[0].final_date,"onUpdate:modelValue":l[5]||(l[5]=e=>n.row[0].final_date=e),label:"Контрольный срок"},{prepend:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"event",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{modelValue:n.row[0].final_date,"onUpdate:modelValue":l[3]||(l[3]=e=>n.row[0].final_date=e),mask:"YYYY-MM-DD HH:mm","today-btn":""},{default:(0,o.w5)((()=>[(0,o._)("div",s,[(0,o.wy)((0,o.Wm)(b,{label:"Close",color:"primary",flat:""},null,512),[[U]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),append:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"access_time",class:"cursor-pointer"},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{modelValue:n.row[0].final_date,"onUpdate:modelValue":l[4]||(l[4]=e=>n.row[0].final_date=e),mask:"YYYY-MM-DD HH:mm",format24h:""},{default:(0,o.w5)((()=>[(0,o._)("div",u,[(0,o.wy)((0,o.Wm)(b,{label:"Close",color:"primary",flat:""},null,512),[[U]])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(W,{modelValue:n.row[0].status,"onUpdate:modelValue":l[6]||(l[6]=e=>n.row[0].status=e)},{default:(0,o.w5)((()=>[n.row[0].status?((0,o.wg)(),(0,o.j4)(C,{key:0},{default:(0,o.w5)((()=>[d])),_:1})):((0,o.wg)(),(0,o.j4)(C,{key:1},{default:(0,o.w5)((()=>[m])),_:1}))])),_:1},8,["modelValue"])])),_:1})]),(0,o.Wm)(q,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{color:"green",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,o.Wm)(b,{color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},512)}var c=a(4182),g=a(499),_=a(9302),w=a(1049),f=a(1569),v=a(7701);const b={props:{parent_component:String},emits:[...c.Z.emits],setup(e){const{dialogRef:l,onDialogHide:a,onDialogOK:o,onDialogCancel:t}=(0,c.Z)(),n=(0,g.iH)(!1),r=(0,_.Z)(),i=(0,w.oR)(),s=(0,g.iH)([]),u=(0,g.iH)([{name:"",id:-1,performers:[],final_date:(new Date).toISOString().slice(0,10)+" 00:00",description:"",status:!1}]),d=(0,g.iH)(i.state.users),m=(0,g.iH)(null),p=(0,g.iH)((new Date).toISOString().slice(0,10)+" 00:00");function b(e){u.owner=e.username}async function h(l,a){let t=new Promise(((t,n)=>{setTimeout((()=>{t(!1);const n={Authorization:"Bearer "+i.state.current_user.token};f.api.post("/add_task",{workspace:l,data:a},{headers:n}).then((l=>{200==l.data.rsp_k?(u.value[0].id=l.data.id,u.value[0].performers=s.value,"ManageTasks"==e.parent_component?o({row:u}):(i.commit("SET_WATCH_ADD_TASK",u.value[0]),o()),(0,v.$)(r,"positive","Запись добавлена","","done")):((0,v.$)(r,"negative","Ошибка",l.data.message,"report_problem"),t(!1))})).catch((()=>{(0,v.$)(r,"negative","Ошибка","","report_problem"),t(!1)}))}),1e3)})),n=await t;return n}return{dialogRef:l,task:m,date:p,row:u,select_model:(0,g.iH)(d[2]),Add_item:h,options:d,performers:s,attr:n,onDialogHide:a,setModel:b,onOKClick(){var e=JSON.parse(JSON.stringify(u.value[0]));e.performers=s.value.map((e=>e.id)),h(i.state.current_project,JSON.stringify(e))},onCancelClick:t}}};var h=a(1639),V=a(2074),y=a(4458),k=a(8326),C=a(3119),W=a(6384),Z=a(490),q=a(1233),H=a(3115),Q=a(2857),U=a(2765),S=a(4351),R=a(8879),D=a(6770),O=a(3175),P=a(1821),T=a(2146),x=a(9984),I=a.n(x);const j=(0,h.Z)(b,[["render",p],["__scopeId","data-v-3f7d99ee"]]),$=j;I()(b,"components",{QDialog:V.Z,QCard:y.Z,QForm:k.Z,QInput:C.Z,QSelect:W.Z,QItem:Z.Z,QItemSection:q.Z,QItemLabel:H.Z,QIcon:Q.Z,QPopupProxy:U.Z,QDate:S.Z,QBtn:R.Z,QTime:D.Z,QToggle:O.Z,QCardActions:P.Z}),I()(b,"directives",{ClosePopup:T.Z})},5593:(e,l,a)=>{a.d(l,{Z:()=>Z});var o=a(9835);const t=e=>((0,o.dD)("data-v-710ed328"),e=e(),(0,o.Cn)(),e),n={class:"q-pa-md"},r=t((()=>(0,o._)("div",{class:"text-h6"}," Новый проект ",-1)));function i(e,l,a,t,i,s){const u=(0,o.up)("q-input"),d=(0,o.up)("q-toggle"),m=(0,o.up)("q-form"),p=(0,o.up)("q-btn"),c=(0,o.up)("q-card-actions"),g=(0,o.up)("q-card"),_=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(_,{ref:"dialogRef",onHide:t.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"my-parent-card",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o._)("div",n,[(0,o.Wm)(m,{class:"q-gutter-md"},{default:(0,o.w5)((()=>[r,(0,o.Wm)(u,{filled:"",modelValue:t.row[0].name,"onUpdate:modelValue":l[0]||(l[0]=e=>t.row[0].name=e),label:"Название",hint:"Наименование проекта",ref:"nameRef",rules:t.nameRules,autogrow:""},null,8,["modelValue","rules"]),(0,o.Wm)(u,{filled:"",modelValue:t.row[0].description,"onUpdate:modelValue":l[1]||(l[1]=e=>t.row[0].description=e),label:"Описание",hint:"Описание проекта","lazy-rules":"",autogrow:""},null,8,["modelValue"]),(0,o.Wm)(d,{modelValue:t.status,"onUpdate:modelValue":l[2]||(l[2]=e=>t.status=e),label:"Сделать текущим?"},null,8,["modelValue"])])),_:1})]),(0,o.Wm)(c,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{color:"green",label:"OK",onClick:t.onOKClick},null,8,["onClick"]),(0,o.Wm)(p,{color:"primary",label:"Cancel",onClick:t.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}a(1384);var s=a(4182),u=a(499),d=a(9302),m=a(1049),p=a(1569),c=a(7701);const g={props:{parent_component:String},emits:[...s.Z.emits],setup(e){const{dialogRef:l,onDialogHide:a,onDialogOK:o,onDialogCancel:t}=(0,s.Z)(),n=(0,d.Z)(),r=(0,m.oR)(),i=(0,u.iH)(null),g=(0,u.iH)(null),_=(0,u.iH)(!0),w=(0,u.iH)(null),f=(0,u.iH)([{id:-1,name:"",description:"",created_at:""}]);async function v(l){let a=new Promise(((a,t)=>{setTimeout((()=>{a(!1);const t={Authorization:"Bearer "+r.state.current_user.token};p.api.post("/api/add_workspace",{data:l},{headers:t}).then((l=>{200==l.data.rsp_k?(f.value[0].id=l.data.id,f.value[0].created_at=l.data.created_at,1==_.value&&(r.commit("SET_CURRENT_PROJECT",f.value[0].id),r.commit("SET_CURRENT_PROJECT_LABEL",f.value[0].name),localStorage.setItem("current_project",JSON.stringify({project:f.value[0].id,label:f.value[0].name}))),"ManageProjects"==e.parent_component?o({row:f}):(r.commit("SET_WATCH_ADD_PROJECT",f.value[0]),o()),(0,c.$)(n,"positive","Запись добавлена","","done")):((0,c.$)(n,"negative","Ошибка",l.data.message,"report_problem"),a(!1))})).catch((()=>{(0,c.$)(n,"negative","Ошибка","","report_problem"),a(!1)}))}),1e3)})),t=await a;return t}return{dialogRef:l,project_name:i,description:g,status:_,row:f,nameRef:w,nameRules:[e=>null!=e&&""!=e||"Заполните поле"],add_project:v,onDialogHide:a,onOKClick(){w.value.validate(),w.value.hasError||v(JSON.stringify(f.value[0]))},onCancelClick:t}}};var _=a(1639),w=a(2074),f=a(4458),v=a(8326),b=a(3119),h=a(3175),V=a(1821),y=a(8879),k=a(9984),C=a.n(k);const W=(0,_.Z)(g,[["render",i],["__scopeId","data-v-710ed328"]]),Z=W;C()(g,"components",{QDialog:w.Z,QCard:f.Z,QForm:v.Z,QInput:b.Z,QToggle:h.Z,QCardActions:V.Z,QBtn:y.Z})},2360:(e,l,a)=>{a.r(l),a.d(l,{default:()=>Ce});var o=a(9835);const t=(0,o._)("div",{class:"text-h6"},"Movies",-1),n=(0,o.Uk)(" Lorem ipsum dolor sit amet consectetur adipisicing elit. ");function r(e,l,a,r,i,s){const u=(0,o.up)("q-tab"),d=(0,o.up)("q-tabs"),m=(0,o.up)("q-separator"),p=(0,o.up)("Settings_UsersSettings"),c=(0,o.up)("q-tab-panel"),g=(0,o.up)("Settings_UsersControl"),_=(0,o.up)("q-tab-panels"),w=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=l=>e.tab=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{name:"users_settings",label:"Пользовательские настройки"}),"admin"==e.current_user.role?((0,o.wg)(),(0,o.j4)(u,{key:0,name:"users_control",label:"Управление пользователями"})):(0,o.kq)("",!0),"admin"==e.current_user.role?((0,o.wg)(),(0,o.j4)(u,{key:1,name:"creds_control",label:"Управление Creds"})):(0,o.kq)("",!0)])),_:1},8,["modelValue"]),(0,o.Wm)(m),(0,o.Wm)(_,{modelValue:e.tab,"onUpdate:modelValue":l[1]||(l[1]=l=>e.tab=l),animated:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{name:"users_settings"},{default:(0,o.w5)((()=>[(0,o.Wm)(p)])),_:1}),(0,o.Wm)(c,{name:"users_control"},{default:(0,o.w5)((()=>[(0,o.Wm)(g)])),_:1}),(0,o.Wm)(c,{name:"creds_control"},{default:(0,o.w5)((()=>[t,n])),_:1})])),_:1},8,["modelValue"])])),_:1})}var i=a(499),s=a(9302),u=a(1049),d=a(1569),m=a(8910);const p={class:"q-pa-md"},c={class:"q-gutter-md",style:{"max-width":"500px"}},g=(0,o._)("div",{class:"text-h5"}," Учетная запись ",-1),_=(0,o._)("div",{class:"text-h5"}," Пользовательский интефейс ",-1);function w(e,l,a,t,n,r){const i=(0,o.up)("q-icon"),s=(0,o.up)("q-input"),u=(0,o.up)("q-btn"),d=(0,o.up)("q-select"),m=(0,o.up)("q-toggle"),w=(0,o.up)("q-separator");return(0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("div",c,[g,(0,o.Wm)(s,{modelValue:e.password1,"onUpdate:modelValue":l[1]||(l[1]=l=>e.password1=l),filled:"",type:e.isPwd?"password":"text",label:"Введите пароль"},{append:(0,o.w5)((()=>[(0,o.Wm)(i,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:l[0]||(l[0]=l=>e.isPwd=!e.isPwd)},null,8,["name"])])),_:1},8,["modelValue","type"]),(0,o.Wm)(s,{modelValue:e.password2,"onUpdate:modelValue":l[2]||(l[2]=l=>e.password2=l),filled:"",type:e.isPwd?"password":"text",label:"Подтвердите ввод"},null,8,["modelValue","type"]),(0,o.Wm)(u,{label:"Сменить пароль",onClick:e.change_password,color:"primary"},null,8,["onClick"]),_,(0,o.Wm)(d,{filled:"","options-selected-class":"text-deep-orange",modelValue:e.user_settings.current_tab,"onUpdate:modelValue":l[3]||(l[3]=l=>e.user_settings.current_tab=l),options:e.options,label:"Закрепленный компонент в Dashboard"},null,8,["modelValue","options"]),(0,o.Wm)(m,{modelValue:e.user_settings.display_icon_purpose,"onUpdate:modelValue":l[4]||(l[4]=l=>e.user_settings.display_icon_purpose=l),label:"Отображать иконку в компоненте Hosts 'Тип устройств'"},null,8,["modelValue"]),(0,o.Wm)(m,{modelValue:e.user_settings.display_icon_osfamily,"onUpdate:modelValue":l[5]||(l[5]=l=>e.user_settings.display_icon_osfamily=l),label:"Отображать иконку в компоненте Hosts 'Семейство ОС'"},null,8,["modelValue"]),(0,o.Wm)(m,{modelValue:e.user_settings.display_icon_tree_creds,"onUpdate:modelValue":l[6]||(l[6]=l=>e.user_settings.display_icon_tree_creds=l),label:"Отображать иконку в компоненте Tree 'Устройства с учетными данными'"},null,8,["modelValue"]),(0,o.Wm)(m,{modelValue:e.user_settings.display_icon_tree_hosts,"onUpdate:modelValue":l[7]||(l[7]=l=>e.user_settings.display_icon_tree_hosts=l),label:"Отображать иконку в компоненте Tree 'Тип устройств'"},null,8,["modelValue"]),(0,o.Wm)(w),(0,o.Wm)(u,{label:"Подтвердить",type:"submit",onClick:l[8]||(l[8]=l=>e.submit()),color:"primary"})])])}var f=a(7701);const v={current_tab:"services",display_icon_purpose:!0,display_icon_osfamily:!0,display_icon_tree_creds:!0,display_icon_tree_hosts:!0,display_icon_tree_vulns:!0},b=(0,o.aZ)({setup(){const e=(0,s.Z)(),l=(0,u.oR)(),a=(0,i.iH)(v),t=(0,i.iH)(l.state.current_user),n=(0,i.iH)(l.state.all_tab),r=(0,i.iH)(""),m=(0,i.iH)("");function p(){r.value!=m.value?(0,f.$)(e,"negative","Ошибка","Пароли не совпадают!","report_problem"):""==r.value?(0,f.$)(e,"negative","Ошибка","Пароль не должен быть пустым!","report_problem"):d.api.get("/change_password",{params:{username:t.value.username,password:r.value},headers:{Authorization:"Bearer "+l.state.current_user.token}}).then((l=>{200==l.data.rsp_k?(0,f.$)(e,"positive",l.data.message,"","done"):((0,f.$)(e,"negative","Ошибка",l.data.message,"report_problem"),resolve(!1))})).catch((()=>{(0,f.$)(e,"negative","Ошибка","","report_problem"),resolve(!1)}))}function c(){try{l.commit("SET_USER_SETTINGS",a.value),(0,f.$)(e,"positive","Настройки применены","","done")}catch(o){console.log(o),(0,f.$)(e,"negative","Ошибка","","report_problem")}}return(0,o.bv)((()=>{let e=JSON.parse(JSON.stringify(l.state.user_settings));a.value=e})),(0,o.YP)((()=>l.state.user_settings),(()=>{if(null!=l.state.user_settings){let e=JSON.parse(JSON.stringify(l.state.user_settings));a.value=e}})),(0,o.YP)((()=>l.state.current_user),(()=>{null!=l.state.current_user&&(t.value=l.state.current_user)})),{user_settings:a,password1:r,password2:m,options:n,current_user:t,isPwd:(0,i.iH)(!0),submit:c,change_password:p}}});var h=a(1639),V=a(3119),y=a(2857),k=a(8879),C=a(6384),W=a(3175),Z=a(926),q=a(9984),H=a.n(q);const Q=(0,h.Z)(b,[["render",w]]),U=Q;H()(b,"components",{QInput:V.Z,QIcon:y.Z,QBtn:k.Z,QSelect:C.Z,QToggle:W.Z,QSeparator:Z.Z});var S=a(6970);const R=(0,o._)("div",{class:"text-h4"}," User Control ",-1),D=(0,o._)("div",{align:"center"},"Visible Columns",-1),O={key:0},P={key:1,align:"right"},T={key:2};function x(e,l,a,t,n,r){const i=(0,o.up)("q-btn"),s=(0,o.up)("q-toggle"),u=(0,o.up)("q-icon"),d=(0,o.up)("q-input"),m=(0,o.up)("q-checkbox"),p=(0,o.up)("q-th"),c=(0,o.up)("q-tr"),g=(0,o.up)("q-popup-proxy"),_=(0,o.up)("q-td"),w=(0,o.up)("q-table");return(0,o.wg)(),(0,o.j4)(w,{title:"Управление пользователями",rows:t.Rows,columns:t.Columns,"row-key":"id",dense:"",ref:"q_table",selection:"multiple","selected-rows-label":e.getSelectedString,selected:t.selected,"onUpdate:selected":l[3]||(l[3]=e=>t.selected=e),onSelection:e.handleSelectRow,loading:t.loading,filter:t.filter,"virtual-scroll":"","visible-columns":t.visibleColumns},{"top-left":(0,o.w5)((()=>[(0,o.Wm)(i,{color:"primary","icon-right":"add",label:"Add","no-caps":"",size:"sm",class:"button-top",onClick:t.additem},null,8,["onClick"]),(0,o.Wm)(i,{color:"primary","icon-right":"delete",label:"Delete","no-caps":"",size:"sm",class:"button-top",onClick:t.deleteItems},null,8,["onClick"]),(0,o.Wm)(i,{color:"primary","icon-right":"refresh",label:"Refresh","no-caps":"",size:"sm",class:"button-top",onClick:t.loaddata},null,8,["onClick"]),(0,o.Wm)(s,{modelValue:t.tableSelectable,"onUpdate:modelValue":l[0]||(l[0]=e=>t.tableSelectable=e),label:"Selectable"},null,8,["modelValue"])])),"top-right":(0,o.w5)((()=>[(0,o._)("div",null,[R,(0,o.Wm)(d,{borderless:"",dense:"",debounce:"300",modelValue:t.filter,"onUpdate:modelValue":l[1]||(l[1]=e=>t.filter=e),placeholder:"Поиск"},{append:(0,o.w5)((()=>[(0,o.Wm)(u,{name:"search"})])),_:1},8,["modelValue"])])])),header:(0,o.w5)((e=>[(0,o.Wm)(c,{props:e},{default:(0,o.w5)((()=>[1==t.tableSelectable?((0,o.wg)(),(0,o.j4)(p,{key:0,align:"left"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):(0,o.kq)("",!0),(0,o.Wm)(p),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(l=>((0,o.wg)(),(0,o.j4)(p,{key:l.name,props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,S.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"]),(0,o.Wm)(g,{"context-menu":""},{default:(0,o.w5)((()=>[D,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.Columns,(e=>((0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(s,{modelValue:t.visibleColumns,"onUpdate:modelValue":l[2]||(l[2]=e=>t.visibleColumns=e),label:e.label,val:e.name},null,8,["modelValue","label","val"])])))),256))])),_:1})])),body:(0,o.w5)((e=>[(0,o.Wm)(c,{props:e},{default:(0,o.w5)((()=>[1==t.tableSelectable?((0,o.wg)(),(0,o.j4)(_,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l,color:"primary"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):((0,o.wg)(),(0,o.j4)(_,{key:1})),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols.filter((e=>"desc"!==e.name)),(l=>((0,o.wg)(),(0,o.j4)(_,{key:l.name,align:"center"},{default:(0,o.w5)((()=>["admin"==l.name?((0,o.wg)(),(0,o.iD)("div",O,[(0,o.Wm)(s,{disable:"",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,color:"green"},null,8,["modelValue","onUpdate:modelValue"])])):"actions"==l.name?((0,o.wg)(),(0,o.iD)("div",P,[(0,o.Wm)(i,{color:"blue","icon-right":"key",onClick:l=>t.chnpassItem(e.row),size:"sm"},null,8,["onClick"]),(0,o.Wm)(i,{color:"green","icon-right":"edit",onClick:l=>t.editItem(e.row),size:"sm"},null,8,["onClick"]),(0,o.Wm)(i,{color:"red","icon-right":"delete",onClick:l=>t.deleteItem(e.row),size:"sm"},null,8,["onClick"])])):((0,o.wg)(),(0,o.iD)("div",T,(0,S.zw)(l.value),1))])),_:2},1024)))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns","selected-rows-label","selected","onSelection","loading","filter","visible-columns"])}var I=a(1746);const j={class:"q-pa-md",style:{"max-width":"400px"}},$=(0,o._)("div",{class:"text-h6"}," Add User ",-1);function A(e,l,a,t,n,r){const i=(0,o.up)("q-input"),s=(0,o.up)("q-icon"),u=(0,o.up)("q-toggle"),d=(0,o.up)("q-form"),m=(0,o.up)("q-btn"),p=(0,o.up)("q-card-actions"),c=(0,o.up)("q-card"),g=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(g,{ref:"dialogRef",onHide:t.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o._)("div",j,[(0,o.Wm)(d,{onSubmit:e.onSubmit,onReset:e.onReset,class:"q-gutter-md"},{default:(0,o.w5)((()=>[$,(0,o.Wm)(i,{id:"ip",filled:"",modelValue:t.row[0].username,"onUpdate:modelValue":l[0]||(l[0]=e=>t.row[0].username=e),hint:"Username",ref:"usernameRef",rules:t.usernameRules},null,8,["modelValue","rules"]),(0,o.Wm)(i,{filled:"",modelValue:t.row[0].password,"onUpdate:modelValue":l[2]||(l[2]=e=>t.row[0].password=e),hint:"Password",type:t.isPwd?"password":"text",ref:"passwordRef",rules:t.passwordRules},{append:(0,o.w5)((()=>[(0,o.Wm)(s,{name:t.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:l[1]||(l[1]=e=>t.isPwd=!t.isPwd)},null,8,["name"])])),_:1},8,["modelValue","type","rules"]),(0,o.Wm)(i,{filled:"",modelValue:t.row[0].fullname,"onUpdate:modelValue":l[3]||(l[3]=e=>t.row[0].fullname=e),hint:"Полное имя"},null,8,["modelValue"]),(0,o.Wm)(i,{filled:"",modelValue:t.row[0].email,"onUpdate:modelValue":l[4]||(l[4]=e=>t.row[0].email=e),hint:"E-mail"},null,8,["modelValue"]),(0,o.Wm)(i,{filled:"",modelValue:t.row[0].phone,"onUpdate:modelValue":l[5]||(l[5]=e=>t.row[0].phone=e),hint:"Телефон"},null,8,["modelValue"]),(0,o.Wm)(i,{filled:"",modelValue:t.row[0].company,"onUpdate:modelValue":l[6]||(l[6]=e=>t.row[0].company=e),hint:"Компания"},null,8,["modelValue"]),(0,o.Wm)(u,{modelValue:t.row[0].admin,"onUpdate:modelValue":l[7]||(l[7]=e=>t.row[0].admin=e),label:"Администратор",color:"green"},null,8,["modelValue"])])),_:1},8,["onSubmit","onReset"])]),(0,o.Wm)(p,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{color:"green",label:"OK",onClick:t.onOKClick},null,8,["onClick"]),(0,o.Wm)(m,{color:"primary",label:"Cancel",onClick:t.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}a(1384);var K=a(4182);const z={props:{current_host_prop:String,current_host_label_prop:String},emits:[...K.Z.emits],setup(e){const{dialogRef:l,onDialogHide:a,onDialogOK:t,onDialogCancel:n}=(0,K.Z)(),r=(0,s.Z)(),m=(0,u.oR)(),p=(0,i.iH)(""),c=(0,i.iH)(""),g=(0,i.iH)([{id:-1,username:"",password:"",fullname:"",email:"",phone:"",company:"",prefs:"",admin:!1}]);async function _(e){let l=new Promise(((l,a)=>{setTimeout((()=>{l(!1),d.api.get("/add_user",{params:{data:e},headers:{Authorization:"Bearer "+m.state.current_user.token}}).then((e=>{200==e.data.rsp_k?(g.value[0].id=e.data.id,t({row:g}),(0,f.$)(r,"positive","Запись добавлена","","done")):((0,f.$)(r,"negative","Ошибка",e.data.message,"report_problem"),l(!1))})).catch((()=>{(0,f.$)(r,"negative","Ошибка","","report_problem"),l(!1)}))}),1e3)})),a=await l;return a}return(0,o.bv)((()=>{})),{dialogRef:l,row:g,add_user:_,usernameRef:p,passwordRef:c,isPwd:(0,i.iH)(!0),usernameRules:[e=>null!=e&&""!=e||"Поле Username не должно быть пустым"],passwordRules:[e=>null!=e&&""!=e||"Поле Password не должно быть пустым"],onDialogHide:a,onOKClick(){p.value.validate(),c.value.validate(),p.value.hasError||c.value.hasError||_(JSON.stringify(g.value[0]))},onCancelClick:n}}};var E=a(2074),J=a(4458),N=a(8326),B=a(1821);const Y=(0,h.Z)(z,[["render",A]]),M=Y;H()(z,"components",{QDialog:E.Z,QCard:J.Z,QForm:N.Z,QInput:V.Z,QIcon:y.Z,QToggle:W.Z,QCardActions:B.Z,QBtn:k.Z});const F={class:"q-pa-md",style:{"max-width":"400px"}},L=(0,o._)("div",{class:"text-h6"}," Edit User ",-1);function G(e,l,a,t,n,r){const i=(0,o.up)("q-input"),s=(0,o.up)("q-toggle"),u=(0,o.up)("q-form"),d=(0,o.up)("q-btn"),m=(0,o.up)("q-card-actions"),p=(0,o.up)("q-card"),c=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(c,{ref:"dialogRef",onHide:t.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o._)("div",F,[(0,o.Wm)(u,{onSubmit:e.onSubmit,onReset:e.onReset,class:"q-gutter-md"},{default:(0,o.w5)((()=>[L,(0,o.Wm)(i,{id:"ip",filled:"",modelValue:t.prop1.username,"onUpdate:modelValue":l[0]||(l[0]=e=>t.prop1.username=e),hint:"Username",readonly:"",ref:"usernameRef",rules:t.usernameRules},null,8,["modelValue","rules"]),(0,o.Wm)(i,{filled:"",modelValue:t.prop1.fullname,"onUpdate:modelValue":l[1]||(l[1]=e=>t.prop1.fullname=e),hint:"Полное имя"},null,8,["modelValue"]),(0,o.Wm)(i,{filled:"",modelValue:t.prop1.email,"onUpdate:modelValue":l[2]||(l[2]=e=>t.prop1.email=e),hint:"E-mail"},null,8,["modelValue"]),(0,o.Wm)(i,{filled:"",modelValue:t.prop1.phone,"onUpdate:modelValue":l[3]||(l[3]=e=>t.prop1.phone=e),hint:"Телефон"},null,8,["modelValue"]),(0,o.Wm)(i,{filled:"",modelValue:t.prop1.company,"onUpdate:modelValue":l[4]||(l[4]=e=>t.prop1.company=e),hint:"Компания"},null,8,["modelValue"]),"admin"!=t.prop1.username?((0,o.wg)(),(0,o.j4)(s,{key:0,modelValue:t.prop1.admin,"onUpdate:modelValue":l[5]||(l[5]=e=>t.prop1.admin=e),label:"Администратор",color:"green"},null,8,["modelValue"])):((0,o.wg)(),(0,o.j4)(s,{key:1,disable:"",modelValue:t.prop1.admin,"onUpdate:modelValue":l[6]||(l[6]=e=>t.prop1.admin=e),label:"Администратор",color:"green"},null,8,["modelValue"]))])),_:1},8,["onSubmit","onReset"])]),(0,o.Wm)(m,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{color:"green",label:"OK",onClick:t.onOKClick},null,8,["onClick"]),(0,o.Wm)(d,{color:"primary",label:"Cancel",onClick:t.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const X={props:{selected_items:Array},emits:[...K.Z.emits],setup(e){const{dialogRef:l,onDialogHide:a,onDialogOK:t,onDialogCancel:n}=(0,K.Z)(),r=(0,s.Z)(),m=(0,u.oR)(),p=(0,i.iH)("");(0,i.iH)("");var c=null;const g=(0,i.iH)(JSON.parse(JSON.stringify(e.selected_items)));async function _(e){let l=new Promise(((l,a)=>{setTimeout((()=>{l(!1),d.api.get("/edit_user",{params:{data:e},headers:{Authorization:"Bearer "+m.state.current_user.token}}).then((e=>{200==e.data.rsp_k?(c=g.value,t({prop:c}),(0,f.$)(r,"positive","Запись отредактирована","","done")):((0,f.$)(r,"negative","Ошибка",e.data.message,"report_problem"),l(!1))})).catch((()=>{(0,f.$)(r,"negative","Ошибка","","report_problem"),l(!1)}))}),1e3)})),a=await l;return a}return(0,o.bv)((()=>{})),{dialogRef:l,edit_user:_,usernameRef:p,prop1:g,isPwd:(0,i.iH)(!0),usernameRules:[e=>null!=e&&""!=e||"Поле Username не должно быть пустым"],onDialogHide:a,onOKClick(){p.value.validate(),p.value.hasError||_(JSON.stringify(g.value))},onCancelClick:n}}},ee=(0,h.Z)(X,[["render",G]]),le=ee;H()(X,"components",{QDialog:E.Z,QCard:J.Z,QForm:N.Z,QInput:V.Z,QToggle:W.Z,QCardActions:B.Z,QBtn:k.Z});const ae={class:"q-pa-md",style:{"max-width":"400px"}},oe={class:"text-h6"};function te(e,l,a,t,n,r){const i=(0,o.up)("q-icon"),s=(0,o.up)("q-input"),u=(0,o.up)("q-form"),d=(0,o.up)("q-btn"),m=(0,o.up)("q-card-actions"),p=(0,o.up)("q-card"),c=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(c,{ref:"dialogRef",onHide:t.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o._)("div",ae,[(0,o.Wm)(u,{onSubmit:e.onSubmit,onReset:e.onReset,class:"q-gutter-md"},{default:(0,o.w5)((()=>[(0,o._)("div",oe," Change Password "+(0,S.zw)(t.prop1.username),1),(0,o.Wm)(s,{modelValue:t.password1,"onUpdate:modelValue":l[1]||(l[1]=e=>t.password1=e),filled:"",type:t.isPwd?"password":"text",label:"Введите пароль"},{append:(0,o.w5)((()=>[(0,o.Wm)(i,{name:t.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:l[0]||(l[0]=e=>t.isPwd=!t.isPwd)},null,8,["name"])])),_:1},8,["modelValue","type"]),(0,o.Wm)(s,{modelValue:t.password2,"onUpdate:modelValue":l[2]||(l[2]=e=>t.password2=e),filled:"",type:t.isPwd?"password":"text",label:"Подтвердите ввод"},null,8,["modelValue","type"])])),_:1},8,["onSubmit","onReset"])]),(0,o.Wm)(m,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{color:"green",label:"OK",onClick:t.onOKClick},null,8,["onClick"]),(0,o.Wm)(d,{color:"primary",label:"Cancel",onClick:t.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const ne={props:{selected_items:Array},emits:[...K.Z.emits],setup(e){const{dialogRef:l,onDialogHide:a,onDialogOK:t,onDialogCancel:n}=(0,K.Z)(),r=(0,s.Z)(),m=(0,u.oR)(),p=(0,i.iH)(""),c=(0,i.iH)("");var g=null;const _=(0,i.iH)(JSON.parse(JSON.stringify(e.selected_items)));async function w(e){let l=new Promise(((l,a)=>{setTimeout((()=>{l(!1),d.api.get("/change_password",{params:{username:e.username,password:p.value},headers:{Authorization:"Bearer "+m.state.current_user.token}}).then((e=>{200==e.data.rsp_k?(g=_.value,t({prop:g}),(0,f.$)(r,"positive","Пароль изменен","","done")):((0,f.$)(r,"negative","Ошибка",e.data.message,"report_problem"),l(!1))})).catch((()=>{(0,f.$)(r,"negative","Ошибка","","report_problem"),l(!1)}))}),1e3)})),a=await l;return a}return(0,o.bv)((()=>{})),{dialogRef:l,prop1:_,prop:g,change_password:w,password1:p,password2:c,isPwd:(0,i.iH)(!0),onDialogHide:a,onOKClick(){p.value!=c.value?r.notify({color:"negative",position:"bottom",caption:"Пароли не совпадают!",message:"Ошибка",icon:"report_problem"}):""==p.value?r.notify({color:"negative",position:"bottom",caption:"Пароль не должен быть пустым!",message:"Ошибка",icon:"report_problem"}):w(_.value)},onCancelClick:n}}},re=(0,h.Z)(ne,[["render",te]]),ie=re;H()(ne,"components",{QDialog:E.Z,QCard:J.Z,QForm:N.Z,QInput:V.Z,QIcon:y.Z,QCardActions:B.Z,QBtn:k.Z});const se=[{name:"id",field:"id",label:"ID",align:"center",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"username",label:"Имя пользователя",align:"center",field:"username",sortable:!0},{name:"fullname",label:"Полное имя",align:"center",field:"fullname",sortable:!0},{name:"email",label:"E-mail",align:"center",field:"email",sortable:!0},{name:"phone",label:"Телефон",align:"center",field:"phone",sortable:!0},{name:"company",label:"Организация",align:"center",field:"company",sortable:!0},{name:"prefs",label:"Пользовательские настройки",align:"center",field:"prefs",sortable:!0},{name:"admin",label:"Административная учетная запись",align:"center",field:"admin",sortable:!0},{name:"actions",label:"Actions",field:"actions"}],ue=[],de={setup(){const e=(0,u.oR)(),l=(0,s.Z)(),a=(0,i.iH)([]),t=(0,i.iH)([...ue]),n=(0,i.iH)(!1),r=(0,i.iH)([...se]),m=(0,i.iH)(""),p=(0,i.iH)(!1),c=(0,i.iH)(null);function g(o){setTimeout((()=>{d.api.get("/del_user",{params:{data:o},headers:{Authorization:"Bearer "+e.state.current_user.token}}).then((e=>{200==e.data.rsp_k?(t.value.splice(t.value.indexOf(o),1),a.value=a.value.filter((e=>e.id!=o.id)),(0,f.$)(l,"positive","Запись удалена","","done")):(0,f.$)(l,"negative","Ошибка",e.data.message,"report_problem")})).catch((()=>{(0,f.$)(l,"negative","Ошибка","Не удалось удалить запись!","report_problem")}))}),1e3)}function _(){for(var e=a.value.filter((e=>e.id)),l=0;l<e.length;l++)g(e[l])}function w(){l.dialog({component:M,componentProps:{}}).onOk((e=>{t.value.push(e.row.value[0])}))}function v(e){var a=t.value.find((l=>l.id==e.id));l.dialog({component:le,componentProps:{selected_items:a}}).onOk((e=>{if(void 0!=e){const l=t.value.findIndex((l=>l.id==e.prop.id));l>-1&&(t.value[l]=e.prop)}}))}function b(e){var a=t.value.find((l=>l.id==e.id));l.dialog({component:ie,componentProps:{selected_items:a}}).onOk((e=>{}))}function h(){n.value=!0,d.api.get("/get_users",{params:{},headers:{Authorization:"Bearer "+e.state.current_user.token}}).then((e=>{t.value=e.data,n.value=!1})).catch((()=>{n.value=!1,(0,f.$)(l,"negative","Ошибка","Не удалось загрузить "+c.value.title,"report_problem")}))}return(0,o.bv)((()=>{h()})),{selected:a,loading:n,additem:w,editItem:v,deleteItem:g,deleteItems:_,Rows:t,q_table:c,filter:m,tableSelectable:p,chnpassItem:b,Columns:r,visibleColumns:(0,i.iH)(["username","fullname","prefs","admin","actions"]),loaddata:h}}};var me=a(3532),pe=a(1682),ce=a(1221),ge=a(2765),_e=a(7220);const we=(0,h.Z)(de,[["render",x]]),fe=we;H()(de,"components",{QTable:I.Z,QBtn:k.Z,QToggle:W.Z,QInput:V.Z,QIcon:y.Z,QTr:me.Z,QTh:pe.Z,QCheckbox:ce.Z,QPopupProxy:ge.Z,QTd:_e.Z});const ve=(0,o.aZ)({components:{Settings_UsersSettings:U,Settings_UsersControl:fe},name:"MainLayout",setup(){(0,s.Z)();const e=(0,u.oR)(),l=(0,m.tv)(),a=(0,i.iH)(e.state.current_user);function t(e){l.push(e)}return(0,o.YP)((()=>e.state.current_user),(()=>{a.value=e.state.current_user})),(0,o.bv)((()=>{})),{current_user:a,tab:(0,i.iH)("users_settings"),pushWithQuery:t}}});var be=a(7817),he=a(900),Ve=a(9800),ye=a(4106);const ke=(0,h.Z)(ve,[["render",r]]),Ce=ke;H()(ve,"components",{QCard:J.Z,QTabs:be.Z,QTab:he.Z,QSeparator:Z.Z,QTabPanels:Ve.Z,QTabPanel:ye.Z})}}]);