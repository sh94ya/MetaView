"use strict";(globalThis["webpackChunkais"]=globalThis["webpackChunkais"]||[]).push([[940],{9613:(t,e,o)=>{o.r(e),o.d(e,{default:()=>Qt});var a=o(9835);const r={class:"row"},n={class:"col"},s={class:"col"},l={class:"row"},c={class:"col-grow"},u={class:"col-grow"};function i(t,e,o,i,d,p){const _=(0,a.up)("chart-column"),m=(0,a.up)("chart-donut"),w=(0,a.up)("top-services"),v=(0,a.up)("top-creds");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",r,[(0,a._)("div",n,[(0,a.Wm)(_)]),(0,a._)("div",s,[(0,a.Wm)(m)])]),(0,a._)("div",l,[(0,a._)("div",c,[(0,a.Wm)(w)]),(0,a._)("div",u,[(0,a.Wm)(v)])])],64)}var d=o(1569),p=o(6970);const _={class:"row items-center no-wrap"},m=(0,a._)("div",{class:"col"},[(0,a._)("div",{class:"text-h6"},"Top 5 Services")],-1),w={class:"col-auto"},v={class:"text-caption text-grey"};function f(t,e,o,r,n,s){const l=(0,a.up)("q-btn"),c=(0,a.up)("q-card-actions"),u=(0,a.up)("q-item-section"),i=(0,a.up)("q-item"),d=(0,a.up)("q-list"),f=(0,a.up)("q-card-section"),h=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(h,{class:"my-card",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{horizontal:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"q-pt-xs"},{default:(0,a.w5)((()=>[(0,a._)("div",_,[m,(0,a._)("div",w,[(0,a.Wm)(c,{align:"around"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])])),_:1})])]),(0,a._)("div",v,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.Rows,((t,e)=>((0,a.wg)(),(0,a.j4)(i,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"col-auto text-black text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(e+1)+")",1)])),_:2},1024),(0,a.Wm)(u,{class:"col-auto text-black text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(t.port)+"/"+(0,p.zw)(t.proto)+"("+(0,p.zw)(t.name)+")",1)])),_:2},1024),(0,a.Wm)(u,{class:"col-auto text-green text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(t.count),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])])),_:1})])),_:1})])),_:1})}o(1384),o(4182);var h=o(499),b=o(9302),g=o(1049),Z=o(7701),C=[];const k=(0,a.aZ)({name:"TopServices",setup(){const t=(0,g.oR)(),e=(0,h.iH)([...C]),o=(0,h.iH)(t.state.current_project),r=(0,h.iH)(t.state.current_project_label),n=(0,b.Z)();async function s(){let o=new Promise(((o,a)=>{setTimeout((()=>{o(!1);const a={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/get_top_service",{params:{workspace:t.state.current_project},headers:a}).then((t=>{e.value=t.data})).catch((()=>{(0,Z.$)(n,"negative","Ошибка","","report_problem"),o(!1)}))}),1e3)})),a=await o;return a}return(0,a.bv)((()=>{s()})),{Rows:e,current_project:o,current_project_label:r,GetData:s}}});var x=o(1639),W=o(4458),q=o(3190),j=o(1821),H=o(8879),Q=o(3246),S=o(490),z=o(1233),y=o(9984),T=o.n(y);const D=(0,x.Z)(k,[["render",f]]),A=D;T()(k,"components",{QCard:W.Z,QCardSection:q.Z,QCardActions:j.Z,QBtn:H.Z,QList:Q.Z,QItem:S.Z,QItemSection:z.Z});const O={class:"row items-center"},R={class:"col"},V={class:"col-auto"},U={class:""};function B(t,e,o,r,n,s){const l=(0,a.up)("q-select"),c=(0,a.up)("q-btn"),u=(0,a.up)("q-card-actions"),i=(0,a.up)("VueApexCharts"),d=(0,a.up)("q-card-section"),p=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(p,{class:"",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:""},{default:(0,a.w5)((()=>[(0,a._)("div",O,[(0,a._)("div",R,[(0,a.Wm)(l,{modelValue:t.model,"onUpdate:modelValue":[e[0]||(e[0]=e=>t.model=e),t.SetModel],options:t.Options},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,a._)("div",V,[(0,a.Wm)(u,{align:"around"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])])),_:1})])]),(0,a._)("div",U,[(0,a.Wm)(i,{type:"bar",ref:"ChartColumn",width:"100%",options:t.ChartOptions,series:t.Series},null,8,["options","series"])])])),_:1})])),_:1})}var G=o(7092),I=o.n(G),P=[];const Y=[{name:"Count",data:[]}],$={chart:{type:"bar"},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",endingShape:"rounded"}},dataLabels:{enabled:!0},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:[]},yaxis:{title:{text:""}},fill:{opacity:1},tooltip:{y:{formatter:function(t){return t+" "}}}},L=["Топ уязвимостей","Учетные записи с различными правами"],M=(0,a.aZ)({name:"TopVulns",components:{VueApexCharts:I()},setup(){const t=(0,g.oR)(),e=(0,h.iH)([...P]),o=(0,h.iH)(t.state.current_project),r=(0,h.iH)(t.state.current_project_label),n=(0,b.Z)(),s=(0,h.iH)(Y),l=(0,h.iH)($),c=(0,h.iH)("/get_top_vuln"),u=(0,h.iH)(L),i=(0,h.iH)(null);async function p(){let e=new Promise(((e,o)=>{setTimeout((()=>{e(!1);const o={Authorization:"Bearer "+t.state.current_user.token};d.api.get(c.value,{params:{workspace:t.state.current_project},headers:o}).then((t=>{var e=[],o=[];t.data.forEach((function(t,a,r){e.push(t.count),null==t.value?o.push("<Blank>"):o.push(t.value)})),s.value[0].data=e,i.value.updateOptions({xaxis:{categories:o}})})).catch((()=>{(0,Z.$)(n,"negative","Ошибка","","report_problem"),e(!1)}))}),1e3)})),o=await e;return o}function _(t){t==L[0]?c.value="/get_top_vuln":t==L[1]&&(c.value="/get_distinct_creds_type"),p(c)}return(0,a.bv)((()=>{p()})),{Rows:e,current_project:o,current_project_label:r,uri:c,GetData:p,SetModel:_,Series:s,ChartOptions:l,ChartColumn:i,model:(0,h.iH)(L[0]),Options:u}}});var K=o(6384);const E=(0,x.Z)(M,[["render",B]]),F=E;T()(M,"components",{QCard:W.Z,QCardSection:q.Z,QSelect:K.Z,QCardActions:j.Z,QBtn:H.Z});const N={class:"row items-center no-wrap"},J=(0,a._)("div",{class:"col"},[(0,a._)("div",{class:"text-h6"},"Top 5 OS Name")],-1),X={class:"col-auto"},tt={class:"text-caption text-grey"};function et(t,e,o,r,n,s){const l=(0,a.up)("q-btn"),c=(0,a.up)("q-card-actions"),u=(0,a.up)("q-item-section"),i=(0,a.up)("q-item"),d=(0,a.up)("q-list"),_=(0,a.up)("q-card-section"),m=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(m,{class:"my-card",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{horizontal:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"q-pt-xs"},{default:(0,a.w5)((()=>[(0,a._)("div",N,[J,(0,a._)("div",X,[(0,a.Wm)(c,{align:"around"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])])),_:1})])]),(0,a._)("div",tt,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.Rows,((t,e)=>((0,a.wg)(),(0,a.j4)(i,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"col-auto text-black text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(e+1)+")",1)])),_:2},1024),(0,a.Wm)(u,{class:"col-auto text-black text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(t.value),1)])),_:2},1024),(0,a.Wm)(u,{class:"col-auto text-green text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(t.count),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])])),_:1})])),_:1})])),_:1})}var ot=[];const at=(0,a.aZ)({name:"TopServices",setup(){const t=(0,g.oR)(),e=(0,h.iH)([...ot]),o=(0,h.iH)(t.state.current_project),r=(0,h.iH)(t.state.current_project_label),n=(0,b.Z)();async function s(){let o=new Promise(((o,a)=>{setTimeout((()=>{o(!1);const a={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/get_top_os_name",{params:{workspace:t.state.current_project},headers:a}).then((t=>{e.value=t.data})).catch((()=>{(0,Z.$)(n,"negative","Ошибка","","report_problem"),o(!1)}))}),1e3)})),a=await o;return a}return(0,a.bv)((()=>{s()})),{Rows:e,current_project:o,current_project_label:r,GetData:s}}}),rt=(0,x.Z)(at,[["render",et]]),nt=rt;T()(at,"components",{QCard:W.Z,QCardSection:q.Z,QCardActions:j.Z,QBtn:H.Z,QList:Q.Z,QItem:S.Z,QItemSection:z.Z});const st={class:"row items-center no-wrap"},lt=(0,a._)("div",{class:"col"},[(0,a._)("div",{class:"text-h6"},"Top 5 Password")],-1),ct={class:"col-auto"},ut={class:"text-caption text-grey"};function it(t,e,o,r,n,s){const l=(0,a.up)("q-btn"),c=(0,a.up)("q-card-actions"),u=(0,a.up)("q-item-section"),i=(0,a.up)("q-item"),d=(0,a.up)("q-list"),_=(0,a.up)("q-card-section"),m=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(m,{class:"my-card",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{horizontal:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"q-pt-xs"},{default:(0,a.w5)((()=>[(0,a._)("div",st,[lt,(0,a._)("div",ct,[(0,a.Wm)(c,{align:"around"},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])])),_:1})])]),(0,a._)("div",ut,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.Rows,((t,e)=>((0,a.wg)(),(0,a.j4)(i,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"col-auto text-black text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(e+1)+")",1)])),_:2},1024),(0,a.Wm)(u,{class:"col-auto text-black text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(t.passwords),1)])),_:2},1024),(0,a.Wm)(u,{class:"col-auto text-green text-bold"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,p.zw)(t.count),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])])),_:1})])),_:1})])),_:1})}var dt=[];const pt=(0,a.aZ)({name:"TopServices",setup(){const t=(0,g.oR)(),e=(0,h.iH)([...dt]),o=(0,h.iH)(t.state.current_project),r=(0,h.iH)(t.state.current_project_label),n=(0,b.Z)();async function s(){let o=new Promise(((o,a)=>{setTimeout((()=>{o(!1);const a={Authorization:"Bearer "+t.state.current_user.token};d.api.get("/get_top_creds",{params:{workspace:t.state.current_project},headers:a}).then((t=>{e.value=t.data})).catch((()=>{(0,Z.$)(n,"negative","Ошибка","","report_problem"),o(!1)}))}),1e3)})),a=await o;return a}return(0,a.bv)((()=>{s()})),{Rows:e,current_project:o,current_project_label:r,GetData:s}}}),_t=(0,x.Z)(pt,[["render",it]]),mt=_t;T()(pt,"components",{QCard:W.Z,QCardSection:q.Z,QCardActions:j.Z,QBtn:H.Z,QList:Q.Z,QItem:S.Z,QItemSection:z.Z});const wt={class:"row items-center"},vt={class:"col"},ft={class:"col-auto"},ht={class:""};function bt(t,e,o,r,n,s){const l=(0,a.up)("q-select"),c=(0,a.up)("q-btn"),u=(0,a.up)("q-card-actions"),i=(0,a.up)("VueApexCharts"),d=(0,a.up)("q-card-section"),p=(0,a.up)("q-card");return(0,a.wg)(),(0,a.j4)(p,{class:"",flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{class:""},{default:(0,a.w5)((()=>[(0,a._)("div",wt,[(0,a._)("div",vt,[(0,a.Wm)(l,{modelValue:t.model,"onUpdate:modelValue":[e[0]||(e[0]=e=>t.model=e),t.SetModel],options:t.Options},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,a._)("div",ft,[(0,a.Wm)(u,{align:"around"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{flat:"",round:"",color:"red",icon:"refresh",onClick:t.GetData},null,8,["onClick"])])),_:1})])]),(0,a._)("div",ht,[(0,a.Wm)(i,{type:"donut",ref:"ChartDonut",width:"100%",options:t.ChartOptions,series:t.Series},null,8,["options","series"])])])),_:1})])),_:1})}var gt=[];const Zt=[],Ct={labels:[],plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!0,fontSize:"22px",fontFamily:"Rubik",color:"#dfsda",offsetY:-10},value:{show:!0,fontSize:"16px",fontFamily:"Helvetica, Arial, sans-serif",color:void 0,offsetY:16,formatter:function(t){return t}},total:{show:!0,label:"Total",color:"#373d3f",formatter:function(t){return t.globals.seriesTotals.reduce(((t,e)=>t+e),0)}}}}}},responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},kt=["Типы устройств","Операционные системы","Уязвимые узлы(всего в БД)"],xt=(0,a.aZ)({name:"TopVulns",components:{VueApexCharts:I()},setup(){const t=(0,g.oR)(),e=(0,h.iH)([...gt]),o=(0,h.iH)(t.state.current_project),r=(0,h.iH)(t.state.current_project_label),n=(0,b.Z)(),s=(0,h.iH)(Zt),l=(0,h.iH)(Ct),c=(0,h.iH)("/get_distinct_purpose"),u=(0,h.iH)(kt),i=(0,h.iH)(null);async function p(){let e=new Promise(((e,o)=>{setTimeout((()=>{e(!1);const o={Authorization:"Bearer "+t.state.current_user.token};d.api.get(c.value,{params:{workspace:t.state.current_project},headers:o}).then((t=>{var e=[],o=[];t.data.forEach((function(t,a,r){e.push(t.count),null==t.value?o.push(""):o.push(t.value)})),s.value=e,i.value.updateOptions({labels:o})})).catch((()=>{(0,Z.$)(n,"negative","Ошибка","","report_problem"),e(!1)}))}),1e3)})),o=await e;return o}function _(t){t==kt[0]?c.value="/get_distinct_purpose":t==kt[1]?c.value="/get_distinct_os_name":t==kt[2]?c.value="/get_vulns_hosts":t==kt[3]?c.value="/get_distinct_vulns_hosts":t==kt[4]&&(c.value="/get_vulns_hosts"),p(c)}return(0,a.bv)((()=>{p()})),{Rows:e,current_project:o,current_project_label:r,uri:c,GetData:p,SetModel:_,Series:s,ChartOptions:l,ChartDonut:i,model:(0,h.iH)(kt[0]),Options:u}}}),Wt=(0,x.Z)(xt,[["render",bt]]),qt=Wt;T()(xt,"components",{QCard:W.Z,QCardSection:q.Z,QSelect:K.Z,QCardActions:j.Z,QBtn:H.Z});const jt=(0,a.aZ)({name:"Dashboard",components:{TopServices:A,ChartColumn:F,TopOSName:nt,TopCreds:mt,ChartDonut:qt},setup(){return{}}}),Ht=(0,x.Z)(jt,[["render",i]]),Qt=Ht}}]);